23530f95b870f11c99e2ef428e9a42b2
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = _interopRequireWildcard(require("react"));
var _hooks = require("../../../../hooks");
var _SelectWeb = require("./Select.web.styles");
var _useSelect2 = _interopRequireDefault(require("./useSelect"));
var _types = require("./types");
var _jsxRuntime = require("react/jsx-runtime");
var SelectWeb = function SelectWeb(_ref) {
  var label = _ref.label,
    placeholder = _ref.placeholder,
    _ref$options = _ref.options,
    options = _ref$options === void 0 ? [] : _ref$options,
    value = _ref.value,
    onValueChange = _ref.onValueChange,
    _ref$required = _ref.required,
    required = _ref$required === void 0 ? false : _ref$required,
    _ref$disabled = _ref.disabled,
    disabled = _ref$disabled === void 0 ? false : _ref$disabled,
    validationState = _ref.validationState,
    errorMessage = _ref.errorMessage,
    helperText = _ref.helperText,
    validate = _ref.validate,
    accessibilityLabel = _ref.accessibilityLabel,
    accessibilityHint = _ref.accessibilityHint,
    testID = _ref.testID,
    className = _ref.className,
    style = _ref.style,
    _ref$compact = _ref.compact,
    compact = _ref$compact === void 0 ? false : _ref$compact;
  var _useI18n = (0, _hooks.useI18n)(),
    t = _useI18n.t;
  var defaultPlaceholder = placeholder || t('common.selectPlaceholder');
  var _useSelect = (0, _useSelect2.default)({
      value: value,
      options: options,
      onValueChange: onValueChange,
      required: required,
      validate: validate
    }),
    open = _useSelect.open,
    isFocused = _useSelect.isFocused,
    internalValidationState = _useSelect.validationState,
    internalErrorMessage = _useSelect.errorMessage,
    selectedOption = _useSelect.selectedOption,
    openSelect = _useSelect.openSelect,
    closeSelect = _useSelect.closeSelect,
    toggleSelect = _useSelect.toggleSelect,
    handleFocus = _useSelect.handleFocus,
    handleBlur = _useSelect.handleBlur,
    handleSelect = _useSelect.handleSelect;
  var finalValidationState = validationState || (disabled ? _types.VALIDATION_STATES.DISABLED : internalValidationState);
  var finalErrorMessage = errorMessage || internalErrorMessage;
  var displayHelperText = finalErrorMessage || helperText;
  var rootRef = (0, _react.useRef)(null);
  var menuRef = (0, _react.useRef)(null);
  var _React$useState = _react.default.useState(-1),
    _React$useState2 = (0, _slicedToArray2.default)(_React$useState, 2),
    focusedIndex = _React$useState2[0],
    setFocusedIndex = _React$useState2[1];
  (0, _react.useEffect)(function () {
    if (!open) return;
    var handleClickOutside = function handleClickOutside(event) {
      if (rootRef.current && !rootRef.current.contains(event.target)) {
        closeSelect();
      }
    };
    document.addEventListener('mousedown', handleClickOutside);
    return function () {
      return document.removeEventListener('mousedown', handleClickOutside);
    };
  }, [closeSelect, open]);
  (0, _react.useEffect)(function () {
    if (open) {
      setFocusedIndex(-1);
    }
  }, [open]);
  (0, _react.useEffect)(function () {
    if (open && menuRef.current) {
      var firstOption = menuRef.current.querySelector('[role="option"]:not([aria-disabled="true"])');
      if (firstOption) {
        firstOption.focus();
      }
    }
  }, [open]);
  var handleTriggerKeyDown = function handleTriggerKeyDown(e) {
    if (disabled) return;
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      toggleSelect();
    }
    if (e.key === 'ArrowDown') {
      e.preventDefault();
      openSelect();
    }
    if (e.key === 'Escape') {
      e.preventDefault();
      closeSelect();
    }
  };
  var handleMenuKeyDown = function handleMenuKeyDown(e) {
    if (disabled) return;
    var enabledOptions = options.filter(function (opt) {
      return !opt.disabled;
    });
    var currentIndex = enabledOptions.findIndex(function (opt, idx) {
      var optionIndex = options.indexOf(opt);
      return optionIndex === focusedIndex;
    });
    if (e.key === 'ArrowDown') {
      e.preventDefault();
      var nextIndex = currentIndex < enabledOptions.length - 1 ? currentIndex + 1 : 0;
      var nextOption = enabledOptions[nextIndex];
      var nextOptionIndex = options.indexOf(nextOption);
      setFocusedIndex(nextOptionIndex);
      if (menuRef.current) {
        var optionElement = testID ? menuRef.current.querySelector(`[data-testid="${testID}-option-${nextOptionIndex}"]`) : menuRef.current.querySelectorAll('[role="option"]')[nextOptionIndex];
        if (optionElement) {
          optionElement.focus();
        }
      }
    } else if (e.key === 'ArrowUp') {
      e.preventDefault();
      var prevIndex = currentIndex > 0 ? currentIndex - 1 : enabledOptions.length - 1;
      var prevOption = enabledOptions[prevIndex];
      var prevOptionIndex = options.indexOf(prevOption);
      setFocusedIndex(prevOptionIndex);
      if (menuRef.current) {
        var _optionElement = testID ? menuRef.current.querySelector(`[data-testid="${testID}-option-${prevOptionIndex}"]`) : menuRef.current.querySelectorAll('[role="option"]')[prevOptionIndex];
        if (_optionElement) {
          _optionElement.focus();
        }
      }
    } else if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      if (currentIndex >= 0 && currentIndex < enabledOptions.length) {
        handleSelect(enabledOptions[currentIndex].value);
      }
    } else if (e.key === 'Escape') {
      e.preventDefault();
      closeSelect();
      if (rootRef.current) {
        var trigger = rootRef.current.querySelector('[role="combobox"]');
        if (trigger) {
          trigger.focus();
        }
      }
    }
  };
  return (0, _jsxRuntime.jsxs)(_SelectWeb.StyledContainer, {
    ref: rootRef,
    style: style,
    className: className,
    $compact: compact,
    children: [label ? (0, _jsxRuntime.jsxs)(_SelectWeb.StyledLabelRow, {
      $compact: compact,
      children: [(0, _jsxRuntime.jsx)(_SelectWeb.StyledLabel, {
        children: label
      }), required ? (0, _jsxRuntime.jsx)(_SelectWeb.StyledRequired, {
        children: " *"
      }) : null]
    }) : null, (0, _jsxRuntime.jsxs)(_SelectWeb.StyledTrigger, {
      onClick: disabled ? undefined : toggleSelect,
      onFocus: handleFocus,
      onBlur: handleBlur,
      onKeyDown: handleTriggerKeyDown,
      disabled: disabled,
      $validationState: finalValidationState,
      $isFocused: isFocused,
      $compact: compact,
      role: "combobox",
      "aria-label": accessibilityLabel || label || defaultPlaceholder,
      "aria-describedby": displayHelperText ? `${testID || 'select'}-helper` : undefined,
      "aria-expanded": open,
      "aria-haspopup": "listbox",
      "aria-invalid": finalValidationState === 'error',
      "aria-required": required,
      "data-testid": testID,
      children: [(0, _jsxRuntime.jsx)(_SelectWeb.StyledTriggerText, {
        disabled: disabled,
        $isPlaceholder: !selectedOption,
        children: selectedOption ? selectedOption.label : defaultPlaceholder
      }), (0, _jsxRuntime.jsx)(_SelectWeb.StyledChevron, {
        "aria-hidden": "true",
        children: "\u25BE"
      })]
    }), open ? (0, _jsxRuntime.jsx)(_SelectWeb.StyledMenu, {
      ref: menuRef,
      role: "listbox",
      onKeyDown: handleMenuKeyDown,
      "data-testid": testID ? `${testID}-menu` : undefined,
      children: options.map(function (opt, index) {
        return (0, _jsxRuntime.jsx)(_SelectWeb.StyledOption, {
          disabled: !!opt.disabled,
          onClick: function onClick() {
            if (opt.disabled) return;
            handleSelect(opt.value);
          },
          onFocus: function onFocus() {
            return setFocusedIndex(index);
          },
          role: "option",
          "aria-selected": value === opt.value,
          "aria-disabled": opt.disabled,
          "aria-label": opt.label,
          tabIndex: opt.disabled ? -1 : index === 0 ? 0 : -1,
          "data-testid": testID ? `${testID}-option-${index}` : undefined,
          children: (0, _jsxRuntime.jsx)(_SelectWeb.StyledOptionText, {
            children: opt.label
          })
        }, `${String(opt.value)}-${index}`);
      })
    }) : null, displayHelperText ? (0, _jsxRuntime.jsx)(_SelectWeb.StyledHelperText, {
      $validationState: finalValidationState,
      id: testID ? `${testID}-helper` : undefined,
      children: displayHelperText
    }) : null]
  });
};
var _default = exports.default = SelectWeb;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfaG9va3MiLCJfU2VsZWN0V2ViIiwiX3VzZVNlbGVjdDIiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX3R5cGVzIiwiX2pzeFJ1bnRpbWUiLCJTZWxlY3RXZWIiLCJfcmVmIiwibGFiZWwiLCJwbGFjZWhvbGRlciIsIl9yZWYkb3B0aW9ucyIsIm9wdGlvbnMiLCJ2YWx1ZSIsIm9uVmFsdWVDaGFuZ2UiLCJfcmVmJHJlcXVpcmVkIiwicmVxdWlyZWQiLCJfcmVmJGRpc2FibGVkIiwiZGlzYWJsZWQiLCJ2YWxpZGF0aW9uU3RhdGUiLCJlcnJvck1lc3NhZ2UiLCJoZWxwZXJUZXh0IiwidmFsaWRhdGUiLCJhY2Nlc3NpYmlsaXR5TGFiZWwiLCJhY2Nlc3NpYmlsaXR5SGludCIsInRlc3RJRCIsImNsYXNzTmFtZSIsInN0eWxlIiwiX3JlZiRjb21wYWN0IiwiY29tcGFjdCIsIl91c2VJMThuIiwidXNlSTE4biIsInQiLCJkZWZhdWx0UGxhY2Vob2xkZXIiLCJfdXNlU2VsZWN0IiwidXNlU2VsZWN0Iiwib3BlbiIsImlzRm9jdXNlZCIsImludGVybmFsVmFsaWRhdGlvblN0YXRlIiwiaW50ZXJuYWxFcnJvck1lc3NhZ2UiLCJzZWxlY3RlZE9wdGlvbiIsIm9wZW5TZWxlY3QiLCJjbG9zZVNlbGVjdCIsInRvZ2dsZVNlbGVjdCIsImhhbmRsZUZvY3VzIiwiaGFuZGxlQmx1ciIsImhhbmRsZVNlbGVjdCIsImZpbmFsVmFsaWRhdGlvblN0YXRlIiwiVkFMSURBVElPTl9TVEFURVMiLCJESVNBQkxFRCIsImZpbmFsRXJyb3JNZXNzYWdlIiwiZGlzcGxheUhlbHBlclRleHQiLCJyb290UmVmIiwidXNlUmVmIiwibWVudVJlZiIsIl9SZWFjdCR1c2VTdGF0ZSIsIlJlYWN0IiwidXNlU3RhdGUiLCJfUmVhY3QkdXNlU3RhdGUyIiwiX3NsaWNlZFRvQXJyYXkyIiwiZGVmYXVsdCIsImZvY3VzZWRJbmRleCIsInNldEZvY3VzZWRJbmRleCIsInVzZUVmZmVjdCIsImhhbmRsZUNsaWNrT3V0c2lkZSIsImV2ZW50IiwiY3VycmVudCIsImNvbnRhaW5zIiwidGFyZ2V0IiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImZpcnN0T3B0aW9uIiwicXVlcnlTZWxlY3RvciIsImZvY3VzIiwiaGFuZGxlVHJpZ2dlcktleURvd24iLCJlIiwia2V5IiwicHJldmVudERlZmF1bHQiLCJoYW5kbGVNZW51S2V5RG93biIsImVuYWJsZWRPcHRpb25zIiwiZmlsdGVyIiwib3B0IiwiY3VycmVudEluZGV4IiwiZmluZEluZGV4IiwiaWR4Iiwib3B0aW9uSW5kZXgiLCJpbmRleE9mIiwibmV4dEluZGV4IiwibGVuZ3RoIiwibmV4dE9wdGlvbiIsIm5leHRPcHRpb25JbmRleCIsIm9wdGlvbkVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwicHJldkluZGV4IiwicHJldk9wdGlvbiIsInByZXZPcHRpb25JbmRleCIsInRyaWdnZXIiLCJqc3hzIiwiU3R5bGVkQ29udGFpbmVyIiwicmVmIiwiJGNvbXBhY3QiLCJjaGlsZHJlbiIsIlN0eWxlZExhYmVsUm93IiwianN4IiwiU3R5bGVkTGFiZWwiLCJTdHlsZWRSZXF1aXJlZCIsIlN0eWxlZFRyaWdnZXIiLCJvbkNsaWNrIiwidW5kZWZpbmVkIiwib25Gb2N1cyIsIm9uQmx1ciIsIm9uS2V5RG93biIsIiR2YWxpZGF0aW9uU3RhdGUiLCIkaXNGb2N1c2VkIiwicm9sZSIsIlN0eWxlZFRyaWdnZXJUZXh0IiwiJGlzUGxhY2Vob2xkZXIiLCJTdHlsZWRDaGV2cm9uIiwiU3R5bGVkTWVudSIsIm1hcCIsImluZGV4IiwiU3R5bGVkT3B0aW9uIiwidGFiSW5kZXgiLCJTdHlsZWRPcHRpb25UZXh0IiwiU3RyaW5nIiwiU3R5bGVkSGVscGVyVGV4dCIsImlkIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiU2VsZWN0LndlYi5qc3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFNlbGVjdCBDb21wb25lbnQgLSBXZWJcclxuICogUGlja2VyL2Ryb3Bkb3duIHByaW1pdGl2ZSBmb3IgV2ViIHBsYXRmb3JtIChrZXlib2FyZCBhY2Nlc3NpYmxlKVxyXG4gKiBGaWxlOiBTZWxlY3Qud2ViLmpzeFxyXG4gKi9cclxuLy8gMS4gRXh0ZXJuYWwgZGVwZW5kZW5jaWVzXHJcbmltcG9ydCBSZWFjdCwgeyB1c2VFZmZlY3QsIHVzZVJlZiB9IGZyb20gJ3JlYWN0JztcclxuXHJcbi8vIDIuIFBsYXRmb3JtIGNvbXBvbmVudHMgKGZyb20gYmFycmVsIGZpbGUpIC0gTi9BIGZvciBTZWxlY3RcclxuXHJcbi8vIDMuIEhvb2tzIGFuZCB1dGlsaXRpZXMgKGFic29sdXRlIGltcG9ydHMgdmlhIGFsaWFzZXMpXHJcbmltcG9ydCB7IHVzZUkxOG4gfSBmcm9tICdAaG9va3MnO1xyXG5cclxuLy8gNC4gU3R5bGVzIChyZWxhdGl2ZSBpbXBvcnQgLSBwbGF0Zm9ybS1zcGVjaWZpYylcclxuaW1wb3J0IHtcclxuICBTdHlsZWRDb250YWluZXIsXHJcbiAgU3R5bGVkTGFiZWxSb3csXHJcbiAgU3R5bGVkTGFiZWwsXHJcbiAgU3R5bGVkUmVxdWlyZWQsXHJcbiAgU3R5bGVkVHJpZ2dlcixcclxuICBTdHlsZWRUcmlnZ2VyVGV4dCxcclxuICBTdHlsZWRDaGV2cm9uLFxyXG4gIFN0eWxlZE1lbnUsXHJcbiAgU3R5bGVkT3B0aW9uLFxyXG4gIFN0eWxlZE9wdGlvblRleHQsXHJcbiAgU3R5bGVkSGVscGVyVGV4dCxcclxufSBmcm9tICcuL1NlbGVjdC53ZWIuc3R5bGVzJztcclxuXHJcbi8vIDUuIENvbXBvbmVudC1zcGVjaWZpYyBob29rIChyZWxhdGl2ZSBpbXBvcnQpXHJcbmltcG9ydCB1c2VTZWxlY3QgZnJvbSAnLi91c2VTZWxlY3QnO1xyXG5cclxuLy8gNi4gVHlwZXMgYW5kIGNvbnN0YW50cyAocmVsYXRpdmUgaW1wb3J0KVxyXG5pbXBvcnQgeyBWQUxJREFUSU9OX1NUQVRFUyB9IGZyb20gJy4vdHlwZXMnO1xyXG5cclxuLyoqXHJcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFNlbGVjdE9wdGlvblxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbGFiZWxcclxuICogQHByb3BlcnR5IHtzdHJpbmd8bnVtYmVyfSB2YWx1ZVxyXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IFtkaXNhYmxlZF1cclxuICovXHJcblxyXG4vKipcclxuICogQHBhcmFtIHtPYmplY3R9IHByb3BzXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvcHMubGFiZWxdXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvcHMucGxhY2Vob2xkZXJdXHJcbiAqIEBwYXJhbSB7U2VsZWN0T3B0aW9uW119IHByb3BzLm9wdGlvbnNcclxuICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfG51bGx8dW5kZWZpbmVkfSBwcm9wcy52YWx1ZVxyXG4gKiBAcGFyYW0geyh2YWx1ZTogYW55KSA9PiB2b2lkfSBwcm9wcy5vblZhbHVlQ2hhbmdlXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW3Byb3BzLnJlcXVpcmVkXVxyXG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtwcm9wcy5kaXNhYmxlZF1cclxuICogQHBhcmFtIHtzdHJpbmd9IFtwcm9wcy52YWxpZGF0aW9uU3RhdGVdXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvcHMuZXJyb3JNZXNzYWdlXVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gW3Byb3BzLmhlbHBlclRleHRdXHJcbiAqIEBwYXJhbSB7KHZhbHVlOiBhbnkpID0+IGJvb2xlYW58e3ZhbGlkOiBib29sZWFuLCBlcnJvcj86IHN0cmluZ319IFtwcm9wcy52YWxpZGF0ZV1cclxuICogQHBhcmFtIHtzdHJpbmd9IFtwcm9wcy5hY2Nlc3NpYmlsaXR5TGFiZWxdXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvcHMuYWNjZXNzaWJpbGl0eUhpbnRdXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvcHMudGVzdElEXVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gW3Byb3BzLmNsYXNzTmFtZV1cclxuICogQHBhcmFtIHtPYmplY3R9IFtwcm9wcy5zdHlsZV1cclxuICogQHBhcmFtIHtib29sZWFufSBbcHJvcHMuY29tcGFjdF1cclxuICovXHJcbmNvbnN0IFNlbGVjdFdlYiA9ICh7XHJcbiAgbGFiZWwsXHJcbiAgcGxhY2Vob2xkZXIsXHJcbiAgb3B0aW9ucyA9IFtdLFxyXG4gIHZhbHVlLFxyXG4gIG9uVmFsdWVDaGFuZ2UsXHJcbiAgcmVxdWlyZWQgPSBmYWxzZSxcclxuICBkaXNhYmxlZCA9IGZhbHNlLFxyXG4gIHZhbGlkYXRpb25TdGF0ZSxcclxuICBlcnJvck1lc3NhZ2UsXHJcbiAgaGVscGVyVGV4dCxcclxuICB2YWxpZGF0ZSxcclxuICBhY2Nlc3NpYmlsaXR5TGFiZWwsXHJcbiAgYWNjZXNzaWJpbGl0eUhpbnQsXHJcbiAgdGVzdElELFxyXG4gIGNsYXNzTmFtZSxcclxuICBzdHlsZSxcclxuICBjb21wYWN0ID0gZmFsc2UsXHJcbn0pID0+IHtcclxuICBjb25zdCB7IHQgfSA9IHVzZUkxOG4oKTtcclxuICBjb25zdCBkZWZhdWx0UGxhY2Vob2xkZXIgPSBwbGFjZWhvbGRlciB8fCB0KCdjb21tb24uc2VsZWN0UGxhY2Vob2xkZXInKTtcclxuICBcclxuICBjb25zdCB7XHJcbiAgICBvcGVuLFxyXG4gICAgaXNGb2N1c2VkLFxyXG4gICAgdmFsaWRhdGlvblN0YXRlOiBpbnRlcm5hbFZhbGlkYXRpb25TdGF0ZSxcclxuICAgIGVycm9yTWVzc2FnZTogaW50ZXJuYWxFcnJvck1lc3NhZ2UsXHJcbiAgICBzZWxlY3RlZE9wdGlvbixcclxuICAgIG9wZW5TZWxlY3QsXHJcbiAgICBjbG9zZVNlbGVjdCxcclxuICAgIHRvZ2dsZVNlbGVjdCxcclxuICAgIGhhbmRsZUZvY3VzLFxyXG4gICAgaGFuZGxlQmx1cixcclxuICAgIGhhbmRsZVNlbGVjdCxcclxuICB9ID0gdXNlU2VsZWN0KHsgdmFsdWUsIG9wdGlvbnMsIG9uVmFsdWVDaGFuZ2UsIHJlcXVpcmVkLCB2YWxpZGF0ZSB9KTtcclxuXHJcbiAgY29uc3QgZmluYWxWYWxpZGF0aW9uU3RhdGUgPSB2YWxpZGF0aW9uU3RhdGUgfHwgKGRpc2FibGVkID8gVkFMSURBVElPTl9TVEFURVMuRElTQUJMRUQgOiBpbnRlcm5hbFZhbGlkYXRpb25TdGF0ZSk7XHJcbiAgY29uc3QgZmluYWxFcnJvck1lc3NhZ2UgPSBlcnJvck1lc3NhZ2UgfHwgaW50ZXJuYWxFcnJvck1lc3NhZ2U7XHJcbiAgY29uc3QgZGlzcGxheUhlbHBlclRleHQgPSBmaW5hbEVycm9yTWVzc2FnZSB8fCBoZWxwZXJUZXh0O1xyXG5cclxuICBjb25zdCByb290UmVmID0gdXNlUmVmKG51bGwpO1xyXG4gIGNvbnN0IG1lbnVSZWYgPSB1c2VSZWYobnVsbCk7XHJcbiAgY29uc3QgW2ZvY3VzZWRJbmRleCwgc2V0Rm9jdXNlZEluZGV4XSA9IFJlYWN0LnVzZVN0YXRlKC0xKTtcclxuXHJcbiAgLy8gQ2xvc2Ugb24gb3V0c2lkZSBjbGlja1xyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBpZiAoIW9wZW4pIHJldHVybjtcclxuXHJcbiAgICBjb25zdCBoYW5kbGVDbGlja091dHNpZGUgPSAoZXZlbnQpID0+IHtcclxuICAgICAgaWYgKHJvb3RSZWYuY3VycmVudCAmJiAhcm9vdFJlZi5jdXJyZW50LmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcclxuICAgICAgICBjbG9zZVNlbGVjdCgpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGhhbmRsZUNsaWNrT3V0c2lkZSk7XHJcbiAgICByZXR1cm4gKCkgPT4gZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgaGFuZGxlQ2xpY2tPdXRzaWRlKTtcclxuICB9LCBbY2xvc2VTZWxlY3QsIG9wZW5dKTtcclxuXHJcbiAgLy8gUmVzZXQgZm9jdXNlZCBpbmRleCB3aGVuIG1lbnUgb3BlbnMvY2xvc2VzXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmIChvcGVuKSB7XHJcbiAgICAgIHNldEZvY3VzZWRJbmRleCgtMSk7XHJcbiAgICB9XHJcbiAgfSwgW29wZW5dKTtcclxuXHJcbiAgLy8gRm9jdXMgZmlyc3Qgb3B0aW9uIHdoZW4gbWVudSBvcGVuc1xyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBpZiAob3BlbiAmJiBtZW51UmVmLmN1cnJlbnQpIHtcclxuICAgICAgY29uc3QgZmlyc3RPcHRpb24gPSBtZW51UmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvcignW3JvbGU9XCJvcHRpb25cIl06bm90KFthcmlhLWRpc2FibGVkPVwidHJ1ZVwiXSknKTtcclxuICAgICAgaWYgKGZpcnN0T3B0aW9uKSB7XHJcbiAgICAgICAgZmlyc3RPcHRpb24uZm9jdXMoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0sIFtvcGVuXSk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZVRyaWdnZXJLZXlEb3duID0gKGUpID0+IHtcclxuICAgIGlmIChkaXNhYmxlZCkgcmV0dXJuO1xyXG4gICAgaWYgKGUua2V5ID09PSAnRW50ZXInIHx8IGUua2V5ID09PSAnICcpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0b2dnbGVTZWxlY3QoKTtcclxuICAgIH1cclxuICAgIGlmIChlLmtleSA9PT0gJ0Fycm93RG93bicpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBvcGVuU2VsZWN0KCk7XHJcbiAgICB9XHJcbiAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY2xvc2VTZWxlY3QoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVNZW51S2V5RG93biA9IChlKSA9PiB7XHJcbiAgICBpZiAoZGlzYWJsZWQpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCBlbmFibGVkT3B0aW9ucyA9IG9wdGlvbnMuZmlsdGVyKChvcHQpID0+ICFvcHQuZGlzYWJsZWQpO1xyXG4gICAgY29uc3QgY3VycmVudEluZGV4ID0gZW5hYmxlZE9wdGlvbnMuZmluZEluZGV4KChvcHQsIGlkeCkgPT4ge1xyXG4gICAgICBjb25zdCBvcHRpb25JbmRleCA9IG9wdGlvbnMuaW5kZXhPZihvcHQpO1xyXG4gICAgICByZXR1cm4gb3B0aW9uSW5kZXggPT09IGZvY3VzZWRJbmRleDtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChlLmtleSA9PT0gJ0Fycm93RG93bicpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjb25zdCBuZXh0SW5kZXggPSBjdXJyZW50SW5kZXggPCBlbmFibGVkT3B0aW9ucy5sZW5ndGggLSAxID8gY3VycmVudEluZGV4ICsgMSA6IDA7XHJcbiAgICAgIGNvbnN0IG5leHRPcHRpb24gPSBlbmFibGVkT3B0aW9uc1tuZXh0SW5kZXhdO1xyXG4gICAgICBjb25zdCBuZXh0T3B0aW9uSW5kZXggPSBvcHRpb25zLmluZGV4T2YobmV4dE9wdGlvbik7XHJcbiAgICAgIHNldEZvY3VzZWRJbmRleChuZXh0T3B0aW9uSW5kZXgpO1xyXG4gICAgICBpZiAobWVudVJlZi5jdXJyZW50KSB7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9uRWxlbWVudCA9IHRlc3RJRFxyXG4gICAgICAgICAgPyBtZW51UmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtdGVzdGlkPVwiJHt0ZXN0SUR9LW9wdGlvbi0ke25leHRPcHRpb25JbmRleH1cIl1gKVxyXG4gICAgICAgICAgOiBtZW51UmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvckFsbCgnW3JvbGU9XCJvcHRpb25cIl0nKVtuZXh0T3B0aW9uSW5kZXhdO1xyXG4gICAgICAgIGlmIChvcHRpb25FbGVtZW50KSB7XHJcbiAgICAgICAgICBvcHRpb25FbGVtZW50LmZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnQXJyb3dVcCcpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjb25zdCBwcmV2SW5kZXggPSBjdXJyZW50SW5kZXggPiAwID8gY3VycmVudEluZGV4IC0gMSA6IGVuYWJsZWRPcHRpb25zLmxlbmd0aCAtIDE7XHJcbiAgICAgIGNvbnN0IHByZXZPcHRpb24gPSBlbmFibGVkT3B0aW9uc1twcmV2SW5kZXhdO1xyXG4gICAgICBjb25zdCBwcmV2T3B0aW9uSW5kZXggPSBvcHRpb25zLmluZGV4T2YocHJldk9wdGlvbik7XHJcbiAgICAgIHNldEZvY3VzZWRJbmRleChwcmV2T3B0aW9uSW5kZXgpO1xyXG4gICAgICBpZiAobWVudVJlZi5jdXJyZW50KSB7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9uRWxlbWVudCA9IHRlc3RJRFxyXG4gICAgICAgICAgPyBtZW51UmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtdGVzdGlkPVwiJHt0ZXN0SUR9LW9wdGlvbi0ke3ByZXZPcHRpb25JbmRleH1cIl1gKVxyXG4gICAgICAgICAgOiBtZW51UmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvckFsbCgnW3JvbGU9XCJvcHRpb25cIl0nKVtwcmV2T3B0aW9uSW5kZXhdO1xyXG4gICAgICAgIGlmIChvcHRpb25FbGVtZW50KSB7XHJcbiAgICAgICAgICBvcHRpb25FbGVtZW50LmZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnRW50ZXInIHx8IGUua2V5ID09PSAnICcpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBpZiAoY3VycmVudEluZGV4ID49IDAgJiYgY3VycmVudEluZGV4IDwgZW5hYmxlZE9wdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgaGFuZGxlU2VsZWN0KGVuYWJsZWRPcHRpb25zW2N1cnJlbnRJbmRleF0udmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNsb3NlU2VsZWN0KCk7XHJcbiAgICAgIGlmIChyb290UmVmLmN1cnJlbnQpIHtcclxuICAgICAgICBjb25zdCB0cmlnZ2VyID0gcm9vdFJlZi5jdXJyZW50LnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwiY29tYm9ib3hcIl0nKTtcclxuICAgICAgICBpZiAodHJpZ2dlcikge1xyXG4gICAgICAgICAgdHJpZ2dlci5mb2N1cygpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8U3R5bGVkQ29udGFpbmVyIHJlZj17cm9vdFJlZn0gc3R5bGU9e3N0eWxlfSBjbGFzc05hbWU9e2NsYXNzTmFtZX0gJGNvbXBhY3Q9e2NvbXBhY3R9PlxyXG4gICAgICB7bGFiZWwgPyAoXHJcbiAgICAgICAgPFN0eWxlZExhYmVsUm93ICRjb21wYWN0PXtjb21wYWN0fT5cclxuICAgICAgICAgIDxTdHlsZWRMYWJlbD57bGFiZWx9PC9TdHlsZWRMYWJlbD5cclxuICAgICAgICAgIHtyZXF1aXJlZCA/IDxTdHlsZWRSZXF1aXJlZD4gKjwvU3R5bGVkUmVxdWlyZWQ+IDogbnVsbH1cclxuICAgICAgICA8L1N0eWxlZExhYmVsUm93PlxyXG4gICAgICApIDogbnVsbH1cclxuXHJcbiAgICAgIDxTdHlsZWRUcmlnZ2VyXHJcbiAgICAgICAgb25DbGljaz17ZGlzYWJsZWQgPyB1bmRlZmluZWQgOiB0b2dnbGVTZWxlY3R9XHJcbiAgICAgICAgb25Gb2N1cz17aGFuZGxlRm9jdXN9XHJcbiAgICAgICAgb25CbHVyPXtoYW5kbGVCbHVyfVxyXG4gICAgICAgIG9uS2V5RG93bj17aGFuZGxlVHJpZ2dlcktleURvd259XHJcbiAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxyXG4gICAgICAgICR2YWxpZGF0aW9uU3RhdGU9e2ZpbmFsVmFsaWRhdGlvblN0YXRlfVxyXG4gICAgICAgICRpc0ZvY3VzZWQ9e2lzRm9jdXNlZH1cclxuICAgICAgICAkY29tcGFjdD17Y29tcGFjdH1cclxuICAgICAgICByb2xlPVwiY29tYm9ib3hcIlxyXG4gICAgICAgIGFyaWEtbGFiZWw9e2FjY2Vzc2liaWxpdHlMYWJlbCB8fCBsYWJlbCB8fCBkZWZhdWx0UGxhY2Vob2xkZXJ9XHJcbiAgICAgICAgYXJpYS1kZXNjcmliZWRieT17ZGlzcGxheUhlbHBlclRleHQgPyBgJHt0ZXN0SUQgfHwgJ3NlbGVjdCd9LWhlbHBlcmAgOiB1bmRlZmluZWR9XHJcbiAgICAgICAgYXJpYS1leHBhbmRlZD17b3Blbn1cclxuICAgICAgICBhcmlhLWhhc3BvcHVwPVwibGlzdGJveFwiXHJcbiAgICAgICAgYXJpYS1pbnZhbGlkPXtmaW5hbFZhbGlkYXRpb25TdGF0ZSA9PT0gJ2Vycm9yJ31cclxuICAgICAgICBhcmlhLXJlcXVpcmVkPXtyZXF1aXJlZH1cclxuICAgICAgICBkYXRhLXRlc3RpZD17dGVzdElEfVxyXG4gICAgICA+XHJcbiAgICAgICAgPFN0eWxlZFRyaWdnZXJUZXh0IGRpc2FibGVkPXtkaXNhYmxlZH0gJGlzUGxhY2Vob2xkZXI9eyFzZWxlY3RlZE9wdGlvbn0+XHJcbiAgICAgICAgICB7c2VsZWN0ZWRPcHRpb24gPyBzZWxlY3RlZE9wdGlvbi5sYWJlbCA6IGRlZmF1bHRQbGFjZWhvbGRlcn1cclxuICAgICAgICA8L1N0eWxlZFRyaWdnZXJUZXh0PlxyXG4gICAgICAgIDxTdHlsZWRDaGV2cm9uIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPuKWvjwvU3R5bGVkQ2hldnJvbj5cclxuICAgICAgPC9TdHlsZWRUcmlnZ2VyPlxyXG5cclxuICAgICAge29wZW4gPyAoXHJcbiAgICAgICAgPFN0eWxlZE1lbnVcclxuICAgICAgICAgIHJlZj17bWVudVJlZn1cclxuICAgICAgICAgIHJvbGU9XCJsaXN0Ym94XCJcclxuICAgICAgICAgIG9uS2V5RG93bj17aGFuZGxlTWVudUtleURvd259XHJcbiAgICAgICAgICBkYXRhLXRlc3RpZD17dGVzdElEID8gYCR7dGVzdElEfS1tZW51YCA6IHVuZGVmaW5lZH1cclxuICAgICAgICA+XHJcbiAgICAgICAgICB7b3B0aW9ucy5tYXAoKG9wdCwgaW5kZXgpID0+IChcclxuICAgICAgICAgICAgPFN0eWxlZE9wdGlvblxyXG4gICAgICAgICAgICAgIGtleT17YCR7U3RyaW5nKG9wdC52YWx1ZSl9LSR7aW5kZXh9YH1cclxuICAgICAgICAgICAgICBkaXNhYmxlZD17ISFvcHQuZGlzYWJsZWR9XHJcbiAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdC5kaXNhYmxlZCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlU2VsZWN0KG9wdC52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICBvbkZvY3VzPXsoKSA9PiBzZXRGb2N1c2VkSW5kZXgoaW5kZXgpfVxyXG4gICAgICAgICAgICAgIHJvbGU9XCJvcHRpb25cIlxyXG4gICAgICAgICAgICAgIGFyaWEtc2VsZWN0ZWQ9e3ZhbHVlID09PSBvcHQudmFsdWV9XHJcbiAgICAgICAgICAgICAgYXJpYS1kaXNhYmxlZD17b3B0LmRpc2FibGVkfVxyXG4gICAgICAgICAgICAgIGFyaWEtbGFiZWw9e29wdC5sYWJlbH1cclxuICAgICAgICAgICAgICB0YWJJbmRleD17b3B0LmRpc2FibGVkID8gLTEgOiBpbmRleCA9PT0gMCA/IDAgOiAtMX1cclxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD17dGVzdElEID8gYCR7dGVzdElEfS1vcHRpb24tJHtpbmRleH1gIDogdW5kZWZpbmVkfVxyXG4gICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgPFN0eWxlZE9wdGlvblRleHQ+e29wdC5sYWJlbH08L1N0eWxlZE9wdGlvblRleHQ+XHJcbiAgICAgICAgICAgIDwvU3R5bGVkT3B0aW9uPlxyXG4gICAgICAgICAgKSl9XHJcbiAgICAgICAgPC9TdHlsZWRNZW51PlxyXG4gICAgICApIDogbnVsbH1cclxuXHJcbiAgICAgIHtkaXNwbGF5SGVscGVyVGV4dCA/IChcclxuICAgICAgICA8U3R5bGVkSGVscGVyVGV4dFxyXG4gICAgICAgICAgJHZhbGlkYXRpb25TdGF0ZT17ZmluYWxWYWxpZGF0aW9uU3RhdGV9XHJcbiAgICAgICAgICBpZD17dGVzdElEID8gYCR7dGVzdElEfS1oZWxwZXJgIDogdW5kZWZpbmVkfVxyXG4gICAgICAgID5cclxuICAgICAgICAgIHtkaXNwbGF5SGVscGVyVGV4dH1cclxuICAgICAgICA8L1N0eWxlZEhlbHBlclRleHQ+XHJcbiAgICAgICkgOiBudWxsfVxyXG4gICAgPC9TdHlsZWRDb250YWluZXI+XHJcbiAgKTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNlbGVjdFdlYjtcclxuXHJcblxyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFNQSxJQUFBQSxNQUFBLEdBQUFDLHVCQUFBLENBQUFDLE9BQUE7QUFLQSxJQUFBQyxNQUFBLEdBQUFELE9BQUE7QUFHQSxJQUFBRSxVQUFBLEdBQUFGLE9BQUE7QUFlQSxJQUFBRyxXQUFBLEdBQUFDLHNCQUFBLENBQUFKLE9BQUE7QUFHQSxJQUFBSyxNQUFBLEdBQUFMLE9BQUE7QUFBNEMsSUFBQU0sV0FBQSxHQUFBTixPQUFBO0FBNkI1QyxJQUFNTyxTQUFTLEdBQUcsU0FBWkEsU0FBU0EsQ0FBQUMsSUFBQSxFQWtCVDtFQUFBLElBakJKQyxLQUFLLEdBQUFELElBQUEsQ0FBTEMsS0FBSztJQUNMQyxXQUFXLEdBQUFGLElBQUEsQ0FBWEUsV0FBVztJQUFBQyxZQUFBLEdBQUFILElBQUEsQ0FDWEksT0FBTztJQUFQQSxPQUFPLEdBQUFELFlBQUEsY0FBRyxFQUFFLEdBQUFBLFlBQUE7SUFDWkUsS0FBSyxHQUFBTCxJQUFBLENB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