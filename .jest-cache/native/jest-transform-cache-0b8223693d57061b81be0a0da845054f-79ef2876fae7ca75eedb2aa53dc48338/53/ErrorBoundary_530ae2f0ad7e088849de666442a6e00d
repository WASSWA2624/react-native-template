236a87cbc149df70162d9de3fdae8e8d
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _callSuper2 = _interopRequireDefault(require("@babel/runtime/helpers/callSuper"));
var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));
var _react = _interopRequireDefault(require("react"));
var _logging = require("../logging");
var _error = require("./error.handler");
var _fallback = _interopRequireDefault(require("./fallback.ui"));
var _jsxRuntime = require("react/jsx-runtime");
var ErrorBoundary = function (_React$Component) {
  function ErrorBoundary(props) {
    var _this;
    (0, _classCallCheck2.default)(this, ErrorBoundary);
    _this = (0, _callSuper2.default)(this, ErrorBoundary, [props]);
    _this.state = {
      hasError: false,
      error: null
    };
    return _this;
  }
  (0, _inherits2.default)(ErrorBoundary, _React$Component);
  return (0, _createClass2.default)(ErrorBoundary, [{
    key: "componentDidCatch",
    value: function componentDidCatch(error, errorInfo) {
      var normalized = (0, _error.handleError)(error, {
        errorInfo: errorInfo
      });
      _logging.logger.error('ErrorBoundary caught error', {
        error: normalized,
        errorInfo: errorInfo
      });
      this.setState(function (s) {
        var _s$error;
        return (_s$error = s.error) != null && _s$error.code ? null : {
          error: normalized
        };
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;
      if (this.state.hasError) {
        return (0, _jsxRuntime.jsx)(_fallback.default, {
          error: this.state.error,
          onRetry: function onRetry() {
            return _this2.setState({
              hasError: false,
              error: null
            });
          }
        });
      }
      return this.props.children;
    }
  }], [{
    key: "getDerivedStateFromError",
    value: function getDerivedStateFromError(error) {
      return {
        hasError: true,
        error: (0, _error.normalizeError)(error)
      };
    }
  }]);
}(_react.default.Component);
var _default = exports.default = ErrorBoundary;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9sb2dnaW5nIiwiX2Vycm9yIiwiX2ZhbGxiYWNrIiwiX2pzeFJ1bnRpbWUiLCJFcnJvckJvdW5kYXJ5IiwiX1JlYWN0JENvbXBvbmVudCIsInByb3BzIiwiX3RoaXMiLCJfY2xhc3NDYWxsQ2hlY2syIiwiZGVmYXVsdCIsIl9jYWxsU3VwZXIyIiwic3RhdGUiLCJoYXNFcnJvciIsImVycm9yIiwiX2luaGVyaXRzMiIsIl9jcmVhdGVDbGFzczIiLCJrZXkiLCJ2YWx1ZSIsImNvbXBvbmVudERpZENhdGNoIiwiZXJyb3JJbmZvIiwibm9ybWFsaXplZCIsImhhbmRsZUVycm9yIiwibG9nZ2VyIiwic2V0U3RhdGUiLCJzIiwiX3MkZXJyb3IiLCJjb2RlIiwicmVuZGVyIiwiX3RoaXMyIiwianN4Iiwib25SZXRyeSIsImNoaWxkcmVuIiwiZ2V0RGVyaXZlZFN0YXRlRnJvbUVycm9yIiwibm9ybWFsaXplRXJyb3IiLCJSZWFjdCIsIkNvbXBvbmVudCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIkVycm9yQm91bmRhcnkuanN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBFcnJvciBCb3VuZGFyeSBDb21wb25lbnRcclxuICogQ2F0Y2hlcyBSZWFjdCByZW5kZXJpbmcgZXJyb3JzXHJcbiAqIEZpbGU6IEVycm9yQm91bmRhcnkuanN4XHJcbiAqL1xyXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAbG9nZ2luZyc7XHJcbmltcG9ydCB7IGhhbmRsZUVycm9yLCBub3JtYWxpemVFcnJvciB9IGZyb20gJy4vZXJyb3IuaGFuZGxlcic7XHJcbmltcG9ydCBGYWxsYmFja1VJIGZyb20gJy4vZmFsbGJhY2sudWknO1xyXG5cclxuY2xhc3MgRXJyb3JCb3VuZGFyeSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7IGhhc0Vycm9yOiBmYWxzZSwgZXJyb3I6IG51bGwgfTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBnZXREZXJpdmVkU3RhdGVGcm9tRXJyb3IoZXJyb3IpIHtcclxuICAgIHJldHVybiB7IGhhc0Vycm9yOiB0cnVlLCBlcnJvcjogbm9ybWFsaXplRXJyb3IoZXJyb3IpIH07XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnREaWRDYXRjaChlcnJvciwgZXJyb3JJbmZvKSB7XHJcbiAgICBjb25zdCBub3JtYWxpemVkID0gaGFuZGxlRXJyb3IoZXJyb3IsIHsgZXJyb3JJbmZvIH0pO1xyXG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvckJvdW5kYXJ5IGNhdWdodCBlcnJvcicsIHtcclxuICAgICAgZXJyb3I6IG5vcm1hbGl6ZWQsXHJcbiAgICAgIGVycm9ySW5mbyxcclxuICAgIH0pO1xyXG4gICAgdGhpcy5zZXRTdGF0ZSgocykgPT4gKHMuZXJyb3I/LmNvZGUgPyBudWxsIDogeyBlcnJvcjogbm9ybWFsaXplZCB9KSk7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBpZiAodGhpcy5zdGF0ZS5oYXNFcnJvcikge1xyXG4gICAgICByZXR1cm4gKFxyXG4gICAgICAgIDxGYWxsYmFja1VJXHJcbiAgICAgICAgICBlcnJvcj17dGhpcy5zdGF0ZS5lcnJvcn1cclxuICAgICAgICAgIG9uUmV0cnk9eygpID0+IHRoaXMuc2V0U3RhdGUoeyBoYXNFcnJvcjogZmFsc2UsIGVycm9yOiBudWxsIH0pfVxyXG4gICAgICAgIC8+XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMucHJvcHMuY2hpbGRyZW47XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBFcnJvckJvdW5kYXJ5O1xyXG5cclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFLQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxRQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxNQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxTQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFBdUMsSUFBQUksV0FBQSxHQUFBSixPQUFBO0FBQUEsSUFFakNLLGFBQWEsYUFBQUMsZ0JBQUE7RUFDakIsU0FBQUQsY0FBWUUsS0FBSyxFQUFFO0lBQUEsSUFBQUMsS0FBQTtJQUFBLElBQUFDLGdCQUFBLENBQUFDLE9BQUEsUUFBQUwsYUFBQTtJQUNqQkcsS0FBQSxPQUFBRyxXQUFBLENBQUFELE9BQUEsUUFBQUwsYUFBQSxHQUFNRSxLQUFLO0lBQ1hDLEtBQUEsQ0FBS0ksS0FBSyxHQUFHO01BQUVDLFFBQVEsRUFBRSxLQUFLO01BQUVDLEtBQUssRUFBRTtJQUFLLENBQUM7SUFBQyxPQUFBTixLQUFBO0VBQ2hEO0VBQUMsSUFBQU8sVUFBQSxDQUFBTCxPQUFBLEVBQUFMLGFBQUEsRUFBQUMsZ0JBQUE7RUFBQSxXQUFBVSxhQUFBLENBQUFOLE9BQUEsRUFBQUwsYUFBQTtJQUFBWSxHQUFBO0lBQUFDLEtBQUEsRUFNRCxTQUFBQyxpQkFBaUJBLENBQUNMLEtBQUssRUFBRU0sU0FBUyxFQUFFO01BQ2xDLElBQU1DLFVBQVUsR0FBRyxJQUFBQyxrQkFBVyxFQUFDUixLQUFLLEVBQUU7UUFBRU0sU0FBUyxFQUFUQTtNQUFVLENBQUMsQ0FBQztNQUNwREcsZUFBTSxDQUFDVCxLQUFLLENBQUMsNEJBQTRCLEVBQUU7UUFDekNBLEtBQUssRUFBRU8sVUFBVTtRQUNqQkQsU0FBUyxFQUFUQTtNQUNGLENBQUMsQ0FBQztNQUNGLElBQUksQ0FBQ0ksUUFBUSxDQUFDLFVBQUNDLENBQUM7UUFBQSxJQUFBQyxRQUFBO1FBQUEsT0FBTSxDQUFBQSxRQUFBLEdBQUFELENBQUMsQ0FBQ1gsS0FBSyxhQUFQWSxRQUFBLENBQVNDLElBQUksR0FBRyxJQUFJLEdBQUc7VUFBRWIsS0FBSyxFQUFFTztRQUFXLENBQUM7TUFBQSxDQUFDLENBQUM7SUFDdEU7RUFBQztJQUFBSixHQUFBO0lBQUFDLEtBQUEsRUFFRCxTQUFBVSxNQUFNQSxDQUFBLEVBQUc7TUFBQSxJQUFBQyxNQUFBO01BQ1AsSUFBSSxJQUFJLENBQUNqQixLQUFLLENBQUNDLFFBQVEsRUFBRTtRQUN2QixPQUNFLElBQUFULFdBQUEsQ0FBQTBCLEdBQUEsRUFBQzNCLFNBQUEsQ0FBQU8sT0FBVTtVQUNUSSxLQUFLLEVBQUUsSUFBSSxDQUFDRixLQUFLLENBQUNFLEtBQU07VUFDeEJpQixPQUFPLEVBQUUsU0FBVEEsT0FBT0EsQ0FBQTtZQUFBLE9BQVFGLE1BQUksQ0FBQ0wsUUFBUSxDQUFDO2NBQUVYLFFBQVEsRUFBRSxLQUFLO2NBQUVDLEtBQUssRUFBRTtZQUFLLENBQUMsQ0FBQztVQUFBO1FBQUMsQ0FDaEUsQ0FBQztNQUVOO01BRUEsT0FBTyxJQUFJLENBQUNQLEtBQUssQ0FBQ3lCLFFBQVE7SUFDNUI7RUFBQztJQUFBZixHQUFBO0lBQUFDLEtBQUEsRUF4QkQsU0FBT2Usd0JBQXdCQSxDQUFDbkIsS0FBSyxFQUFFO01BQ3JDLE9BQU87UUFBRUQsUUFBUSxFQUFFLElBQUk7UUFBRUMsS0FBSyxFQUFFLElBQUFvQixxQkFBYyxFQUFDcEIsS0FBSztNQUFFLENBQUM7SUFDekQ7RUFBQztBQUFBLEVBUnlCcUIsY0FBSyxDQUFDQyxTQUFTO0FBQUEsSUFBQUMsUUFBQSxHQUFBQyxPQUFBLENBQUE1QixPQUFBLEdBaUM1QkwsYUFBYSIsImlnbm9yZUxpc3QiOltdfQ==