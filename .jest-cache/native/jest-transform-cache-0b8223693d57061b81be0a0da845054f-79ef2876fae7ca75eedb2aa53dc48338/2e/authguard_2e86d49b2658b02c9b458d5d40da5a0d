1989105b197d9bc64d73c9d2c50164f8
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useAuthGuard = useAuthGuard;
var _react = require("react");
var _reactRedux = require("react-redux");
var _expoRouter = require("expo-router");
var _selectors = require("../../store/selectors");
function useAuthGuard() {
  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var _options$redirectPath = options.redirectPath,
    redirectPath = _options$redirectPath === void 0 ? '/home' : _options$redirectPath,
    _options$skipRedirect = options.skipRedirect,
    skipRedirect = _options$skipRedirect === void 0 ? false : _options$skipRedirect;
  var router = (0, _expoRouter.useRouter)();
  var isAuthenticated = (0, _reactRedux.useSelector)(_selectors.selectIsAuthenticated);
  var user = (0, _reactRedux.useSelector)(_selectors.selectUser);
  var hasRedirected = (0, _react.useRef)(false);
  (0, _react.useEffect)(function () {
    if (skipRedirect) {
      return;
    }
    if (isAuthenticated) {
      hasRedirected.current = false;
      return;
    }
    if (hasRedirected.current) return;
    hasRedirected.current = true;
    var id = requestAnimationFrame(function () {
      requestAnimationFrame(function () {
        router.replace(redirectPath);
      });
    });
    return function () {
      return cancelAnimationFrame(id);
    };
  }, [isAuthenticated, redirectPath, router, skipRedirect]);
  return {
    authenticated: isAuthenticated,
    user: user || null
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3JlYWN0UmVkdXgiLCJfZXhwb1JvdXRlciIsIl9zZWxlY3RvcnMiLCJ1c2VBdXRoR3VhcmQiLCJvcHRpb25zIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX29wdGlvbnMkcmVkaXJlY3RQYXRoIiwicmVkaXJlY3RQYXRoIiwiX29wdGlvbnMkc2tpcFJlZGlyZWN0Iiwic2tpcFJlZGlyZWN0Iiwicm91dGVyIiwidXNlUm91dGVyIiwiaXNBdXRoZW50aWNhdGVkIiwidXNlU2VsZWN0b3IiLCJzZWxlY3RJc0F1dGhlbnRpY2F0ZWQiLCJ1c2VyIiwic2VsZWN0VXNlciIsImhhc1JlZGlyZWN0ZWQiLCJ1c2VSZWYiLCJ1c2VFZmZlY3QiLCJjdXJyZW50IiwiaWQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJyZXBsYWNlIiwiY2FuY2VsQW5pbWF0aW9uRnJhbWUiLCJhdXRoZW50aWNhdGVkIl0sInNvdXJjZXMiOlsiYXV0aC5ndWFyZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQXV0aCBHdWFyZCBIb29rXHJcbiAqIFxyXG4gKiBDaGVja3MgYXV0aGVudGljYXRpb24gc3RhdGUgYW5kIHJlZGlyZWN0cyB1bmF1dGhlbnRpY2F0ZWQgdXNlcnMuXHJcbiAqIFxyXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyAtIENvbmZpZ3VyYXRpb24gb3B0aW9uc1xyXG4gKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMucmVkaXJlY3RQYXRoPScvaG9tZSddIC0gUGF0aCB0byByZWRpcmVjdCB0byBpZiB1bmF1dGhlbnRpY2F0ZWRcclxuICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5za2lwUmVkaXJlY3Q9ZmFsc2VdIC0gSWYgdHJ1ZSwgc2tpcCBhdXRvbWF0aWMgcmVkaXJlY3QgKHVzZWZ1bCBmb3IgYXV0aCBsYXlvdXRzIHRoYXQgbmVlZCB0byByZWRpcmVjdCBhdXRoZW50aWNhdGVkIHVzZXJzKVxyXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBBdXRoIHN0YXRlIG9iamVjdCB3aXRoIHsgYXV0aGVudGljYXRlZCwgdXNlciB9XHJcbiAqIFxyXG4gKiBAZXhhbXBsZVxyXG4gKiBjb25zdCB7IGF1dGhlbnRpY2F0ZWQsIHVzZXIgfSA9IHVzZUF1dGhHdWFyZCgpO1xyXG4gKiBjb25zdCB7IGF1dGhlbnRpY2F0ZWQsIHVzZXIgfSA9IHVzZUF1dGhHdWFyZCh7IHJlZGlyZWN0UGF0aDogJy9jdXN0b20tbG9naW4nIH0pO1xyXG4gKiBjb25zdCB7IGF1dGhlbnRpY2F0ZWQsIHVzZXIgfSA9IHVzZUF1dGhHdWFyZCh7IHNraXBSZWRpcmVjdDogdHJ1ZSB9KTsgLy8gRm9yIGF1dGggbGF5b3V0c1xyXG4gKi9cclxuXHJcbmltcG9ydCB7IHVzZUVmZmVjdCwgdXNlUmVmIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyB1c2VTZWxlY3RvciB9IGZyb20gJ3JlYWN0LXJlZHV4JztcclxuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAnZXhwby1yb3V0ZXInO1xyXG5pbXBvcnQgeyBzZWxlY3RJc0F1dGhlbnRpY2F0ZWQsIHNlbGVjdFVzZXIgfSBmcm9tICdAc3RvcmUvc2VsZWN0b3JzJztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1c2VBdXRoR3VhcmQob3B0aW9ucyA9IHt9KSB7XHJcbiAgY29uc3QgeyByZWRpcmVjdFBhdGggPSAnL2hvbWUnLCBza2lwUmVkaXJlY3QgPSBmYWxzZSB9ID0gb3B0aW9ucztcclxuICBcclxuICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTtcclxuICBjb25zdCBpc0F1dGhlbnRpY2F0ZWQgPSB1c2VTZWxlY3RvcihzZWxlY3RJc0F1dGhlbnRpY2F0ZWQpO1xyXG4gIGNvbnN0IHVzZXIgPSB1c2VTZWxlY3RvcihzZWxlY3RVc2VyKTtcclxuICBcclxuICAvLyBVc2UgcmVmIHRvIHRyYWNrIGlmIHJlZGlyZWN0IGhhcyBiZWVuIHBlcmZvcm1lZCB0byBwcmV2ZW50IG11bHRpcGxlIHJlZGlyZWN0c1xyXG4gIGNvbnN0IGhhc1JlZGlyZWN0ZWQgPSB1c2VSZWYoZmFsc2UpO1xyXG4gIFxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBpZiAoc2tpcFJlZGlyZWN0KSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChpc0F1dGhlbnRpY2F0ZWQpIHtcclxuICAgICAgaGFzUmVkaXJlY3RlZC5jdXJyZW50ID0gZmFsc2U7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChoYXNSZWRpcmVjdGVkLmN1cnJlbnQpIHJldHVybjtcclxuICAgIGhhc1JlZGlyZWN0ZWQuY3VycmVudCA9IHRydWU7XHJcbiAgICBjb25zdCBpZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XHJcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XHJcbiAgICAgICAgcm91dGVyLnJlcGxhY2UocmVkaXJlY3RQYXRoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiAoKSA9PiBjYW5jZWxBbmltYXRpb25GcmFtZShpZCk7XHJcbiAgfSwgW2lzQXV0aGVudGljYXRlZCwgcmVkaXJlY3RQYXRoLCByb3V0ZXIsIHNraXBSZWRpcmVjdF0pO1xyXG4gIFxyXG4gIHJldHVybiB7XHJcbiAgICBhdXRoZW50aWNhdGVkOiBpc0F1dGhlbnRpY2F0ZWQsXHJcbiAgICB1c2VyOiB1c2VyIHx8IG51bGwsXHJcbiAgfTtcclxufVxyXG5cclxuIl0sIm1hcHBpbmdzIjoiOzs7O0FBZ0JBLElBQUFBLE1BQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLFdBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLFdBQUEsR0FBQUYsT0FBQTtBQUNBLElBQUFHLFVBQUEsR0FBQUgsT0FBQTtBQUVPLFNBQVNJLFlBQVlBLENBQUEsRUFBZTtFQUFBLElBQWRDLE9BQU8sR0FBQUMsU0FBQSxDQUFBQyxNQUFBLFFBQUFELFNBQUEsUUFBQUUsU0FBQSxHQUFBRixTQUFBLE1BQUcsQ0FBQyxDQUFDO0VBQ3ZDLElBQUFHLHFCQUFBLEdBQXlESixPQUFPLENBQXhESyxZQUFZO0lBQVpBLFlBQVksR0FBQUQscUJBQUEsY0FBRyxPQUFPLEdBQUFBLHFCQUFBO0lBQUFFLHFCQUFBLEdBQTJCTixPQUFPLENBQWhDTyxZQUFZO0lBQVpBLFlBQVksR0FBQUQscUJBQUEsY0FBRyxLQUFLLEdBQUFBLHFCQUFBO0VBRXBELElBQU1FLE1BQU0sR0FBRyxJQUFBQyxxQkFBUyxFQUFDLENBQUM7RUFDMUIsSUFBTUMsZUFBZSxHQUFHLElBQUFDLHVCQUFXLEVBQUNDLGdDQUFxQixDQUFDO0VBQzFELElBQU1DLElBQUksR0FBRyxJQUFBRix1QkFBVyxFQUFDRyxxQkFBVSxDQUFDO0VBR3BDLElBQU1DLGFBQWEsR0FBRyxJQUFBQyxhQUFNLEVBQUMsS0FBSyxDQUFDO0VBRW5DLElBQUFDLGdCQUFTLEVBQUMsWUFBTTtJQUNkLElBQUlWLFlBQVksRUFBRTtNQUNoQjtJQUNGO0lBQ0EsSUFBSUcsZUFBZSxFQUFFO01BQ25CSyxhQUFhLENBQUNHLE9BQU8sR0FBRyxLQUFLO01BQzdCO0lBQ0Y7SUFDQSxJQUFJSCxhQUFhLENBQUNHLE9BQU8sRUFBRTtJQUMzQkgsYUFBYSxDQUFDRyxPQUFPLEdBQUcsSUFBSTtJQUM1QixJQUFNQyxFQUFFLEdBQUdDLHFCQUFxQixDQUFDLFlBQU07TUFDckNBLHFCQUFxQixDQUFDLFlBQU07UUFDMUJaLE1BQU0sQ0FBQ2EsT0FBTyxDQUFDaEIsWUFBWSxDQUFDO01BQzlCLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQztJQUNGLE9BQU87TUFBQSxPQUFNaUIsb0JBQW9CLENBQUNILEVBQUUsQ0FBQztJQUFBO0VBQ3ZDLENBQUMsRUFBRSxDQUFDVCxlQUFlLEVBQUVMLFlBQVksRUFBRUcsTUFBTSxFQUFFRCxZQUFZLENBQUMsQ0FBQztFQUV6RCxPQUFPO0lBQ0xnQixhQUFhLEVBQUViLGVBQWU7SUFDOUJHLElBQUksRUFBRUEsSUFBSSxJQUFJO0VBQ2hCLENBQUM7QUFDSCIsImlnbm9yZUxpc3QiOltdfQ==