766029160aa5e1d0a5d3c229039295ea
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _callSuper2 = _interopRequireDefault(require("@babel/runtime/helpers/callSuper"));
var _superPropGet2 = _interopRequireDefault(require("@babel/runtime/helpers/superPropGet"));
var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));
var _Animation2 = _interopRequireDefault(require("./Animation"));
var DecayAnimation = exports.default = function (_Animation) {
  function DecayAnimation(config) {
    var _config$deceleration;
    var _this;
    (0, _classCallCheck2.default)(this, DecayAnimation);
    _this = (0, _callSuper2.default)(this, DecayAnimation, [config]);
    _this._deceleration = (_config$deceleration = config.deceleration) != null ? _config$deceleration : 0.998;
    _this._velocity = config.velocity;
    _this._platformConfig = config.platformConfig;
    return _this;
  }
  (0, _inherits2.default)(DecayAnimation, _Animation);
  return (0, _createClass2.default)(DecayAnimation, [{
    key: "__getNativeAnimationConfig",
    value: function __getNativeAnimationConfig() {
      return {
        type: 'decay',
        deceleration: this._deceleration,
        velocity: this._velocity,
        iterations: this.__iterations,
        platformConfig: this._platformConfig,
        debugID: this.__getDebugID()
      };
    }
  }, {
    key: "start",
    value: function start(fromValue, onUpdate, onEnd, previousAnimation, animatedValue) {
      var _this2 = this;
      (0, _superPropGet2.default)(DecayAnimation, "start", this, 3)([fromValue, onUpdate, onEnd, previousAnimation, animatedValue]);
      this._lastValue = fromValue;
      this._fromValue = fromValue;
      this._onUpdate = onUpdate;
      this._startTime = Date.now();
      var useNativeDriver = this.__startAnimationIfNative(animatedValue);
      if (!useNativeDriver) {
        this._animationFrame = requestAnimationFrame(function () {
          return _this2.onUpdate();
        });
      }
    }
  }, {
    key: "onUpdate",
    value: function onUpdate() {
      var now = Date.now();
      var value = this._fromValue + this._velocity / (1 - this._deceleration) * (1 - Math.exp(-(1 - this._deceleration) * (now - this._startTime)));
      this._onUpdate(value);
      if (Math.abs(this._lastValue - value) < 0.1) {
        this.__notifyAnimationEnd({
          finished: true
        });
        return;
      }
      this._lastValue = value;
      if (this.__active) {
        this._animationFrame = requestAnimationFrame(this.onUpdate.bind(this));
      }
    }
  }, {
    key: "stop",
    value: function stop() {
      (0, _superPropGet2.default)(DecayAnimation, "stop", this, 3)([]);
      if (this._animationFrame != null) {
        global.cancelAnimationFrame(this._animationFrame);
      }
      this.__notifyAnimationEnd({
        finished: false
      });
    }
  }]);
}(_Animation2.default);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQW5pbWF0aW9uMiIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiRGVjYXlBbmltYXRpb24iLCJleHBvcnRzIiwiZGVmYXVsdCIsIl9BbmltYXRpb24iLCJjb25maWciLCJfY29uZmlnJGRlY2VsZXJhdGlvbiIsIl90aGlzIiwiX2NsYXNzQ2FsbENoZWNrMiIsIl9jYWxsU3VwZXIyIiwiX2RlY2VsZXJhdGlvbiIsImRlY2VsZXJhdGlvbiIsIl92ZWxvY2l0eSIsInZlbG9jaXR5IiwiX3BsYXRmb3JtQ29uZmlnIiwicGxhdGZvcm1Db25maWciLCJfaW5oZXJpdHMyIiwiX2NyZWF0ZUNsYXNzMiIsImtleSIsInZhbHVlIiwiX19nZXROYXRpdmVBbmltYXRpb25Db25maWciLCJ0eXBlIiwiaXRlcmF0aW9ucyIsIl9faXRlcmF0aW9ucyIsImRlYnVnSUQiLCJfX2dldERlYnVnSUQiLCJzdGFydCIsImZyb21WYWx1ZSIsIm9uVXBkYXRlIiwib25FbmQiLCJwcmV2aW91c0FuaW1hdGlvbiIsImFuaW1hdGVkVmFsdWUiLCJfdGhpczIiLCJfc3VwZXJQcm9wR2V0MiIsIl9sYXN0VmFsdWUiLCJfZnJvbVZhbHVlIiwiX29uVXBkYXRlIiwiX3N0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJ1c2VOYXRpdmVEcml2ZXIiLCJfX3N0YXJ0QW5pbWF0aW9uSWZOYXRpdmUiLCJfYW5pbWF0aW9uRnJhbWUiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJNYXRoIiwiZXhwIiwiYWJzIiwiX19ub3RpZnlBbmltYXRpb25FbmQiLCJmaW5pc2hlZCIsIl9fYWN0aXZlIiwiYmluZCIsInN0b3AiLCJnbG9iYWwiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsIkFuaW1hdGlvbiJdLCJzb3VyY2VzIjpbIkRlY2F5QW5pbWF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBNZXRhIFBsYXRmb3JtcywgSW5jLiBhbmQgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvdyBzdHJpY3QtbG9jYWxcbiAqIEBmb3JtYXRcbiAqL1xuXG5pbXBvcnQgdHlwZSB7UGxhdGZvcm1Db25maWd9IGZyb20gJy4uL0FuaW1hdGVkUGxhdGZvcm1Db25maWcnO1xuaW1wb3J0IHR5cGUgQW5pbWF0ZWRWYWx1ZSBmcm9tICcuLi9ub2Rlcy9BbmltYXRlZFZhbHVlJztcbmltcG9ydCB0eXBlIHtBbmltYXRpb25Db25maWcsIEVuZENhbGxiYWNrfSBmcm9tICcuL0FuaW1hdGlvbic7XG5cbmltcG9ydCBBbmltYXRpb24gZnJvbSAnLi9BbmltYXRpb24nO1xuXG5leHBvcnQgdHlwZSBEZWNheUFuaW1hdGlvbkNvbmZpZyA9ICRSZWFkT25seTx7XG4gIC4uLkFuaW1hdGlvbkNvbmZpZyxcbiAgdmVsb2NpdHk6XG4gICAgfCBudW1iZXJcbiAgICB8ICRSZWFkT25seTx7XG4gICAgICAgIHg6IG51bWJlcixcbiAgICAgICAgeTogbnVtYmVyLFxuICAgICAgICAuLi5cbiAgICAgIH0+LFxuICBkZWNlbGVyYXRpb24/OiBudW1iZXIsXG4gIC4uLlxufT47XG5cbmV4cG9ydCB0eXBlIERlY2F5QW5pbWF0aW9uQ29uZmlnU2luZ2xlID0gJFJlYWRPbmx5PHtcbiAgLi4uQW5pbWF0aW9uQ29uZmlnLFxuICB2ZWxvY2l0eTogbnVtYmVyLFxuICBkZWNlbGVyYXRpb24/OiBudW1iZXIsXG4gIC4uLlxufT47XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERlY2F5QW5pbWF0aW9uIGV4dGVuZHMgQW5pbWF0aW9uIHtcbiAgX3N0YXJ0VGltZTogbnVtYmVyO1xuICBfbGFzdFZhbHVlOiBudW1iZXI7XG4gIF9mcm9tVmFsdWU6IG51bWJlcjtcbiAgX2RlY2VsZXJhdGlvbjogbnVtYmVyO1xuICBfdmVsb2NpdHk6IG51bWJlcjtcbiAgX29uVXBkYXRlOiAodmFsdWU6IG51bWJlcikgPT4gdm9pZDtcbiAgX2FuaW1hdGlvbkZyYW1lOiA/QW5pbWF0aW9uRnJhbWVJRDtcbiAgX3BsYXRmb3JtQ29uZmlnOiA/UGxhdGZvcm1Db25maWc7XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBEZWNheUFuaW1hdGlvbkNvbmZpZ1NpbmdsZSkge1xuICAgIHN1cGVyKGNvbmZpZyk7XG5cbiAgICB0aGlzLl9kZWNlbGVyYXRpb24gPSBjb25maWcuZGVjZWxlcmF0aW9uID8/IDAuOTk4O1xuICAgIHRoaXMuX3ZlbG9jaXR5ID0gY29uZmlnLnZlbG9jaXR5O1xuICAgIHRoaXMuX3BsYXRmb3JtQ29uZmlnID0gY29uZmlnLnBsYXRmb3JtQ29uZmlnO1xuICB9XG5cbiAgX19nZXROYXRpdmVBbmltYXRpb25Db25maWcoKTogJFJlYWRPbmx5PHtcbiAgICBkZWNlbGVyYXRpb246IG51bWJlcixcbiAgICBpdGVyYXRpb25zOiBudW1iZXIsXG4gICAgcGxhdGZvcm1Db25maWc6ID9QbGF0Zm9ybUNvbmZpZyxcbiAgICB0eXBlOiAnZGVjYXknLFxuICAgIHZlbG9jaXR5OiBudW1iZXIsXG4gICAgLi4uXG4gIH0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ2RlY2F5JyxcbiAgICAgIGRlY2VsZXJhdGlvbjogdGhpcy5fZGVjZWxlcmF0aW9uLFxuICAgICAgdmVsb2NpdHk6IHRoaXMuX3ZlbG9jaXR5LFxuICAgICAgaXRlcmF0aW9uczogdGhpcy5fX2l0ZXJhdGlvbnMsXG4gICAgICBwbGF0Zm9ybUNvbmZpZzogdGhpcy5fcGxhdGZvcm1Db25maWcsXG4gICAgICBkZWJ1Z0lEOiB0aGlzLl9fZ2V0RGVidWdJRCgpLFxuICAgIH07XG4gIH1cblxuICBzdGFydChcbiAgICBmcm9tVmFsdWU6IG51bWJlcixcbiAgICBvblVwZGF0ZTogKHZhbHVlOiBudW1iZXIpID0+IHZvaWQsXG4gICAgb25FbmQ6ID9FbmRDYWxsYmFjayxcbiAgICBwcmV2aW91c0FuaW1hdGlvbjogP0FuaW1hdGlvbixcbiAgICBhbmltYXRlZFZhbHVlOiBBbmltYXRlZFZhbHVlLFxuICApOiB2b2lkIHtcbiAgICBzdXBlci5zdGFydChmcm9tVmFsdWUsIG9uVXBkYXRlLCBvbkVuZCwgcHJldmlvdXNBbmltYXRpb24sIGFuaW1hdGVkVmFsdWUpO1xuXG4gICAgdGhpcy5fbGFzdFZhbHVlID0gZnJvbVZhbHVlO1xuICAgIHRoaXMuX2Zyb21WYWx1ZSA9IGZyb21WYWx1ZTtcbiAgICB0aGlzLl9vblVwZGF0ZSA9IG9uVXBkYXRlO1xuICAgIHRoaXMuX3N0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICBjb25zdCB1c2VOYXRpdmVEcml2ZXIgPSB0aGlzLl9fc3RhcnRBbmltYXRpb25JZk5hdGl2ZShhbmltYXRlZFZhbHVlKTtcbiAgICBpZiAoIXVzZU5hdGl2ZURyaXZlcikge1xuICAgICAgdGhpcy5fYW5pbWF0aW9uRnJhbWUgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gdGhpcy5vblVwZGF0ZSgpKTtcbiAgICB9XG4gIH1cblxuICBvblVwZGF0ZSgpOiB2b2lkIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuXG4gICAgY29uc3QgdmFsdWUgPVxuICAgICAgdGhpcy5fZnJvbVZhbHVlICtcbiAgICAgICh0aGlzLl92ZWxvY2l0eSAvICgxIC0gdGhpcy5fZGVjZWxlcmF0aW9uKSkgKlxuICAgICAgICAoMSAtIE1hdGguZXhwKC0oMSAtIHRoaXMuX2RlY2VsZXJhdGlvbikgKiAobm93IC0gdGhpcy5fc3RhcnRUaW1lKSkpO1xuXG4gICAgdGhpcy5fb25VcGRhdGUodmFsdWUpO1xuXG4gICAgaWYgKE1hdGguYWJzKHRoaXMuX2xhc3RWYWx1ZSAtIHZhbHVlKSA8IDAuMSkge1xuICAgICAgdGhpcy5fX25vdGlmeUFuaW1hdGlvbkVuZCh7ZmluaXNoZWQ6IHRydWV9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl9sYXN0VmFsdWUgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5fX2FjdGl2ZSkge1xuICAgICAgLy8gJEZsb3dGaXhNZVttZXRob2QtdW5iaW5kaW5nXSBhZGRlZCB3aGVuIGltcHJvdmluZyB0eXBpbmcgZm9yIHRoaXMgcGFyYW1ldGVyc1xuICAgICAgdGhpcy5fYW5pbWF0aW9uRnJhbWUgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5vblVwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCk6IHZvaWQge1xuICAgIHN1cGVyLnN0b3AoKTtcbiAgICBpZiAodGhpcy5fYW5pbWF0aW9uRnJhbWUgIT0gbnVsbCkge1xuICAgICAgZ2xvYmFsLmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuX2FuaW1hdGlvbkZyYW1lKTtcbiAgICB9XG4gICAgdGhpcy5fX25vdGlmeUFuaW1hdGlvbkVuZCh7ZmluaXNoZWQ6IGZhbHNlfSk7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQWNBLElBQUFBLFdBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUFvQyxJQXNCZkMsY0FBYyxHQUFBQyxPQUFBLENBQUFDLE9BQUEsYUFBQUMsVUFBQTtFQVVqQyxTQUFBSCxlQUFZSSxNQUFrQyxFQUFFO0lBQUEsSUFBQUMsb0JBQUE7SUFBQSxJQUFBQyxLQUFBO0lBQUEsSUFBQUMsZ0JBQUEsQ0FBQUwsT0FBQSxRQUFBRixjQUFBO0lBQzlDTSxLQUFBLE9BQUFFLFdBQUEsQ0FBQU4sT0FBQSxRQUFBRixjQUFBLEdBQU1JLE1BQU07SUFFWkUsS0FBQSxDQUFLRyxhQUFhLElBQUFKLG9CQUFBLEdBQUdELE1BQU0sQ0FBQ00sWUFBWSxZQUFBTCxvQkFBQSxHQUFJLEtBQUs7SUFDakRDLEtBQUEsQ0FBS0ssU0FBUyxHQUFHUCxNQUFNLENBQUNRLFFBQVE7SUFDaENOLEtBQUEsQ0FBS08sZUFBZSxHQUFHVCxNQUFNLENBQUNVLGNBQWM7SUFBQyxPQUFBUixLQUFBO0VBQy9DO0VBQUMsSUFBQVMsVUFBQSxDQUFBYixPQUFBLEVBQUFGLGNBQUEsRUFBQUcsVUFBQTtFQUFBLFdBQUFhLGFBQUEsQ0FBQWQsT0FBQSxFQUFBRixjQUFBO0lBQUFpQixHQUFBO0lBQUFDLEtBQUEsRUFFRCxTQUFBQywwQkFBMEJBLENBQUEsRUFPdkI7TUFDRCxPQUFPO1FBQ0xDLElBQUksRUFBRSxPQUFPO1FBQ2JWLFlBQVksRUFBRSxJQUFJLENBQUNELGFBQWE7UUFDaENHLFFBQVEsRUFBRSxJQUFJLENBQUNELFNBQVM7UUFDeEJVLFVBQVUsRUFBRSxJQUFJLENBQUNDLFlBQVk7UUFDN0JSLGNBQWMsRUFBRSxJQUFJLENBQUNELGVBQWU7UUFDcENVLE9BQU8sRUFBRSxJQUFJLENBQUNDLFlBQVksQ0FBQztNQUM3QixDQUFDO0lBQ0g7RUFBQztJQUFBUCxHQUFBO0lBQUFDLEtBQUEsRUFFRCxTQUFBTyxLQUFLQSxDQUNIQyxTQUFpQixFQUNqQkMsUUFBaUMsRUFDakNDLEtBQW1CLEVBQ25CQyxpQkFBNkIsRUFDN0JDLGFBQTRCLEVBQ3RCO01BQUEsSUFBQUMsTUFBQTtNQUNOLElBQUFDLGNBQUEsQ0FBQTlCLE9BQUEsRUFBQUYsY0FBQSxxQkFBWTBCLFNBQVMsRUFBRUMsUUFBUSxFQUFFQyxLQUFLLEVBQUVDLGlCQUFpQixFQUFFQyxhQUFhO01BRXhFLElBQUksQ0FBQ0csVUFBVSxHQUFHUCxTQUFTO01BQzNCLElBQUksQ0FBQ1EsVUFBVSxHQUFHUixTQUFTO01BQzNCLElBQUksQ0FBQ1MsU0FBUyxHQUFHUixRQUFRO01BQ3pCLElBQUksQ0FBQ1MsVUFBVSxHQUFHQyxJQUFJLENBQUNDLEdBQUcsQ0FBQyxDQUFDO01BRTVCLElBQU1DLGVBQWUsR0FBRyxJQUFJLENBQUNDLHdCQUF3QixDQUFDVixhQUFhLENBQUM7TUFDcEUsSUFBSSxDQUFDUyxlQUFlLEVBQUU7UUFDcEIsSUFBSSxDQUFDRSxlQUFlLEdBQUdDLHFCQUFxQixDQUFDO1VBQUEsT0FBTVgsTUFBSSxDQUFDSixRQUFRLENBQUMsQ0FBQztRQUFBLEVBQUM7TUFDckU7SUFDRjtFQUFDO0lBQUFWLEdBQUE7SUFBQUMsS0FBQSxFQUVELFNBQUFTLFFBQVFBLENBQUEsRUFBUztNQUNmLElBQU1XLEdBQUcsR0FBR0QsSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQztNQUV0QixJQUFNcEIsS0FBSyxHQUNULElBQUksQ0FBQ2dCLFVBQVUsR0FDZCxJQUFJLENBQUN2QixTQUFTLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQ0YsYUFBYSxDQUFDLElBQ3ZDLENBQUMsR0FBR2tDLElBQUksQ0FBQ0MsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQ25DLGFBQWEsQ0FBQyxJQUFJNkIsR0FBRyxHQUFHLElBQUksQ0FBQ0YsVUFBVSxDQUFDLENBQUMsQ0FBQztNQUV2RSxJQUFJLENBQUNELFNBQVMsQ0FBQ2pCLEtBQUssQ0FBQztNQUVyQixJQUFJeUIsSUFBSSxDQUFDRSxHQUFHLENBQUMsSUFBSSxDQUFDWixVQUFVLEdBQUdmLEtBQUssQ0FBQyxHQUFHLEdBQUcsRUFBRTtRQUMzQyxJQUFJLENBQUM0QixvQkFBb0IsQ0FBQztVQUFDQyxRQUFRLEVBQUU7UUFBSSxDQUFDLENBQUM7UUFDM0M7TUFDRjtNQUVBLElBQUksQ0FBQ2QsVUFBVSxHQUFHZixLQUFLO01BQ3ZCLElBQUksSUFBSSxDQUFDOEIsUUFBUSxFQUFFO1FBRWpCLElBQUksQ0FBQ1AsZUFBZSxHQUFHQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUNmLFFBQVEsQ0FBQ3NCLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztNQUN4RTtJQUNGO0VBQUM7SUFBQWhDLEdBQUE7SUFBQUMsS0FBQSxFQUVELFNBQUFnQyxJQUFJQSxDQUFBLEVBQVM7TUFDWCxJQUFBbEIsY0FBQSxDQUFBOUIsT0FBQSxFQUFBRixjQUFBO01BQ0EsSUFBSSxJQUFJLENBQUN5QyxlQUFlLElBQUksSUFBSSxFQUFFO1FBQ2hDVSxNQUFNLENBQUNDLG9CQUFvQixDQUFDLElBQUksQ0FBQ1gsZUFBZSxDQUFDO01BQ25EO01BQ0EsSUFBSSxDQUFDSyxvQkFBb0IsQ0FBQztRQUFDQyxRQUFRLEVBQUU7TUFBSyxDQUFDLENBQUM7SUFDOUM7RUFBQztBQUFBLEVBcEZ5Q00sbUJBQVMiLCJpZ25vcmVMaXN0IjpbXX0=