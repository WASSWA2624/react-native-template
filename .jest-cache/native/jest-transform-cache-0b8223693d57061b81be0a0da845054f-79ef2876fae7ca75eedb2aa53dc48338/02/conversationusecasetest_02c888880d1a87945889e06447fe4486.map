{"version":3,"names":["_getJestObj","mock","conversationApi","list","jest","fn","get","create","update","remove","getConversationParticipantsApi","addConversationParticipantApi","removeConversationParticipantApi","getConversationMessagesApi","addConversationMessageApi","queueRequestIfOffline","_interopRequireDefault","require","default","_asyncToGenerator2","_conversation","_conversation2","_request","_crudUsecaseRunner","_require","describe","beforeEach","mockResolvedValue","data","id","runCrudUsecaseTests","listConversations","getConversation","createConversation","updateConversation","deleteConversation","extraActions","listConversationParticipants","args","listConversationMessages","it","expect","addConversationParticipant","userId","resolves","toEqual","removeConversationParticipant","addConversationMessage","text"],"sources":["conversation.usecase.test.js"],"sourcesContent":["/**\r\n * Conversation Usecase Tests\r\n * File: conversation.usecase.test.js\r\n */\r\nimport {\r\n  addConversationMessage,\r\n  addConversationParticipant,\r\n  createConversation,\r\n  deleteConversation,\r\n  getConversation,\r\n  listConversationMessages,\r\n  listConversationParticipants,\r\n  listConversations,\r\n  removeConversationParticipant,\r\n  updateConversation,\r\n} from '@features/conversation';\r\nimport {\r\n  addConversationMessageApi,\r\n  addConversationParticipantApi,\r\n  conversationApi,\r\n  getConversationMessagesApi,\r\n  getConversationParticipantsApi,\r\n  removeConversationParticipantApi,\r\n} from '@features/conversation/conversation.api';\r\nimport { queueRequestIfOffline } from '@offline/request';\r\nimport { runCrudUsecaseTests } from '../../helpers/crud-usecase-runner';\r\n\r\njest.mock('@features/conversation/conversation.api', () => ({\r\n  conversationApi: {\r\n    list: jest.fn(),\r\n    get: jest.fn(),\r\n    create: jest.fn(),\r\n    update: jest.fn(),\r\n    remove: jest.fn(),\r\n  },\r\n  getConversationParticipantsApi: jest.fn(),\r\n  addConversationParticipantApi: jest.fn(),\r\n  removeConversationParticipantApi: jest.fn(),\r\n  getConversationMessagesApi: jest.fn(),\r\n  addConversationMessageApi: jest.fn(),\r\n}));\r\n\r\njest.mock('@offline/request', () => ({\r\n  queueRequestIfOffline: jest.fn(),\r\n}));\r\n\r\ndescribe('conversation.usecase', () => {\r\n  beforeEach(() => {\r\n    conversationApi.list.mockResolvedValue({ data: [{ id: '1' }] });\r\n    conversationApi.get.mockResolvedValue({ data: { id: '1' } });\r\n    conversationApi.create.mockResolvedValue({ data: { id: '1' } });\r\n    conversationApi.update.mockResolvedValue({ data: { id: '1' } });\r\n    conversationApi.remove.mockResolvedValue({ data: { id: '1' } });\r\n    getConversationParticipantsApi.mockResolvedValue({ data: [{ id: 'p1' }] });\r\n    getConversationMessagesApi.mockResolvedValue({ data: [{ id: 'm1' }] });\r\n    addConversationParticipantApi.mockResolvedValue({ data: { id: 'p1' } });\r\n    removeConversationParticipantApi.mockResolvedValue({ data: { id: 'p1' } });\r\n    addConversationMessageApi.mockResolvedValue({ data: { id: 'm1' } });\r\n  });\r\n\r\n  runCrudUsecaseTests(\r\n    {\r\n      list: listConversations,\r\n      get: getConversation,\r\n      create: createConversation,\r\n      update: updateConversation,\r\n      remove: deleteConversation,\r\n      extraActions: [\r\n        { fn: listConversationParticipants, args: ['1'] },\r\n        { fn: listConversationMessages, args: ['1'] },\r\n      ],\r\n    },\r\n    { queueRequestIfOffline }\r\n  );\r\n\r\n  it('adds/removes participants and messages online', async () => {\r\n    queueRequestIfOffline.mockResolvedValue(false);\r\n    await expect(addConversationParticipant('1', { userId: 'u1' })).resolves.toEqual({ id: 'p1' });\r\n    await expect(removeConversationParticipant('1', 'u1')).resolves.toEqual({ id: 'p1' });\r\n    await expect(addConversationMessage('1', { text: 'hi' })).resolves.toEqual({ id: 'm1' });\r\n  });\r\n\r\n  it('queues participant and message writes when offline', async () => {\r\n    queueRequestIfOffline.mockResolvedValue(true);\r\n    await expect(addConversationParticipant('1', { userId: 'u1' })).resolves.toEqual({\r\n      id: '1',\r\n      userId: 'u1',\r\n    });\r\n    await expect(removeConversationParticipant('1', 'u1')).resolves.toEqual({\r\n      id: '1',\r\n      userId: 'u1',\r\n    });\r\n    await expect(addConversationMessage('1', { text: 'hi' })).resolves.toEqual({\r\n      id: '1',\r\n      text: 'hi',\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}