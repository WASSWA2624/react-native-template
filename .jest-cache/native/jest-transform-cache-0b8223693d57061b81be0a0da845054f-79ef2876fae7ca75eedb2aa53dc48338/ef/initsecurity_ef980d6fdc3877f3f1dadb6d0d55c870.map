{"version":3,"names":["_security","require","_logging","cov_2chneqhtuy","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","type","locations","s","f","b","_coverageSchema","coverage","actualCoverage","initSecurity","_initSecurity","apply","arguments","_asyncToGenerator2","default","accessToken","tokenManager","getAccessToken","refreshToken","getRefreshToken","isExpired","isTokenExpired","logger","info","error","message"],"sources":["init.security.js"],"sourcesContent":["/**\r\n * Security Initialization\r\n * File: init.security.js\r\n */\r\nimport { tokenManager } from '@security';\r\nimport { logger } from '@logging';\r\n\r\nexport async function initSecurity() {\r\n  try {\r\n    // Check if tokens exist and are valid\r\n    const accessToken = await tokenManager.getAccessToken();\r\n    const refreshToken = await tokenManager.getRefreshToken();\r\n    \r\n    if (accessToken) {\r\n      const isExpired = tokenManager.isTokenExpired(accessToken);\r\n      if (isExpired && refreshToken) {\r\n        logger.info('Access token expired, refresh token available');\r\n      } else if (isExpired) {\r\n        logger.info('Tokens expired, user will need to re-authenticate');\r\n      } else {\r\n        logger.info('Valid session found on startup');\r\n      }\r\n    } else {\r\n      logger.info('No session found on startup');\r\n    }\r\n    \r\n    // Initialize encryption keys (if needed)\r\n    // Encryption keys are initialized lazily when needed\r\n    \r\n    logger.info('Security initialized successfully');\r\n  } catch (error) {\r\n    // Security failures must not crash app, but should be logged\r\n    logger.error('Security initialization failed', { error: error.message });\r\n    // Don't throw - allow app to continue, but security features may be limited\r\n  }\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]}