74767ef16224ec2dab148e9b81686021
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _react = require("react");
var _reactRedux = require("react-redux");
var _selectors = require("../store/selectors");
var _auth = require("../store/slices/auth.slice");
var normalizeRole = function normalizeRole(role) {
  if (!role) return null;
  return String(role).trim().toLowerCase();
};
var normalizeRoles = function normalizeRoles(roles) {
  if (!roles) return [];
  var list = Array.isArray(roles) ? roles : [roles];
  return list.map(normalizeRole).filter(Boolean);
};
var useAuth = function useAuth() {
  var dispatch = (0, _reactRedux.useDispatch)();
  var isAuthenticated = (0, _reactRedux.useSelector)(_selectors.selectIsAuthenticated);
  var user = (0, _reactRedux.useSelector)(_selectors.selectUser);
  var isLoading = (0, _reactRedux.useSelector)(_selectors.selectAuthLoading);
  var errorCode = (0, _reactRedux.useSelector)(_selectors.selectAuthErrorCode);
  var roles = (0, _react.useMemo)(function () {
    var userRoles = (user == null ? void 0 : user.roles) || (user == null ? void 0 : user.role) || [];
    return normalizeRoles(userRoles);
  }, [user]);
  return {
    isAuthenticated: isAuthenticated,
    user: user || null,
    roles: roles,
    role: roles[0] || null,
    isLoading: Boolean(isLoading),
    errorCode: errorCode || null,
    login: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.login(payload));
    }, [dispatch]),
    register: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.register(payload));
    }, [dispatch]),
    logout: (0, _react.useCallback)(function () {
      return dispatch(_auth.actions.logout());
    }, [dispatch]),
    refreshSession: (0, _react.useCallback)(function () {
      return dispatch(_auth.actions.refreshSession());
    }, [dispatch]),
    loadCurrentUser: (0, _react.useCallback)(function () {
      return dispatch(_auth.actions.loadCurrentUser());
    }, [dispatch]),
    verifyEmail: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.verifyEmail(payload));
    }, [dispatch]),
    verifyPhone: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.verifyPhone(payload));
    }, [dispatch]),
    resendVerification: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.resendVerification(payload));
    }, [dispatch]),
    forgotPassword: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.forgotPassword(payload));
    }, [dispatch]),
    resetPassword: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.resetPassword(payload));
    }, [dispatch]),
    changePassword: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.changePassword(payload));
    }, [dispatch]),
    clearError: (0, _react.useCallback)(function () {
      return dispatch(_auth.actions.clearAuthError());
    }, [dispatch])
  };
};
var _default = exports.default = useAuth;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3JlYWN0UmVkdXgiLCJfc2VsZWN0b3JzIiwiX2F1dGgiLCJub3JtYWxpemVSb2xlIiwicm9sZSIsIlN0cmluZyIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsIm5vcm1hbGl6ZVJvbGVzIiwicm9sZXMiLCJsaXN0IiwiQXJyYXkiLCJpc0FycmF5IiwibWFwIiwiZmlsdGVyIiwiQm9vbGVhbiIsInVzZUF1dGgiLCJkaXNwYXRjaCIsInVzZURpc3BhdGNoIiwiaXNBdXRoZW50aWNhdGVkIiwidXNlU2VsZWN0b3IiLCJzZWxlY3RJc0F1dGhlbnRpY2F0ZWQiLCJ1c2VyIiwic2VsZWN0VXNlciIsImlzTG9hZGluZyIsInNlbGVjdEF1dGhMb2FkaW5nIiwiZXJyb3JDb2RlIiwic2VsZWN0QXV0aEVycm9yQ29kZSIsInVzZU1lbW8iLCJ1c2VyUm9sZXMiLCJsb2dpbiIsInVzZUNhbGxiYWNrIiwicGF5bG9hZCIsImF1dGhBY3Rpb25zIiwicmVnaXN0ZXIiLCJsb2dvdXQiLCJyZWZyZXNoU2Vzc2lvbiIsImxvYWRDdXJyZW50VXNlciIsInZlcmlmeUVtYWlsIiwidmVyaWZ5UGhvbmUiLCJyZXNlbmRWZXJpZmljYXRpb24iLCJmb3Jnb3RQYXNzd29yZCIsInJlc2V0UGFzc3dvcmQiLCJjaGFuZ2VQYXNzd29yZCIsImNsZWFyRXJyb3IiLCJjbGVhckF1dGhFcnJvciIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlcyI6WyJ1c2VBdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiB1c2VBdXRoIEhvb2tcclxuICogUHJvdmlkZXMgbWluaW1hbCBhdXRoIHN0YXRlIGZyb20gUmVkdXggZm9yIFVJIGd1YXJkcy9uYXZpZ2F0aW9uLlxyXG4gKiBGaWxlOiB1c2VBdXRoLmpzXHJcbiAqL1xyXG5pbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlTWVtbyB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgdXNlRGlzcGF0Y2gsIHVzZVNlbGVjdG9yIH0gZnJvbSAncmVhY3QtcmVkdXgnO1xyXG5pbXBvcnQge1xyXG4gIHNlbGVjdEF1dGhFcnJvckNvZGUsXHJcbiAgc2VsZWN0QXV0aExvYWRpbmcsXHJcbiAgc2VsZWN0SXNBdXRoZW50aWNhdGVkLFxyXG4gIHNlbGVjdFVzZXIsXHJcbn0gZnJvbSAnQHN0b3JlL3NlbGVjdG9ycyc7XHJcbmltcG9ydCB7IGFjdGlvbnMgYXMgYXV0aEFjdGlvbnMgfSBmcm9tICdAc3RvcmUvc2xpY2VzL2F1dGguc2xpY2UnO1xyXG5cclxuY29uc3Qgbm9ybWFsaXplUm9sZSA9IChyb2xlKSA9PiB7XHJcbiAgaWYgKCFyb2xlKSByZXR1cm4gbnVsbDtcclxuICByZXR1cm4gU3RyaW5nKHJvbGUpLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xyXG59O1xyXG5cclxuY29uc3Qgbm9ybWFsaXplUm9sZXMgPSAocm9sZXMpID0+IHtcclxuICBpZiAoIXJvbGVzKSByZXR1cm4gW107XHJcbiAgY29uc3QgbGlzdCA9IEFycmF5LmlzQXJyYXkocm9sZXMpID8gcm9sZXMgOiBbcm9sZXNdO1xyXG4gIHJldHVybiBsaXN0Lm1hcChub3JtYWxpemVSb2xlKS5maWx0ZXIoQm9vbGVhbik7XHJcbn07XHJcblxyXG4vKipcclxuICogdXNlQXV0aCBob29rXHJcbiAqIEByZXR1cm5zIHtPYmplY3R9IGF1dGggc3RhdGUgYW5kIG5vcm1hbGl6ZWQgcm9sZXNcclxuICovXHJcbmNvbnN0IHVzZUF1dGggPSAoKSA9PiB7XHJcbiAgY29uc3QgZGlzcGF0Y2ggPSB1c2VEaXNwYXRjaCgpO1xyXG4gIGNvbnN0IGlzQXV0aGVudGljYXRlZCA9IHVzZVNlbGVjdG9yKHNlbGVjdElzQXV0aGVudGljYXRlZCk7XHJcbiAgY29uc3QgdXNlciA9IHVzZVNlbGVjdG9yKHNlbGVjdFVzZXIpO1xyXG4gIGNvbnN0IGlzTG9hZGluZyA9IHVzZVNlbGVjdG9yKHNlbGVjdEF1dGhMb2FkaW5nKTtcclxuICBjb25zdCBlcnJvckNvZGUgPSB1c2VTZWxlY3RvcihzZWxlY3RBdXRoRXJyb3JDb2RlKTtcclxuXHJcbiAgY29uc3Qgcm9sZXMgPSB1c2VNZW1vKCgpID0+IHtcclxuICAgIGNvbnN0IHVzZXJSb2xlcyA9IHVzZXI/LnJvbGVzIHx8IHVzZXI/LnJvbGUgfHwgW107XHJcbiAgICByZXR1cm4gbm9ybWFsaXplUm9sZXModXNlclJvbGVzKTtcclxuICB9LCBbdXNlcl0pO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgaXNBdXRoZW50aWNhdGVkLFxyXG4gICAgdXNlcjogdXNlciB8fCBudWxsLFxyXG4gICAgcm9sZXMsXHJcbiAgICByb2xlOiByb2xlc1swXSB8fCBudWxsLFxyXG4gICAgaXNMb2FkaW5nOiBCb29sZWFuKGlzTG9hZGluZyksXHJcbiAgICBlcnJvckNvZGU6IGVycm9yQ29kZSB8fCBudWxsLFxyXG4gICAgbG9naW46IHVzZUNhbGxiYWNrKChwYXlsb2FkKSA9PiBkaXNwYXRjaChhdXRoQWN0aW9ucy5sb2dpbihwYXlsb2FkKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgcmVnaXN0ZXI6IHVzZUNhbGxiYWNrKChwYXlsb2FkKSA9PiBkaXNwYXRjaChhdXRoQWN0aW9ucy5yZWdpc3RlcihwYXlsb2FkKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgbG9nb3V0OiB1c2VDYWxsYmFjaygoKSA9PiBkaXNwYXRjaChhdXRoQWN0aW9ucy5sb2dvdXQoKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgcmVmcmVzaFNlc3Npb246IHVzZUNhbGxiYWNrKCgpID0+IGRpc3BhdGNoKGF1dGhBY3Rpb25zLnJlZnJlc2hTZXNzaW9uKCkpLCBbZGlzcGF0Y2hdKSxcclxuICAgIGxvYWRDdXJyZW50VXNlcjogdXNlQ2FsbGJhY2soKCkgPT4gZGlzcGF0Y2goYXV0aEFjdGlvbnMubG9hZEN1cnJlbnRVc2VyKCkpLCBbZGlzcGF0Y2hdKSxcclxuICAgIHZlcmlmeUVtYWlsOiB1c2VDYWxsYmFjaygocGF5bG9hZCkgPT4gZGlzcGF0Y2goYXV0aEFjdGlvbnMudmVyaWZ5RW1haWwocGF5bG9hZCkpLCBbZGlzcGF0Y2hdKSxcclxuICAgIHZlcmlmeVBob25lOiB1c2VDYWxsYmFjaygocGF5bG9hZCkgPT4gZGlzcGF0Y2goYXV0aEFjdGlvbnMudmVyaWZ5UGhvbmUocGF5bG9hZCkpLCBbZGlzcGF0Y2hdKSxcclxuICAgIHJlc2VuZFZlcmlmaWNhdGlvbjogdXNlQ2FsbGJhY2soKHBheWxvYWQpID0+IGRpc3BhdGNoKGF1dGhBY3Rpb25zLnJlc2VuZFZlcmlmaWNhdGlvbihwYXlsb2FkKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgZm9yZ290UGFzc3dvcmQ6IHVzZUNhbGxiYWNrKChwYXlsb2FkKSA9PiBkaXNwYXRjaChhdXRoQWN0aW9ucy5mb3Jnb3RQYXNzd29yZChwYXlsb2FkKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgcmVzZXRQYXNzd29yZDogdXNlQ2FsbGJhY2soKHBheWxvYWQpID0+IGRpc3BhdGNoKGF1dGhBY3Rpb25zLnJlc2V0UGFzc3dvcmQocGF5bG9hZCkpLCBbZGlzcGF0Y2hdKSxcclxuICAgIGNoYW5nZVBhc3N3b3JkOiB1c2VDYWxsYmFjaygocGF5bG9hZCkgPT4gZGlzcGF0Y2goYXV0aEFjdGlvbnMuY2hhbmdlUGFzc3dvcmQocGF5bG9hZCkpLCBbZGlzcGF0Y2hdKSxcclxuICAgIGNsZWFyRXJyb3I6IHVzZUNhbGxiYWNrKCgpID0+IGRpc3BhdGNoKGF1dGhBY3Rpb25zLmNsZWFyQXV0aEVycm9yKCkpLCBbZGlzcGF0Y2hdKSxcclxuICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgdXNlQXV0aDtcclxuIl0sIm1hcHBpbmdzIjoiOzs7O0FBS0EsSUFBQUEsTUFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsV0FBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsVUFBQSxHQUFBRixPQUFBO0FBTUEsSUFBQUcsS0FBQSxHQUFBSCxPQUFBO0FBRUEsSUFBTUksYUFBYSxHQUFHLFNBQWhCQSxhQUFhQSxDQUFJQyxJQUFJLEVBQUs7RUFDOUIsSUFB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