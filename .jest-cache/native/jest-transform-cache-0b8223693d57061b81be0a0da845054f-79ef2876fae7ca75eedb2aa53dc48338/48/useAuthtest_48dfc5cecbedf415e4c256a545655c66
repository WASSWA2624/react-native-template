093c8d6899369741fe101f1663a1829f
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _react = _interopRequireDefault(require("react"));
var _reactRedux = require("react-redux");
var _toolkit = require("@reduxjs/toolkit");
var _reactNative = require("@testing-library/react-native");
var _rootReducer = _interopRequireDefault(require("../../store/rootReducer"));
var _useAuth = _interopRequireDefault(require("../../hooks/useAuth"));
var _jsxRuntime = require("react/jsx-runtime");
var TestComponent = function TestComponent(_ref) {
  var onResult = _ref.onResult;
  var result = (0, _useAuth.default)();
  _react.default.useEffect(function () {
    onResult(result);
  }, [onResult, result]);
  return null;
};
var createStore = function createStore() {
  var preloadedState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  return (0, _toolkit.configureStore)({
    reducer: _rootReducer.default,
    preloadedState: Object.assign({
      ui: {
        theme: 'light',
        locale: 'en',
        isLoading: false,
        isAuthenticated: false,
        user: null
      },
      network: {
        isOnline: true
      }
    }, preloadedState)
  });
};
describe('useAuth', function () {
  it('returns defaults when unauthenticated', function () {
    var store = createStore();
    var result;
    (0, _reactNative.render)((0, _jsxRuntime.jsx)(_reactRedux.Provider, {
      store: store,
      children: (0, _jsxRuntime.jsx)(TestComponent, {
        onResult: function onResult(value) {
          return result = value;
        }
      })
    }));
    expect(result.isAuthenticated).toBe(false);
    expect(result.user).toBeNull();
    expect(result.roles).toEqual([]);
    expect(result.role).toBeNull();
  });
  it('returns normalized roles when authenticated', function () {
    var store = createStore({
      ui: {
        theme: 'light',
        locale: 'en',
        isLoading: false,
        isAuthenticated: true,
        user: {
          id: '1',
          role: 'Patient',
          roles: ['Patient', 'Admin']
        }
      }
    });
    var result;
    (0, _reactNative.render)((0, _jsxRuntime.jsx)(_reactRedux.Provider, {
      store: store,
      children: (0, _jsxRuntime.jsx)(TestComponent, {
        onResult: function onResult(value) {
          return result = value;
        }
      })
    }));
    expect(result.isAuthenticated).toBe(true);
    expect(result.user).toMatchObject({
      id: '1'
    });
    expect(result.roles).toEqual(['patient', 'admin']);
    expect(result.role).toBe('patient');
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9yZWFjdFJlZHV4IiwiX3Rvb2xraXQiLCJfcmVhY3ROYXRpdmUiLCJfcm9vdFJlZHVjZXIiLCJfdXNlQXV0aCIsIl9qc3hSdW50aW1lIiwiVGVzdENvbXBvbmVudCIsIl9yZWYiLCJvblJlc3VsdCIsInJlc3VsdCIsInVzZUF1dGgiLCJSZWFjdCIsInVzZUVmZmVjdCIsImNyZWF0ZVN0b3JlIiwicHJlbG9hZGVkU3RhdGUiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJjb25maWd1cmVTdG9yZSIsInJlZHVjZXIiLCJyb290UmVkdWNlciIsIk9iamVjdCIsImFzc2lnbiIsInVpIiwidGhlbWUiLCJsb2NhbGUiLCJpc0xvYWRpbmciLCJpc0F1dGhlbnRpY2F0ZWQiLCJ1c2VyIiwibmV0d29yayIsImlzT25saW5lIiwiZGVzY3JpYmUiLCJpdCIsInN0b3JlIiwicmVuZGVyIiwianN4IiwiUHJvdmlkZXIiLCJjaGlsZHJlbiIsInZhbHVlIiwiZXhwZWN0IiwidG9CZSIsInRvQmVOdWxsIiwicm9sZXMiLCJ0b0VxdWFsIiwicm9sZSIsImlkIiwidG9NYXRjaE9iamVjdCJdLCJzb3VyY2VzIjpbInVzZUF1dGgudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogdXNlQXV0aCBIb29rIFRlc3RzXHJcbiAqIEZpbGU6IHVzZUF1dGgudGVzdC5qc1xyXG4gKi9cclxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tICdyZWFjdC1yZWR1eCc7XHJcbmltcG9ydCB7IGNvbmZpZ3VyZVN0b3JlIH0gZnJvbSAnQHJlZHV4anMvdG9vbGtpdCc7XHJcbmltcG9ydCB7IHJlbmRlciB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QtbmF0aXZlJztcclxuaW1wb3J0IHJvb3RSZWR1Y2VyIGZyb20gJ0BzdG9yZS9yb290UmVkdWNlcic7XHJcbmltcG9ydCB1c2VBdXRoIGZyb20gJ0Bob29rcy91c2VBdXRoJztcclxuXHJcbmNvbnN0IFRlc3RDb21wb25lbnQgPSAoeyBvblJlc3VsdCB9KSA9PiB7XHJcbiAgY29uc3QgcmVzdWx0ID0gdXNlQXV0aCgpO1xyXG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBvblJlc3VsdChyZXN1bHQpO1xyXG4gIH0sIFtvblJlc3VsdCwgcmVzdWx0XSk7XHJcbiAgcmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVTdG9yZSA9IChwcmVsb2FkZWRTdGF0ZSA9IHt9KSA9PlxyXG4gIGNvbmZpZ3VyZVN0b3JlKHtcclxuICAgIHJlZHVjZXI6IHJvb3RSZWR1Y2VyLFxyXG4gICAgcHJlbG9hZGVkU3RhdGU6IHtcclxuICAgICAgdWk6IHtcclxuICAgICAgICB0aGVtZTogJ2xpZ2h0JyxcclxuICAgICAgICBsb2NhbGU6ICdlbicsXHJcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcclxuICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxyXG4gICAgICAgIHVzZXI6IG51bGwsXHJcbiAgICAgIH0sXHJcbiAgICAgIG5ldHdvcms6IHtcclxuICAgICAgICBpc09ubGluZTogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgICAgLi4ucHJlbG9hZGVkU3RhdGUsXHJcbiAgICB9LFxyXG4gIH0pO1xyXG5cclxuZGVzY3JpYmUoJ3VzZUF1dGgnLCAoKSA9PiB7XHJcbiAgaXQoJ3JldHVybnMgZGVmYXVsdHMgd2hlbiB1bmF1dGhlbnRpY2F0ZWQnLCAoKSA9PiB7XHJcbiAgICBjb25zdCBzdG9yZSA9IGNyZWF0ZVN0b3JlKCk7XHJcbiAgICBsZXQgcmVzdWx0O1xyXG4gICAgcmVuZGVyKFxyXG4gICAgICA8UHJvdmlkZXIgc3RvcmU9e3N0b3JlfT5cclxuICAgICAgICA8VGVzdENvbXBvbmVudCBvblJlc3VsdD17KHZhbHVlKSA9PiAocmVzdWx0ID0gdmFsdWUpfSAvPlxyXG4gICAgICA8L1Byb3ZpZGVyPlxyXG4gICAgKTtcclxuICAgIGV4cGVjdChyZXN1bHQuaXNBdXRoZW50aWNhdGVkKS50b0JlKGZhbHNlKTtcclxuICAgIGV4cGVjdChyZXN1bHQudXNlcikudG9CZU51bGwoKTtcclxuICAgIGV4cGVjdChyZXN1bHQucm9sZXMpLnRvRXF1YWwoW10pO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5yb2xlKS50b0JlTnVsbCgpO1xyXG4gIH0pO1xyXG5cclxuICBpdCgncmV0dXJucyBub3JtYWxpemVkIHJvbGVzIHdoZW4gYXV0aGVudGljYXRlZCcsICgpID0+IHtcclxuICAgIGNvbnN0IHN0b3JlID0gY3JlYXRlU3RvcmUoe1xyXG4gICAgICB1aToge1xyXG4gICAgICAgIHRoZW1lOiAnbGlnaHQnLFxyXG4gICAgICAgIGxvY2FsZTogJ2VuJyxcclxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIGlzQXV0aGVudGljYXRlZDogdHJ1ZSxcclxuICAgICAgICB1c2VyOiB7XHJcbiAgICAgICAgICBpZDogJzEnLFxyXG4gICAgICAgICAgcm9sZTogJ1BhdGllbnQnLFxyXG4gICAgICAgICAgcm9sZXM6IFsnUGF0aWVudCcsICdBZG1pbiddLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIGxldCByZXN1bHQ7XHJcbiAgICByZW5kZXIoXHJcbiAgICAgIDxQcm92aWRlciBzdG9yZT17c3RvcmV9PlxyXG4gICAgICAgIDxUZXN0Q29tcG9uZW50IG9uUmVzdWx0PXsodmFsdWUpID0+IChyZXN1bHQgPSB2YWx1ZSl9IC8+XHJcbiAgICAgIDwvUHJvdmlkZXI+XHJcbiAgICApO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5pc0F1dGhlbnRpY2F0ZWQpLnRvQmUodHJ1ZSk7XHJcbiAgICBleHBlY3QocmVzdWx0LnVzZXIpLnRvTWF0Y2hPYmplY3QoeyBpZDogJzEnIH0pO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5yb2xlcykudG9FcXVhbChbJ3BhdGllbnQnLCAnYWRtaW4nXSk7XHJcbiAgICBleHBlY3QocmVzdWx0LnJvbGUpLnRvQmUoJ3BhdGllbnQnKTtcclxuICB9KTtcclxufSk7XHJcbiJdLCJtYXBwaW5ncyI6IjtBQUlBLElBQUFBLE1BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFdBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLFFBQUEsR0FBQUYsT0FBQTtBQUNBLElBQUFHLFlBQUEsR0FBQUgsT0FBQTtBQUNBLElBQUFJLFlBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLFFBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUFxQyxJQUFBTSxXQUFBLEdBQUFOLE9BQUE7QUFFckMsSUFBTU8sYUFBYSxHQUFHLFNBQWhCQSxhQUFhQSxDQUFBQyxJQUFBLEVBQXFCO0VBQUEsSUFBZkMsUUFBUSxHQUFBRCxJQUFBLENBQVJDLFFBQVE7RUFDL0IsSUFBTUMsTUFBTSxHQUFHLElBQUFDLGdCQUFPLEVBQUMsQ0FBQztFQUN4QkMsY0FBSyxDQUFDQyxTQUFTLENBQUMsWUFBTTtJQUNwQkosUUFBUSxDQUFDQyxNQUFNLENBQUM7RUFDbEIsQ0FBQyxFQUFFLENBQUNELFFBQVEsRUFBRUMsTUFBTSxDQUFDLENBQUM7RUFDdEIsT0FBTyxJQUFJO0FBQ2IsQ0FBQztBQUVELElBQU1JLFdBQVcsR0FBRyxTQUFkQSxXQUFXQSxDQUFBO0VBQUEsSUFBSUMsY0FBYyxHQUFBQyxTQUFBLENBQUFDLE1BQUEsUUFBQUQsU0FBQSxRQUFBRSxTQUFBLEdBQUFGLFNBQUEsTUFBRyxDQUFDLENBQUM7RUFBQSxPQUN0QyxJQUFBRyx1QkFBYyxFQUFDO0lBQ2JDLE9BQU8sRUFBRUMsb0JBQVc7SUFDcEJOLGNBQWMsRUFBQU8sTUFBQSxDQUFBQyxNQUFBO01BQ1pDLEVBQUUsRUFBRTtRQUNGQyxLQUFLLEVBQUUsT0FBTztRQUNkQyxNQUFNLEVBQUUsSUFBSTtRQUNaQyxTQUFTLEVBQUUsS0FBSztRQUNoQkMsZUFB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