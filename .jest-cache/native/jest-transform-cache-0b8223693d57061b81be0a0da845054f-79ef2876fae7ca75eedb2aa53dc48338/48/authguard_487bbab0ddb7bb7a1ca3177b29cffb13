f22646b0724b1d6aa24b61e541b598ac
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useAuthGuard = useAuthGuard;
var _react = require("react");
var _reactRedux = require("react-redux");
var _expoRouter = require("expo-router");
var _selectors = require("../../store/selectors");
function useAuthGuard() {
  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var _options$redirectPath = options.redirectPath,
    redirectPath = _options$redirectPath === void 0 ? '/home' : _options$redirectPath,
    _options$skipRedirect = options.skipRedirect,
    skipRedirect = _options$skipRedirect === void 0 ? false : _options$skipRedirect;
  var router = (0, _expoRouter.useRouter)();
  var isAuthenticated = (0, _reactRedux.useSelector)(_selectors.selectIsAuthenticated);
  var user = (0, _reactRedux.useSelector)(_selectors.selectUser);
  var hasRedirected = (0, _react.useRef)(false);
  (0, _react.useEffect)(function () {
    if (skipRedirect) {
      return;
    }
    if (isAuthenticated) {
      hasRedirected.current = false;
    } else if (!hasRedirected.current) {
      hasRedirected.current = true;
      router.replace(redirectPath);
    }
  }, [isAuthenticated, redirectPath, router, skipRedirect]);
  return {
    authenticated: isAuthenticated,
    user: user || null
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3JlYWN0UmVkdXgiLCJfZXhwb1JvdXRlciIsIl9zZWxlY3RvcnMiLCJ1c2VBdXRoR3VhcmQiLCJvcHRpb25zIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX29wdGlvbnMkcmVkaXJlY3RQYXRoIiwicmVkaXJlY3RQYXRoIiwiX29wdGlvbnMkc2tpcFJlZGlyZWN0Iiwic2tpcFJlZGlyZWN0Iiwicm91dGVyIiwidXNlUm91dGVyIiwiaXNBdXRoZW50aWNhdGVkIiwidXNlU2VsZWN0b3IiLCJzZWxlY3RJc0F1dGhlbnRpY2F0ZWQiLCJ1c2VyIiwic2VsZWN0VXNlciIsImhhc1JlZGlyZWN0ZWQiLCJ1c2VSZWYiLCJ1c2VFZmZlY3QiLCJjdXJyZW50IiwicmVwbGFjZSIsImF1dGhlbnRpY2F0ZWQiXSwic291cmNlcyI6WyJhdXRoLmd1YXJkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBBdXRoIEd1YXJkIEhvb2tcclxuICogXHJcbiAqIENoZWNrcyBhdXRoZW50aWNhdGlvbiBzdGF0ZSBhbmQgcmVkaXJlY3RzIHVuYXV0aGVudGljYXRlZCB1c2Vycy5cclxuICogXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5yZWRpcmVjdFBhdGg9Jy9ob21lJ10gLSBQYXRoIHRvIHJlZGlyZWN0IHRvIGlmIHVuYXV0aGVudGljYXRlZFxyXG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnNraXBSZWRpcmVjdD1mYWxzZV0gLSBJZiB0cnVlLCBza2lwIGF1dG9tYXRpYyByZWRpcmVjdCAodXNlZnVsIGZvciBhdXRoIGxheW91dHMgdGhhdCBuZWVkIHRvIHJlZGlyZWN0IGF1dGhlbnRpY2F0ZWQgdXNlcnMpXHJcbiAqIEByZXR1cm5zIHtPYmplY3R9IEF1dGggc3RhdGUgb2JqZWN0IHdpdGggeyBhdXRoZW50aWNhdGVkLCB1c2VyIH1cclxuICogXHJcbiAqIEBleGFtcGxlXHJcbiAqIGNvbnN0IHsgYXV0aGVudGljYXRlZCwgdXNlciB9ID0gdXNlQXV0aEd1YXJkKCk7XHJcbiAqIGNvbnN0IHsgYXV0aGVudGljYXRlZCwgdXNlciB9ID0gdXNlQXV0aEd1YXJkKHsgcmVkaXJlY3RQYXRoOiAnL2N1c3RvbS1sb2dpbicgfSk7XHJcbiAqIGNvbnN0IHsgYXV0aGVudGljYXRlZCwgdXNlciB9ID0gdXNlQXV0aEd1YXJkKHsgc2tpcFJlZGlyZWN0OiB0cnVlIH0pOyAvLyBGb3IgYXV0aCBsYXlvdXRzXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VSZWYgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IHVzZVNlbGVjdG9yIH0gZnJvbSAncmVhY3QtcmVkdXgnO1xyXG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICdleHBvLXJvdXRlcic7XHJcbmltcG9ydCB7IHNlbGVjdElzQXV0aGVudGljYXRlZCwgc2VsZWN0VXNlciB9IGZyb20gJ0BzdG9yZS9zZWxlY3RvcnMnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVzZUF1dGhHdWFyZChvcHRpb25zID0ge30pIHtcclxuICBjb25zdCB7IHJlZGlyZWN0UGF0aCA9ICcvaG9tZScsIHNraXBSZWRpcmVjdCA9IGZhbHNlIH0gPSBvcHRpb25zO1xyXG4gIFxyXG4gIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpO1xyXG4gIGNvbnN0IGlzQXV0aGVudGljYXRlZCA9IHVzZVNlbGVjdG9yKHNlbGVjdElzQXV0aGVudGljYXRlZCk7XHJcbiAgY29uc3QgdXNlciA9IHVzZVNlbGVjdG9yKHNlbGVjdFVzZXIpO1xyXG4gIFxyXG4gIC8vIFVzZSByZWYgdG8gdHJhY2sgaWYgcmVkaXJlY3QgaGFzIGJlZW4gcGVyZm9ybWVkIHRvIHByZXZlbnQgbXVsdGlwbGUgcmVkaXJlY3RzXHJcbiAgY29uc3QgaGFzUmVkaXJlY3RlZCA9IHVzZVJlZihmYWxzZSk7XHJcbiAgXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmIChza2lwUmVkaXJlY3QpIHtcclxuICAgICAgLy8gU2tpcCBhdXRvbWF0aWMgcmVkaXJlY3QgLSBsZXQgdGhlIGNhbGxpbmcgY29tcG9uZW50IGhhbmRsZSByZWRpcmVjdHNcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoaXNBdXRoZW50aWNhdGVkKSB7XHJcbiAgICAgIC8vIFJlc2V0IHJlZGlyZWN0IGZsYWcgd2hlbiBhdXRoZW50aWNhdGVkXHJcbiAgICAgIGhhc1JlZGlyZWN0ZWQuY3VycmVudCA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIGlmICghaGFzUmVkaXJlY3RlZC5jdXJyZW50KSB7XHJcbiAgICAgIC8vIE9ubHkgcmVkaXJlY3QgaWYgbm90IGF1dGhlbnRpY2F0ZWQgYW5kIGhhdmVuJ3QgcmVkaXJlY3RlZCB5ZXRcclxuICAgICAgaGFzUmVkaXJlY3RlZC5jdXJyZW50ID0gdHJ1ZTtcclxuICAgICAgcm91dGVyLnJlcGxhY2UocmVkaXJlY3RQYXRoKTtcclxuICAgIH1cclxuICB9LCBbaXNBdXRoZW50aWNhdGVkLCByZWRpcmVjdFBhdGgsIHJvdXRlciwgc2tpcFJlZGlyZWN0XSk7XHJcbiAgXHJcbiAgcmV0dXJuIHtcclxuICAgIGF1dGhlbnRpY2F0ZWQ6IGlzQXV0aGVudGljYXRlZCxcclxuICAgIHVzZXI6IHVzZXIgfHwgbnVsbCxcclxuICB9O1xyXG59XHJcblxyXG4iXSwibWFwcGluZ3MiOiI7Ozs7QUFnQkEsSUFBQUEsTUFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsV0FBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsV0FBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsVUFBQSxHQUFBSCxPQUFBO0FBRU8sU0FBU0ksWUFBWUEsQ0FBQSxFQUFlO0VBQUEsSUFBZEMsT0FBTyxHQUFBQyxTQUFBLENBQUFDLE1BQUEsUUFBQUQsU0FBQSxRQUFBRSxTQUFBLEdBQUFGLFNBQUEsTUFBRyxDQUFDLENBQUM7RUFDdkMsSUFBQUcscUJBQUEsR0FBeURKLE9BQU8sQ0FBeERLLFlBQVk7SUFBWkEsWUFBWSxHQUFBRCxxQkFBQSxjQUFHLE9BQU8sR0FBQUEscUJBQUE7SUFBQUUscUJBQUEsR0FBMkJOLE9BQU8sQ0FBaENPLFlBQVk7SUFBWkEsWUFBWSxHQUFBRCxxQkFBQSxjQUFHLEtBQUssR0FBQUEscUJBQUE7RUFFcEQsSUFBTUUsTUFBTSxHQUFHLElBQUFDLHFCQUFTLEVBQUMsQ0FBQztFQUMxQixJQUFNQyxlQUFlLEdBQUcsSUFBQUMsdUJBQVcsRUFBQ0MsZ0NBQXFCLENBQUM7RUFDMUQsSUFBTUMsSUFBSSxHQUFHLElBQUFGLHVCQUFXLEVBQUNHLHFCQUFVLENBQUM7RUFHcEMsSUFBTUMsYUFBYSxHQUFHLElBQUFDLGFBQU0sRUFBQyxLQUFLLENBQUM7RUFFbkMsSUFBQUMsZ0JBQVMsRUFBQyxZQUFNO0lBQ2QsSUFBSVYsWUFBWSxFQUFFO01BRWhCO0lBQ0Y7SUFFQSxJQUFJRyxlQUFlLEVBQUU7TUFFbkJLLGFBQWEsQ0FBQ0csT0FBTyxHQUFHLEtBQUs7SUFDL0IsQ0FBQyxNQUFNLElBQUksQ0FBQ0gsYUFBYSxDQUFDRyxPQUFPLEVBQUU7TUFFakNILGFBQWEsQ0FBQ0csT0FBTyxHQUFHLElBQUk7TUFDNUJWLE1BQU0sQ0FBQ1csT0FBTyxDQUFDZCxZQUFZLENBQUM7SUFDOUI7RUFDRixDQUFDLEVBQUUsQ0FBQ0ssZUFBZSxFQUFFTCxZQUFZLEVBQUVHLE1BQU0sRUFBRUQsWUFBWSxDQUFDLENBQUM7RUFFekQsT0FBTztJQUNMYSxhQUFhLEVBQUVWLGVBQWU7SUFDOUJHLElBQUksRUFBRUEsSUFBSSxJQUFJO0VBQ2hCLENBQUM7QUFDSCIsImlnbm9yZUxpc3QiOltdfQ==