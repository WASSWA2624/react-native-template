34316089796c84c7b67fd69e7ef7a680
import _asyncToGenerator from "@babel/runtime/helpers/asyncToGenerator";
function cov_3yryk4iw5() {
  var path = "D:\\coding\\apps\\hms\\hms-frontend\\src\\offline\\queue.js";
  var hash = "afb38e277511bf010f4f6ab1ac6a24d6ac1d2966";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "D:\\coding\\apps\\hms\\hms-frontend\\src\\offline\\queue.js",
    statementMap: {
      "0": {
        start: {
          line: 10,
          column: 18
        },
        end: {
          line: 10,
          column: 33
        }
      },
      "1": {
        start: {
          line: 12,
          column: 25
        },
        end: {
          line: 17,
          column: 1
        }
      },
      "2": {
        start: {
          line: 13,
          column: 2
        },
        end: {
          line: 16,
          column: 5
        }
      },
      "3": {
        start: {
          line: 19,
          column: 20
        },
        end: {
          line: 21,
          column: 1
        }
      },
      "4": {
        start: {
          line: 20,
          column: 2
        },
        end: {
          line: 20,
          column: 43
        }
      },
      "5": {
        start: {
          line: 23,
          column: 30
        },
        end: {
          line: 32,
          column: 1
        }
      },
      "6": {
        start: {
          line: 24,
          column: 2
        },
        end: {
          line: 31,
          column: 3
        }
      },
      "7": {
        start: {
          line: 25,
          column: 17
        },
        end: {
          line: 25,
          column: 51
        }
      },
      "8": {
        start: {
          line: 26,
          column: 22
        },
        end: {
          line: 26,
          column: 52
        }
      },
      "9": {
        start: {
          line: 27,
          column: 4
        },
        end: {
          line: 27,
          column: 60
        }
      },
      "10": {
        start: {
          line: 29,
          column: 4
        },
        end: {
          line: 29,
          column: 77
        }
      },
      "11": {
        start: {
          line: 30,
          column: 4
        },
        end: {
          line: 30,
          column: 17
        }
      },
      "12": {
        start: {
          line: 38,
          column: 24
        },
        end: {
          line: 73,
          column: 1
        }
      },
      "13": {
        start: {
          line: 39,
          column: 17
        },
        end: {
          line: 39,
          column: 54
        }
      },
      "14": {
        start: {
          line: 40,
          column: 2
        },
        end: {
          line: 40,
          column: 25
        }
      },
      "15": {
        start: {
          line: 40,
          column: 15
        },
        end: {
          line: 40,
          column: 25
        }
      },
      "16": {
        start: {
          line: 44,
          column: 2
        },
        end: {
          line: 57,
          column: 3
        }
      },
      "17": {
        start: {
          line: 45,
          column: 4
        },
        end: {
          line: 56,
          column: 5
        }
      },
      "18": {
        start: {
          line: 46,
          column: 23
        },
        end: {
          line: 46,
          column: 58
        }
      },
      "19": {
        start: {
          line: 47,
          column: 6
        },
        end: {
          line: 50,
          column: 7
        }
      },
      "20": {
        start: {
          line: 48,
          column: 8
        },
        end: {
          line: 48,
          column: 49
        }
      },
      "21": {
        start: {
          line: 49,
          column: 8
        },
        end: {
          line: 49,
          column: 18
        }
      },
      "22": {
        start: {
          line: 51,
          column: 6
        },
        end: {
          line: 51,
          column: 20
        }
      },
      "23": {
        start: {
          line: 53,
          column: 6
        },
        end: {
          line: 53,
          column: 76
        }
      },
      "24": {
        start: {
          line: 54,
          column: 6
        },
        end: {
          line: 54,
          column: 47
        }
      },
      "25": {
        start: {
          line: 55,
          column: 6
        },
        end: {
          line: 55,
          column: 16
        }
      },
      "26": {
        start: {
          line: 59,
          column: 2
        },
        end: {
          line: 62,
          column: 3
        }
      },
      "27": {
        start: {
          line: 60,
          column: 4
        },
        end: {
          line: 60,
          column: 45
        }
      },
      "28": {
        start: {
          line: 61,
          column: 4
        },
        end: {
          line: 61,
          column: 14
        }
      },
      "29": {
        start: {
          line: 64,
          column: 2
        },
        end: {
          line: 72,
          column: 3
        }
      },
      "30": {
        start: {
          line: 65,
          column: 17
        },
        end: {
          line: 65,
          column: 49
        }
      },
      "31": {
        start: {
          line: 66,
          column: 19
        },
        end: {
          line: 66,
          column: 35
        }
      },
      "32": {
        start: {
          line: 67,
          column: 4
        },
        end: {
          line: 67,
          column: 31
        }
      },
      "33": {
        start: {
          line: 69,
          column: 4
        },
        end: {
          line: 69,
          column: 68
        }
      },
      "34": {
        start: {
          line: 70,
          column: 4
        },
        end: {
          line: 70,
          column: 45
        }
      },
      "35": {
        start: {
          line: 71,
          column: 4
        },
        end: {
          line: 71,
          column: 14
        }
      },
      "36": {
        start: {
          line: 75,
          column: 26
        },
        end: {
          line: 84,
          column: 1
        }
      },
      "37": {
        start: {
          line: 76,
          column: 16
        },
        end: {
          line: 76,
          column: 32
        }
      },
      "38": {
        start: {
          line: 77,
          column: 14
        },
        end: {
          line: 77,
          column: 24
        }
      },
      "39": {
        start: {
          line: 78,
          column: 2
        },
        end: {
          line: 82,
          column: 5
        }
      },
      "40": {
        start: {
          line: 83,
          column: 2
        },
        end: {
          line: 83,
          column: 44
        }
      },
      "41": {
        start: {
          line: 86,
          column: 31
        },
        end: {
          line: 90,
          column: 1
        }
      },
      "42": {
        start: {
          line: 87,
          column: 16
        },
        end: {
          line: 87,
          column: 32
        }
      },
      "43": {
        start: {
          line: 88,
          column: 19
        },
        end: {
          line: 88,
          column: 65
        }
      },
      "44": {
        start: {
          line: 88,
          column: 42
        },
        end: {
          line: 88,
          column: 64
        }
      },
      "45": {
        start: {
          line: 89,
          column: 2
        },
        end: {
          line: 89,
          column: 47
        }
      },
      "46": {
        start: {
          line: 92,
          column: 26
        },
        end: {
          line: 95,
          column: 1
        }
      },
      "47": {
        start: {
          line: 94,
          column: 2
        },
        end: {
          line: 94,
          column: 50
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 12,
            column: 25
          },
          end: {
            line: 12,
            column: 26
          }
        },
        loc: {
          start: {
            line: 12,
            column: 45
          },
          end: {
            line: 17,
            column: 1
          }
        },
        line: 12
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 19,
            column: 20
          },
          end: {
            line: 19,
            column: 21
          }
        },
        loc: {
          start: {
            line: 19,
            column: 31
          },
          end: {
            line: 21,
            column: 1
          }
        },
        line: 19
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 23,
            column: 30
          },
          end: {
            line: 23,
            column: 31
          }
        },
        loc: {
          start: {
            line: 23,
            column: 47
          },
          end: {
            line: 32,
            column: 1
          }
        },
        line: 23
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 38,
            column: 24
          },
          end: {
            line: 38,
            column: 25
          }
        },
        loc: {
          start: {
            line: 38,
            column: 36
          },
          end: {
            line: 73,
            column: 1
          }
        },
        line: 38
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 75,
            column: 26
          },
          end: {
            line: 75,
            column: 27
          }
        },
        loc: {
          start: {
            line: 75,
            column: 45
          },
          end: {
            line: 84,
            column: 1
          }
        },
        line: 75
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 86,
            column: 31
          },
          end: {
            line: 86,
            column: 32
          }
        },
        loc: {
          start: {
            line: 86,
            column: 52
          },
          end: {
            line: 90,
            column: 1
          }
        },
        line: 86
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 88,
            column: 32
          },
          end: {
            line: 88,
            column: 33
          }
        },
        loc: {
          start: {
            line: 88,
            column: 42
          },
          end: {
            line: 88,
            column: 64
          }
        },
        line: 88
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 92,
            column: 26
          },
          end: {
            line: 92,
            column: 27
          }
        },
        loc: {
          start: {
            line: 92,
            column: 38
          },
          end: {
            line: 95,
            column: 1
          }
        },
        line: 92
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 20,
            column: 9
          },
          end: {
            line: 20,
            column: 42
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 20,
            column: 32
          },
          end: {
            line: 20,
            column: 37
          }
        }, {
          start: {
            line: 20,
            column: 40
          },
          end: {
            line: 20,
            column: 42
          }
        }],
        line: 20
      },
      "1": {
        loc: {
          start: {
            line: 40,
            column: 2
          },
          end: {
            line: 40,
            column: 25
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 40,
            column: 2
          },
          end: {
            line: 40,
            column: 25
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 40
      },
      "2": {
        loc: {
          start: {
            line: 44,
            column: 2
          },
          end: {
            line: 57,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 44,
            column: 2
          },
          end: {
            line: 57,
            column: 3
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 44
      },
      "3": {
        loc: {
          start: {
            line: 47,
            column: 6
          },
          end: {
            line: 50,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 47,
            column: 6
          },
          end: {
            line: 50,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 47
      },
      "4": {
        loc: {
          start: {
            line: 59,
            column: 2
          },
          end: {
            line: 62,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 59,
            column: 2
          },
          end: {
            line: 62,
            column: 3
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 59
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "afb38e277511bf010f4f6ab1ac6a24d6ac1d2966"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    cov_3yryk4iw5 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_3yryk4iw5();
import { handleError } from "../errors";
import { encryption } from "../security";
import { async as asyncStorage } from "../services/storage";
var QUEUE_KEY = (cov_3yryk4iw5().s[0]++, 'offline_queue');
cov_3yryk4iw5().s[1]++;
var reportQueueError = function reportQueueError(error, context) {
  cov_3yryk4iw5().f[0]++;
  cov_3yryk4iw5().s[2]++;
  handleError(error, Object.assign({
    scope: 'offline.queue'
  }, context));
};
cov_3yryk4iw5().s[3]++;
var asSafeArray = function asSafeArray(value) {
  cov_3yryk4iw5().f[1]++;
  cov_3yryk4iw5().s[4]++;
  return Array.isArray(value) ? (cov_3yryk4iw5().b[0][0]++, value) : (cov_3yryk4iw5().b[0][1]++, []);
};
cov_3yryk4iw5().s[5]++;
var persistEncryptedQueue = function () {
  var _ref = _asyncToGenerator(function* (queue) {
    cov_3yryk4iw5().f[2]++;
    cov_3yryk4iw5().s[6]++;
    try {
      var json = (cov_3yryk4iw5().s[7]++, JSON.stringify(asSafeArray(queue)));
      var encrypted = (cov_3yryk4iw5().s[8]++, yield encryption.encrypt(json));
      cov_3yryk4iw5().s[9]++;
      return yield asyncStorage.setItem(QUEUE_KEY, encrypted);
    } catch (error) {
      cov_3yryk4iw5().s[10]++;
      reportQueueError(error, {
        op: 'persistEncryptedQueue',
        key: QUEUE_KEY
      });
      cov_3yryk4iw5().s[11]++;
      return false;
    }
  });
  return function persistEncryptedQueue(_x) {
    return _ref.apply(this, arguments);
  };
}();
cov_3yryk4iw5().s[12]++;
export var getQueue = function () {
  var _ref2 = _asyncToGenerator(function* () {
    cov_3yryk4iw5().f[3]++;
    var stored = (cov_3yryk4iw5().s[13]++, yield asyncStorage.getItem(QUEUE_KEY));
    cov_3yryk4iw5().s[14]++;
    if (!stored) {
      cov_3yryk4iw5().b[1][0]++;
      cov_3yryk4iw5().s[15]++;
      return [];
    } else {
      cov_3yryk4iw5().b[1][1]++;
    }
    cov_3yryk4iw5().s[16]++;
    if (Array.isArray(stored)) {
      cov_3yryk4iw5().b[2][0]++;
      cov_3yryk4iw5().s[17]++;
      try {
        var migrated = (cov_3yryk4iw5().s[18]++, yield persistEncryptedQueue(stored));
        cov_3yryk4iw5().s[19]++;
        if (!migrated) {
          cov_3yryk4iw5().b[3][0]++;
          cov_3yryk4iw5().s[20]++;
          yield asyncStorage.removeItem(QUEUE_KEY);
          cov_3yryk4iw5().s[21]++;
          return [];
        } else {
          cov_3yryk4iw5().b[3][1]++;
        }
        cov_3yryk4iw5().s[22]++;
        return stored;
      } catch (error) {
        cov_3yryk4iw5().s[23]++;
        reportQueueError(error, {
          op: 'migrateLegacyQueue',
          key: QUEUE_KEY
        });
        cov_3yryk4iw5().s[24]++;
        yield asyncStorage.removeItem(QUEUE_KEY);
        cov_3yryk4iw5().s[25]++;
        return [];
      }
    } else {
      cov_3yryk4iw5().b[2][1]++;
    }
    cov_3yryk4iw5().s[26]++;
    if (typeof stored !== 'string') {
      cov_3yryk4iw5().b[4][0]++;
      cov_3yryk4iw5().s[27]++;
      yield asyncStorage.removeItem(QUEUE_KEY);
      cov_3yryk4iw5().s[28]++;
      return [];
    } else {
      cov_3yryk4iw5().b[4][1]++;
    }
    cov_3yryk4iw5().s[29]++;
    try {
      var json = (cov_3yryk4iw5().s[30]++, yield encryption.decrypt(stored));
      var parsed = (cov_3yryk4iw5().s[31]++, JSON.parse(json));
      cov_3yryk4iw5().s[32]++;
      return asSafeArray(parsed);
    } catch (error) {
      cov_3yryk4iw5().s[33]++;
      reportQueueError(error, {
        op: 'decryptQueue',
        key: QUEUE_KEY
      });
      cov_3yryk4iw5().s[34]++;
      yield asyncStorage.removeItem(QUEUE_KEY);
      cov_3yryk4iw5().s[35]++;
      return [];
    }
  });
  return function getQueue() {
    return _ref2.apply(this, arguments);
  };
}();
cov_3yryk4iw5().s[36]++;
export var addToQueue = function () {
  var _ref3 = _asyncToGenerator(function* (request) {
    cov_3yryk4iw5().f[4]++;
    var queue = (cov_3yryk4iw5().s[37]++, yield getQueue());
    var now = (cov_3yryk4iw5().s[38]++, Date.now());
    cov_3yryk4iw5().s[39]++;
    queue.push(Object.assign({}, request, {
      id: String(now),
      timestamp: now
    }));
    cov_3yryk4iw5().s[40]++;
    return yield persistEncryptedQueue(queue);
  });
  return function addToQueue(_x2) {
    return _ref3.apply(this, arguments);
  };
}();
cov_3yryk4iw5().s[41]++;
export var removeFromQueue = function () {
  var _ref4 = _asyncToGenerator(function* (requestId) {
    cov_3yryk4iw5().f[5]++;
    var queue = (cov_3yryk4iw5().s[42]++, yield getQueue());
    var filtered = (cov_3yryk4iw5().s[43]++, queue.filter(function (item) {
      cov_3yryk4iw5().f[6]++;
      cov_3yryk4iw5().s[44]++;
      return (item == null ? void 0 : item.id) !== requestId;
    }));
    cov_3yryk4iw5().s[45]++;
    return yield persistEncryptedQueue(filtered);
  });
  return function removeFromQueue(_x3) {
    return _ref4.apply(this, arguments);
  };
}();
cov_3yryk4iw5().s[46]++;
export var clearQueue = function () {
  var _ref5 = _asyncToGenerator(function* () {
    cov_3yryk4iw5().f[7]++;
    cov_3yryk4iw5().s[47]++;
    return yield asyncStorage.removeItem(QUEUE_KEY);
  });
  return function clearQueue() {
    return _ref5.apply(this, arguments);
  };
}();
export default {
  getQueue: getQueue,
  addToQueue: addToQueue,
  removeFromQueue: removeFromQueue,
  clearQueue: clearQueue
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJoYW5kbGVFcnJvciIsImVuY3J5cHRpb24iLCJhc3luYyIsImFzeW5jU3RvcmFnZSIsIlFVRVVFX0tFWSIsImNvdl8zeXJ5azRpdzUiLCJzIiwicmVwb3J0UXVldWVFcnJvciIsImVycm9yIiwiY29udGV4dCIsImYiLCJPYmplY3QiLCJhc3NpZ24iLCJzY29wZSIsImFzU2FmZUFycmF5IiwidmFsdWUiLCJBcnJheSIsImlzQXJyYXkiLCJiIiwicGVyc2lzdEVuY3J5cHRlZFF1ZXVlIiwiX3JlZiIsIl9hc3luY1RvR2VuZXJhdG9yIiwicXVldWUiLCJqc29uIiwiSlNPTiIsInN0cmluZ2lmeSIsImVuY3J5cHRlZCIsImVuY3J5cHQiLCJzZXRJdGVtIiwib3AiLCJrZXkiLCJfeCIsImFwcGx5IiwiYXJndW1lbnRzIiwiZ2V0UXVldWUiLCJfcmVmMiIsInN0b3JlZCIsImdldEl0ZW0iLCJtaWdyYXRlZCIsInJlbW92ZUl0ZW0iLCJkZWNyeXB0IiwicGFyc2VkIiwicGFyc2UiLCJhZGRUb1F1ZXVlIiwiX3JlZjMiLCJyZXF1ZXN0Iiwibm93IiwiRGF0ZSIsInB1c2giLCJpZCIsIlN0cmluZyIsInRpbWVzdGFtcCIsIl94MiIsInJlbW92ZUZyb21RdWV1ZSIsIl9yZWY0IiwicmVxdWVzdElkIiwiZmlsdGVyZWQiLCJmaWx0ZXIiLCJpdGVtIiwiX3gzIiwiY2xlYXJRdWV1ZSIsIl9yZWY1Il0sInNvdXJjZXMiOlsicXVldWUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIE9mZmxpbmUgUXVldWVcclxuICogU3RvcmVzIGZhaWxlZC9kZWZlcnJlZCByZXF1ZXN0c1xyXG4gKiBGaWxlOiBxdWV1ZS5qc1xyXG4gKi9cclxuaW1wb3J0IHsgaGFuZGxlRXJyb3IgfSBmcm9tICdAZXJyb3JzJztcclxuaW1wb3J0IHsgZW5jcnlwdGlvbiB9IGZyb20gJ0BzZWN1cml0eSc7XHJcbmltcG9ydCB7IGFzeW5jIGFzIGFzeW5jU3RvcmFnZSB9IGZyb20gJ0BzZXJ2aWNlcy9zdG9yYWdlJztcclxuXHJcbmNvbnN0IFFVRVVFX0tFWSA9ICdvZmZsaW5lX3F1ZXVlJztcclxuXHJcbmNvbnN0IHJlcG9ydFF1ZXVlRXJyb3IgPSAoZXJyb3IsIGNvbnRleHQpID0+IHtcclxuICBoYW5kbGVFcnJvcihlcnJvciwge1xyXG4gICAgc2NvcGU6ICdvZmZsaW5lLnF1ZXVlJyxcclxuICAgIC4uLmNvbnRleHQsXHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBhc1NhZmVBcnJheSA9ICh2YWx1ZSkgPT4ge1xyXG4gIHJldHVybiBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW107XHJcbn07XHJcblxyXG5jb25zdCBwZXJzaXN0RW5jcnlwdGVkUXVldWUgPSBhc3luYyAocXVldWUpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QganNvbiA9IEpTT04uc3RyaW5naWZ5KGFzU2FmZUFycmF5KHF1ZXVlKSk7XHJcbiAgICBjb25zdCBlbmNyeXB0ZWQgPSBhd2FpdCBlbmNyeXB0aW9uLmVuY3J5cHQoanNvbik7XHJcbiAgICByZXR1cm4gYXdhaXQgYXN5bmNTdG9yYWdlLnNldEl0ZW0oUVVFVUVfS0VZLCBlbmNyeXB0ZWQpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXBvcnRRdWV1ZUVycm9yKGVycm9yLCB7IG9wOiAncGVyc2lzdEVuY3J5cHRlZFF1ZXVlJywga2V5OiBRVUVVRV9LRVkgfSk7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFJlYWQgcXVldWUgZnJvbSBzdG9yYWdlLCBkZWNyeXB0aW5nIGlmIGF2YWlsYWJsZS5cclxuICogU2VjdXJpdHktZmlyc3Q6IHF1ZXVlIGlzIG5ldmVyIHBlcnNpc3RlZCB1bmVuY3J5cHRlZC5cclxuICovXHJcbmV4cG9ydCBjb25zdCBnZXRRdWV1ZSA9IGFzeW5jICgpID0+IHtcclxuICBjb25zdCBzdG9yZWQgPSBhd2FpdCBhc3luY1N0b3JhZ2UuZ2V0SXRlbShRVUVVRV9LRVkpO1xyXG4gIGlmICghc3RvcmVkKSByZXR1cm4gW107XHJcblxyXG4gIC8vIExlZ2FjeSAobm9uLWNvbXBsaWFudCkgZm9ybWF0OiBhcnJheSBzdG9yZWQgdW5lbmNyeXB0ZWQuXHJcbiAgLy8gV2UgbmV2ZXIga2VlcCB0aGlzIGFyb3VuZCDigJQgbWlncmF0ZSB0byBlbmNyeXB0ZWQgaWYgcG9zc2libGU7IG90aGVyd2lzZSBjbGVhciBpdC5cclxuICBpZiAoQXJyYXkuaXNBcnJheShzdG9yZWQpKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBtaWdyYXRlZCA9IGF3YWl0IHBlcnNpc3RFbmNyeXB0ZWRRdWV1ZShzdG9yZWQpO1xyXG4gICAgICBpZiAoIW1pZ3JhdGVkKSB7XHJcbiAgICAgICAgYXdhaXQgYXN5bmNTdG9yYWdlLnJlbW92ZUl0ZW0oUVVFVUVfS0VZKTtcclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHN0b3JlZDtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJlcG9ydFF1ZXVlRXJyb3IoZXJyb3IsIHsgb3A6ICdtaWdyYXRlTGVnYWN5UXVldWUnLCBrZXk6IFFVRVVFX0tFWSB9KTtcclxuICAgICAgYXdhaXQgYXN5bmNTdG9yYWdlLnJlbW92ZUl0ZW0oUVVFVUVfS0VZKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaWYgKHR5cGVvZiBzdG9yZWQgIT09ICdzdHJpbmcnKSB7XHJcbiAgICBhd2FpdCBhc3luY1N0b3JhZ2UucmVtb3ZlSXRlbShRVUVVRV9LRVkpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGpzb24gPSBhd2FpdCBlbmNyeXB0aW9uLmRlY3J5cHQoc3RvcmVkKTtcclxuICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UoanNvbik7XHJcbiAgICByZXR1cm4gYXNTYWZlQXJyYXkocGFyc2VkKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmVwb3J0UXVldWVFcnJvcihlcnJvciwgeyBvcDogJ2RlY3J5cHRRdWV1ZScsIGtleTogUVVFVUVfS0VZIH0pO1xyXG4gICAgYXdhaXQgYXN5bmNTdG9yYWdlLnJlbW92ZUl0ZW0oUVVFVUVfS0VZKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgYWRkVG9RdWV1ZSA9IGFzeW5jIChyZXF1ZXN0KSA9PiB7XHJcbiAgY29uc3QgcXVldWUgPSBhd2FpdCBnZXRRdWV1ZSgpO1xyXG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgcXVldWUucHVzaCh7XHJcbiAgICAuLi5yZXF1ZXN0LFxyXG4gICAgaWQ6IFN0cmluZyhub3cpLFxyXG4gICAgdGltZXN0YW1wOiBub3csXHJcbiAgfSk7XHJcbiAgcmV0dXJuIGF3YWl0IHBlcnNpc3RFbmNyeXB0ZWRRdWV1ZShxdWV1ZSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgcmVtb3ZlRnJvbVF1ZXVlID0gYXN5bmMgKHJlcXVlc3RJZCkgPT4ge1xyXG4gIGNvbnN0IHF1ZXVlID0gYXdhaXQgZ2V0UXVldWUoKTtcclxuICBjb25zdCBmaWx0ZXJlZCA9IHF1ZXVlLmZpbHRlcigoaXRlbSkgPT4gaXRlbT8uaWQgIT09IHJlcXVlc3RJZCk7XHJcbiAgcmV0dXJuIGF3YWl0IHBlcnNpc3RFbmNyeXB0ZWRRdWV1ZShmaWx0ZXJlZCk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgY2xlYXJRdWV1ZSA9IGFzeW5jICgpID0+IHtcclxuICAvLyBSZW1vdmluZyB0aGUga2V5IGlzIHNhZmUgYW5kIGF2b2lkcyBwZXJzaXN0aW5nIGV2ZW4gYW4gZW1wdHkgcXVldWUgd2hlbiBjcnlwdG8gaXMgdW5hdmFpbGFibGUuXHJcbiAgcmV0dXJuIGF3YWl0IGFzeW5jU3RvcmFnZS5yZW1vdmVJdGVtKFFVRVVFX0tFWSk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCB7XHJcbiAgZ2V0UXVldWUsXHJcbiAgYWRkVG9RdWV1ZSxcclxuICByZW1vdmVGcm9tUXVldWUsXHJcbiAgY2xlYXJRdWV1ZSxcclxufTtcclxuXHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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