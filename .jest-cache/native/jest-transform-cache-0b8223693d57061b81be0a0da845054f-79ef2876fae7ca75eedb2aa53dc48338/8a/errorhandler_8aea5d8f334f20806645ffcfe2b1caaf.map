{"version":3,"names":["en","logger","cov_11u53ja5ic","s","getNestedValue","obj","path","f","String","split","reduce","current","key","b","undefined","getSafeMessageForCode","code","normalizeError","error","_error$message","safeMessage","message","severity","name","includes","status","statusCode","rawMessage","trim","handleError","context","arguments","length","normalized"],"sources":["error.handler.js"],"sourcesContent":["/**\r\n * Error Handler\r\n * Normalizes errors to domain-safe objects\r\n * File: error.handler.js\r\n */\r\nimport en from '@i18n/locales/en.json';\r\nimport { logger } from '@logging';\r\n\r\nconst getNestedValue = (obj, path) => {\r\n  return String(path)\r\n    .split('.')\r\n    .reduce((current, key) => (current && current[key] !== undefined ? current[key] : undefined), obj);\r\n};\r\n\r\nconst getSafeMessageForCode = (code) => {\r\n  return (\r\n    getNestedValue(en, `errors.codes.${code}`) ||\r\n    getNestedValue(en, 'errors.codes.UNKNOWN_ERROR') ||\r\n    'UNKNOWN_ERROR'\r\n  );\r\n};\r\n\r\nconst normalizeError = (error) => {\r\n  if (!error) {\r\n    const safeMessage = getSafeMessageForCode('UNKNOWN_ERROR');\r\n    return {\r\n      code: 'UNKNOWN_ERROR',\r\n      message: safeMessage,\r\n      safeMessage,\r\n      severity: 'error',\r\n    };\r\n  }\r\n\r\n  // Network errors\r\n  if (error.name === 'NetworkError' || error.message?.includes('network')) {\r\n    const safeMessage = getSafeMessageForCode('NETWORK_ERROR');\r\n    return {\r\n      code: 'NETWORK_ERROR',\r\n      message: safeMessage,\r\n      safeMessage,\r\n      severity: 'warning',\r\n    };\r\n  }\r\n\r\n  // API errors\r\n  if (error.status || error.statusCode) {\r\n    const status = error.status || error.statusCode;\r\n    if (status === 401) {\r\n      const safeMessage = getSafeMessageForCode('UNAUTHORIZED');\r\n      return {\r\n        code: 'UNAUTHORIZED',\r\n        message: safeMessage,\r\n        safeMessage,\r\n        severity: 'error',\r\n      };\r\n    }\r\n    if (status === 403) {\r\n      const safeMessage = getSafeMessageForCode('FORBIDDEN');\r\n      return {\r\n        code: 'FORBIDDEN',\r\n        message: safeMessage,\r\n        safeMessage,\r\n        severity: 'error',\r\n      };\r\n    }\r\n    if (status >= 500) {\r\n      const safeMessage = getSafeMessageForCode('SERVER_ERROR');\r\n      return {\r\n        code: 'SERVER_ERROR',\r\n        message: safeMessage,\r\n        safeMessage,\r\n        severity: 'error',\r\n      };\r\n    }\r\n  }\r\n\r\n  const code = error.code || 'UNKNOWN_ERROR';\r\n  const safeMessage = getSafeMessageForCode(code);\r\n  const rawMessage =\r\n    typeof error.message === 'string' && error.message.trim()\r\n      ? error.message.trim()\r\n      : safeMessage;\r\n\r\n  // Default\r\n  return {\r\n    code,\r\n    message: rawMessage,\r\n    safeMessage,\r\n    severity: error.severity || 'error',\r\n  };\r\n};\r\n\r\nconst handleError = (error, context = {}) => {\r\n  const normalized = normalizeError(error);\r\n  logger.error('Handled error', {\r\n    code: normalized.code,\r\n    severity: normalized.severity,\r\n    context: context && typeof context === 'object' ? context : {},\r\n  });\r\n  return normalized;\r\n};\r\n\r\nexport { normalizeError, handleError };\r\n\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA,OAAOA,EAAE;AACT,SAASC,MAAM;AAAmBC,cAAA,GAAAC,CAA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","ignoreList":[]}