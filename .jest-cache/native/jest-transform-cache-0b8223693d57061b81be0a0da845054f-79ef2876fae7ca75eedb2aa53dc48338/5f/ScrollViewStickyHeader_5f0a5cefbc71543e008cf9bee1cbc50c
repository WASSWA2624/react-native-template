8413a68d46e33c5f59a8365227bb435d
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));
var _Animated = _interopRequireDefault(require("../../Animated/Animated"));
var _ReactFabricPublicInstanceUtils = require("../../ReactNative/ReactFabricPublicInstance/ReactFabricPublicInstanceUtils");
var _StyleSheet = _interopRequireDefault(require("../../StyleSheet/StyleSheet"));
var _Platform = _interopRequireDefault(require("../../Utilities/Platform"));
var _useMergeRefs = _interopRequireDefault(require("../../Utilities/useMergeRefs"));
var _react = _interopRequireWildcard(require("react"));
var React = _react;
var _jsxRuntime = require("react/jsx-runtime");
var _excluded = ["ref"];
var ScrollViewStickyHeader = function ScrollViewStickyHeader(_ref) {
  var forwardedRef = _ref.ref,
    props = (0, _objectWithoutProperties2.default)(_ref, _excluded);
  var inverted = props.inverted,
    scrollViewHeight = props.scrollViewHeight,
    hiddenOnScroll = props.hiddenOnScroll,
    scrollAnimatedValue = props.scrollAnimatedValue,
    _nextHeaderLayoutY = props.nextHeaderLayoutY;
  var _useState = (0, _react.useState)(false),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    measured = _useState2[0],
    setMeasured = _useState2[1];
  var _useState3 = (0, _react.useState)(0),
    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
    layoutY = _useState4[0],
    setLayoutY = _useState4[1];
  var _useState5 = (0, _react.useState)(0),
    _useState6 = (0, _slicedToArray2.default)(_useState5, 2),
    layoutHeight = _useState6[0],
    setLayoutHeight = _useState6[1];
  var _useState7 = (0, _react.useState)(null),
    _useState8 = (0, _slicedToArray2.default)(_useState7, 2),
    translateY = _useState8[0],
    setTranslateY = _useState8[1];
  var _useState9 = (0, _react.useState)(_nextHeaderLayoutY),
    _useState0 = (0, _slicedToArray2.default)(_useState9, 2),
    nextHeaderLayoutY = _useState0[0],
    setNextHeaderLayoutY = _useState0[1];
  var _useState1 = (0, _react.useState)(false),
    _useState10 = (0, _slicedToArray2.default)(_useState1, 2),
    isFabric = _useState10[0],
    setIsFabric = _useState10[1];
  var callbackRef = (0, _react.useCallback)(function (ref) {
    if (ref == null) {
      return;
    }
    ref.setNextHeaderY = setNextHeaderLayoutY;
    setIsFabric((0, _ReactFabricPublicInstanceUtils.isPublicInstance)(ref));
  }, []);
  var ref = (0, _useMergeRefs.default)(callbackRef, forwardedRef);
  var offset = (0, _react.useMemo)(function () {
    return hiddenOnScroll === true ? _Animated.default.diffClamp(scrollAnimatedValue.interpolate({
      extrapolateLeft: 'clamp',
      inputRange: [layoutY, layoutY + 1],
      outputRange: [0, 1]
    }).interpolate({
      inputRange: [0, 1],
      outputRange: [0, -1]
    }), -layoutHeight, 0) : null;
  }, [scrollAnimatedValue, layoutHeight, layoutY, hiddenOnScroll]);
  var _useState11 = (0, _react.useState)(function () {
      var inputRange = [-1, 0];
      var outputRange = [0, 0];
      var initialTranslateY = scrollAnimatedValue.interpolate({
        inputRange: inputRange,
        outputRange: outputRange
      });
      if (offset != null) {
        return _Animated.default.add(initialTranslateY, offset);
      }
      return initialTranslateY;
    }),
    _useState12 = (0, _slicedToArray2.default)(_useState11, 2),
    animatedTranslateY = _useState12[0],
    setAnimatedTranslateY = _useState12[1];
  var haveReceivedInitialZeroTranslateY = (0, _react.useRef)(true);
  var translateYDebounceTimer = (0, _react.useRef)(null);
  (0, _react.useEffect)(function () {
    if (translateY !== 0 && translateY != null) {
      haveReceivedInitialZeroTranslateY.current = false;
    }
  }, [translateY]);
  var animatedValueListener = (0, _react.useCallback)(function (_ref2) {
    var value = _ref2.value;
    var debounceTimeout = _Platform.default.OS === 'android' ? 15 : 64;
    if (value === 0 && !haveReceivedInitialZeroTranslateY.current) {
      haveReceivedInitialZeroTranslateY.current = true;
      return;
    }
    if (translateYDebounceTimer.current != null) {
      clearTimeout(translateYDebounceTimer.current);
    }
    translateYDebounceTimer.current = setTimeout(function () {
      return setTranslateY(value);
    }, debounceTimeout);
  }, []);
  (0, _react.useEffect)(function () {
    var inputRange = [-1, 0];
    var outputRange = [0, 0];
    if (measured) {
      if (inverted === true) {
        if (scrollViewHeight != null) {
          var stickStartPoint = layoutY + layoutHeight - scrollViewHeight;
          if (stickStartPoint > 0) {
            inputRange.push(stickStartPoint);
            outputRange.push(0);
            inputRange.push(stickStartPoint + 1);
            outputRange.push(1);
            var collisionPoint = (nextHeaderLayoutY || 0) - layoutHeight - scrollViewHeight;
            if (collisionPoint > stickStartPoint) {
              inputRange.push(collisionPoint, collisionPoint + 1);
              outputRange.push(collisionPoint - stickStartPoint, collisionPoint - stickStartPoint);
            }
          }
        }
      } else {
        inputRange.push(layoutY);
        outputRange.push(0);
        var _collisionPoint = (nextHeaderLayoutY || 0) - layoutHeight;
        if (_collisionPoint >= layoutY) {
          inputRange.push(_collisionPoint, _collisionPoint + 1);
          outputRange.push(_collisionPoint - layoutY, _collisionPoint - layoutY);
        } else {
          inputRange.push(layoutY + 1);
          outputRange.push(1);
        }
      }
    }
    var newAnimatedTranslateY = scrollAnimatedValue.interpolate({
      inputRange: inputRange,
      outputRange: outputRange
    });
    if (offset != null) {
      newAnimatedTranslateY = _Animated.default.add(newAnimatedTranslateY, offset);
    }
    var animatedListenerId;
    if (isFabric) {
      animatedListenerId = newAnimatedTranslateY.addListener(animatedValueListener);
    }
    setAnimatedTranslateY(newAnimatedTranslateY);
    return function () {
      if (animatedListenerId) {
        newAnimatedTranslateY.removeListener(animatedListenerId);
      }
      if (translateYDebounceTimer.current != null) {
        clearTimeout(translateYDebounceTimer.current);
      }
    };
  }, [nextHeaderLayoutY, measured, layoutHeight, layoutY, scrollViewHeight, scrollAnimatedValue, inverted, offset, animatedValueListener, isFabric]);
  var _onLayout = function _onLayout(event) {
    setLayoutY(event.nativeEvent.layout.y);
    setLayoutHeight(event.nativeEvent.layout.height);
    setMeasured(true);
    props.onLayout(event);
    var child = React.Children.only(props.children);
    if (child.props.onLayout) {
      child.props.onLayout(event);
    }
  };
  var child = React.Children.only(props.children);
  var passthroughAnimatedPropExplicitValues = isFabric && translateY != null ? {
    style: {
      transform: [{
        translateY: translateY
      }]
    }
  } : null;
  return (0, _jsxRuntime.jsx)(_Animated.default.View, {
    collapsable: false,
    nativeID: props.nativeID,
    onLayout: _onLayout,
    ref: ref,
    style: [child.props.style, styles.header, {
      transform: [{
        translateY: animatedTranslateY
      }]
    }],
    passthroughAnimatedPropExplicitValues: passthroughAnimatedPropExplicitValues,
    children: (0, _react.cloneElement)(child, {
      style: styles.fill,
      onLayout: undefined
    })
  });
};
var styles = _StyleSheet.default.create({
  header: {
    zIndex: 10
  },
  fill: {
    flex: 1
  }
});
var _default = exports.default = ScrollViewStickyHeader;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQW5pbWF0ZWQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9SZWFjdEZhYnJpY1B1YmxpY0luc3RhbmNlVXRpbHMiLCJfU3R5bGVTaGVldCIsIl9QbGF0Zm9ybSIsIl91c2VNZXJnZVJlZnMiLCJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIlJlYWN0IiwiX2pzeFJ1bnRpbWUiLCJfZXhjbHVkZWQiLCJTY3JvbGxWaWV3U3RpY2t5SGVhZGVyIiwiX3JlZiIsImZvcndhcmRlZFJlZiIsInJlZiIsInByb3BzIiwiX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzMiIsImRlZmF1bHQiLCJpbnZlcnRlZCIsInNjcm9sbFZpZXdIZWlnaHQiLCJoaWRkZW5PblNjcm9sbCIsInNjcm9sbEFuaW1hdGVkVmFsdWUiLCJfbmV4dEhlYWRlckxheW91dFkiLCJuZXh0SGVhZGVyTGF5b3V0WSIsIl91c2VTdGF0ZSIsInVzZVN0YXRlIiwiX3VzZVN0YXRlMiIsIl9zbGljZWRUb0FycmF5MiIsIm1lYXN1cmVkIiwic2V0TWVhc3VyZWQiLCJfdXNlU3RhdGUzIiwiX3VzZVN0YXRlNCIsImxheW91dFkiLCJzZXRMYXlvdXRZIiwiX3VzZVN0YXRlNSIsIl91c2VTdGF0ZTYiLCJsYXlvdXRIZWlnaHQiLCJzZXRMYXlvdXRIZWlnaHQiLCJfdXNlU3RhdGU3IiwiX3VzZVN0YXRlOCIsInRyYW5zbGF0ZVkiLCJzZXRUcmFuc2xhdGVZIiwiX3VzZVN0YXRlOSIsIl91c2VTdGF0ZTAiLCJzZXROZXh0SGVhZGVyTGF5b3V0WSIsIl91c2VTdGF0ZTEiLCJfdXNlU3RhdGUxMCIsImlzRmFicmljIiwic2V0SXNGYWJyaWMiLCJjYWxsYmFja1JlZiIsInVzZUNhbGxiYWNrIiwic2V0TmV4dEhlYWRlclkiLCJpc0ZhYnJpY1B1YmxpY0luc3RhbmNlIiwidXNlTWVyZ2VSZWZzIiwib2Zmc2V0IiwidXNlTWVtbyIsIkFuaW1hdGVkIiwiZGlmZkNsYW1wIiwiaW50ZXJwb2xhdGUiLCJleHRyYXBvbGF0ZUxlZnQiLCJpbnB1dFJhbmdlIiwib3V0cHV0UmFuZ2UiLCJfdXNlU3RhdGUxMSIsImluaXRpYWxUcmFuc2xhdGVZIiwiYWRkIiwiX3VzZVN0YXRlMTIiLCJhbmltYXRlZFRyYW5zbGF0ZVkiLCJzZXRBbmltYXRlZFRyYW5zbGF0ZVkiLCJoYXZlUmVjZWl2ZWRJbml0aWFsWmVyb1RyYW5zbGF0ZVkiLCJ1c2VSZWYiLCJ0cmFuc2xhdGVZRGVib3VuY2VUaW1lciIsInVzZUVmZmVjdCIsImN1cnJlbnQiLCJhbmltYXRlZFZhbHVlTGlzdGVuZXIiLCJfcmVmMiIsInZhbHVlIiwiZGVib3VuY2VUaW1lb3V0IiwiUGxhdGZvcm0iLCJPUyIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJzdGlja1N0YXJ0UG9pbnQiLCJwdXNoIiwiY29sbGlzaW9uUG9pbnQiLCJuZXdBbmltYXRlZFRyYW5zbGF0ZVkiLCJhbmltYXRlZExpc3RlbmVySWQiLCJhZGRMaXN0ZW5lciIsInJlbW92ZUxpc3RlbmVyIiwiX29uTGF5b3V0IiwiZXZlbnQiLCJuYXRpdmVFdmVudCIsImxheW91dCIsInkiLCJoZWlnaHQiLCJvbkxheW91dCIsImNoaWxkIiwiQ2hpbGRyZW4iLCJvbmx5IiwiY2hpbGRyZW4iLCJwYXNzdGhyb3VnaEFuaW1hdGVkUHJvcEV4cGxpY2l0VmFsdWVzIiwic3R5bGUiLCJ0cmFuc2Zvcm0iLCJqc3giLCJWaWV3IiwiY29sbGFwc2FibGUiLCJuYXRpdmVJRCIsInN0eWxlcyIsImhlYWRlciIsImNsb25lRWxlbWVudCIsImZpbGwiLCJ1bmRlZmluZWQiLCJTdHlsZVNoZWV0IiwiY3JlYXRlIiwiekluZGV4IiwiZmxleCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIlNjcm9sbFZpZXdTdGlja3lIZWFkZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIE1ldGEgUGxhdGZvcm1zLCBJbmMuIGFuZCBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93IHN0cmljdC1sb2NhbFxuICogQGZvcm1hdFxuICovXG5cbmltcG9ydCB0eXBlIHtMYXlvdXRDaGFuZ2VFdmVudH0gZnJvbSAnLi4vLi4vVHlwZXMvQ29yZUV2ZW50VHlwZXMnO1xuXG5pbXBvcnQgQW5pbWF0ZWQgZnJvbSAnLi4vLi4vQW5pbWF0ZWQvQW5pbWF0ZWQnO1xuaW1wb3J0IHtpc1B1YmxpY0luc3RhbmNlIGFzIGlzRmFicmljUHVibGljSW5zdGFuY2V9IGZyb20gJy4uLy4uL1JlYWN0TmF0aXZlL1JlYWN0RmFicmljUHVibGljSW5zdGFuY2UvUmVhY3RGYWJyaWNQdWJsaWNJbnN0YW5jZVV0aWxzJztcbmltcG9ydCBTdHlsZVNoZWV0IGZyb20gJy4uLy4uL1N0eWxlU2hlZXQvU3R5bGVTaGVldCc7XG5pbXBvcnQgUGxhdGZvcm0gZnJvbSAnLi4vLi4vVXRpbGl0aWVzL1BsYXRmb3JtJztcbmltcG9ydCB1c2VNZXJnZVJlZnMgZnJvbSAnLi4vLi4vVXRpbGl0aWVzL3VzZU1lcmdlUmVmcyc7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1xuICBjbG9uZUVsZW1lbnQsXG4gIHVzZUNhbGxiYWNrLFxuICB1c2VFZmZlY3QsXG4gIHVzZU1lbW8sXG4gIHVzZVJlZixcbiAgdXNlU3RhdGUsXG59IGZyb20gJ3JlYWN0JztcblxuZXhwb3J0IHR5cGUgU2Nyb2xsVmlld1N0aWNreUhlYWRlclByb3BzID0gJFJlYWRPbmx5PHtcbiAgY2hpbGRyZW4/OiBSZWFjdC5Ob2RlLFxuICBuZXh0SGVhZGVyTGF5b3V0WTogP251bWJlcixcbiAgb25MYXlvdXQ6IChldmVudDogTGF5b3V0Q2hhbmdlRXZlbnQpID0+IHZvaWQsXG4gIHNjcm9sbEFuaW1hdGVkVmFsdWU6IEFuaW1hdGVkLlZhbHVlLFxuICAvLyBXaWxsIGNhdXNlIHN0aWNreSBoZWFkZXJzIHRvIHN0aWNrIGF0IHRoZSBib3R0b20gb2YgdGhlIFNjcm9sbFZpZXcgaW5zdGVhZFxuICAvLyBvZiB0aGUgdG9wLlxuICBpbnZlcnRlZDogP2Jvb2xlYW4sXG4gIC8vIFRoZSBoZWlnaHQgb2YgdGhlIHBhcmVudCBTY3JvbGxWaWV3LiBDdXJyZW50bHkgb25seSBzZXQgd2hlbiBpbnZlcnRlZC5cbiAgc2Nyb2xsVmlld0hlaWdodDogP251bWJlcixcbiAgbmF0aXZlSUQ/OiA/c3RyaW5nLFxuICBoaWRkZW5PblNjcm9sbD86ID9ib29sZWFuLFxufT47XG5cbmludGVyZmFjZSBJbnN0YW5jZSBleHRlbmRzIFJlYWN0LkVsZW1lbnRSZWY8dHlwZW9mIEFuaW1hdGVkLlZpZXc+IHtcbiAgK3NldE5leHRIZWFkZXJZOiBudW1iZXIgPT4gdm9pZDtcbn1cblxuY29uc3QgU2Nyb2xsVmlld1N0aWNreUhlYWRlcjogY29tcG9uZW50KFxuICByZWY6IFJlYWN0LlJlZlNldHRlcjxJbnN0YW5jZT4sXG4gIC4uLnByb3BzOiBTY3JvbGxWaWV3U3RpY2t5SGVhZGVyUHJvcHNcbikgPSBmdW5jdGlvbiBTY3JvbGxWaWV3U3RpY2t5SGVhZGVyKHtcbiAgcmVmOiBmb3J3YXJkZWRSZWYsXG4gIC4uLnByb3BzXG59OiB7XG4gIHJlZj86IFJlYWN0LlJlZlNldHRlcjxJbnN0YW5jZT4sXG4gIC4uLlNjcm9sbFZpZXdTdGlja3lIZWFkZXJQcm9wcyxcbn0pIHtcbiAgY29uc3Qge1xuICAgIGludmVydGVkLFxuICAgIHNjcm9sbFZpZXdIZWlnaHQsXG4gICAgaGlkZGVuT25TY3JvbGwsXG4gICAgc2Nyb2xsQW5pbWF0ZWRWYWx1ZSxcbiAgICBuZXh0SGVhZGVyTGF5b3V0WTogX25leHRIZWFkZXJMYXlvdXRZLFxuICB9ID0gcHJvcHM7XG5cbiAgY29uc3QgW21lYXN1cmVkLCBzZXRNZWFzdXJlZF0gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSk7XG4gIGNvbnN0IFtsYXlvdXRZLCBzZXRMYXlvdXRZXSA9IHVzZVN0YXRlPG51bWJlcj4oMCk7XG4gIGNvbnN0IFtsYXlvdXRIZWlnaHQsIHNldExheW91dEhlaWdodF0gPSB1c2VTdGF0ZTxudW1iZXI+KDApO1xuICBjb25zdCBbdHJhbnNsYXRlWSwgc2V0VHJhbnNsYXRlWV0gPSB1c2VTdGF0ZTw/bnVtYmVyPihudWxsKTtcbiAgY29uc3QgW25leHRIZWFkZXJMYXlvdXRZLCBzZXROZXh0SGVhZGVyTGF5b3V0WV0gPVxuICAgIHVzZVN0YXRlPD9udW1iZXI+KF9uZXh0SGVhZGVyTGF5b3V0WSk7XG4gIGNvbnN0IFtpc0ZhYnJpYywgc2V0SXNGYWJyaWNdID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuXG4gIGNvbnN0IGNhbGxiYWNrUmVmID0gdXNlQ2FsbGJhY2soKHJlZjogSW5zdGFuY2UgfCBudWxsKTogdm9pZCA9PiB7XG4gICAgaWYgKHJlZiA9PSBudWxsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vICRGbG93RXhwZWN0ZWRFcnJvcltjYW5ub3Qtd3JpdGVdXG4gICAgcmVmLnNldE5leHRIZWFkZXJZID0gc2V0TmV4dEhlYWRlckxheW91dFk7XG4gICAgc2V0SXNGYWJyaWMoaXNGYWJyaWNQdWJsaWNJbnN0YW5jZShyZWYpKTtcbiAgfSwgW10pO1xuICBjb25zdCByZWY6IFJlYWN0LlJlZlNldHRlcjxSZWFjdC5FbGVtZW50UmVmPHR5cGVvZiBBbmltYXRlZC5WaWV3Pj4gPVxuICAgIC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXSAtIEluc3RhbmNlIGlzIG11dGF0ZWQgdG8gaGF2ZSBgc2V0TmV4dEhlYWRlcllgLlxuICAgIHVzZU1lcmdlUmVmczxJbnN0YW5jZT4oY2FsbGJhY2tSZWYsIGZvcndhcmRlZFJlZik7XG5cbiAgY29uc3Qgb2Zmc2V0ID0gdXNlTWVtbyhcbiAgICAoKSA9PlxuICAgICAgaGlkZGVuT25TY3JvbGwgPT09IHRydWVcbiAgICAgICAgPyBBbmltYXRlZC5kaWZmQ2xhbXAoXG4gICAgICAgICAgICBzY3JvbGxBbmltYXRlZFZhbHVlXG4gICAgICAgICAgICAgIC5pbnRlcnBvbGF0ZSh7XG4gICAgICAgICAgICAgICAgZXh0cmFwb2xhdGVMZWZ0OiAnY2xhbXAnLFxuICAgICAgICAgICAgICAgIGlucHV0UmFuZ2U6IFtsYXlvdXRZLCBsYXlvdXRZICsgMV0sXG4gICAgICAgICAgICAgICAgb3V0cHV0UmFuZ2U6IChbMCwgMV06IEFycmF5PG51bWJlcj4pLFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAuaW50ZXJwb2xhdGUoe1xuICAgICAgICAgICAgICAgIGlucHV0UmFuZ2U6IFswLCAxXSxcbiAgICAgICAgICAgICAgICBvdXRwdXRSYW5nZTogKFswLCAtMV06IEFycmF5PG51bWJlcj4pLFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIC1sYXlvdXRIZWlnaHQsXG4gICAgICAgICAgICAwLFxuICAgICAgICAgIClcbiAgICAgICAgOiBudWxsLFxuICAgIFtzY3JvbGxBbmltYXRlZFZhbHVlLCBsYXlvdXRIZWlnaHQsIGxheW91dFksIGhpZGRlbk9uU2Nyb2xsXSxcbiAgKTtcblxuICBjb25zdCBbYW5pbWF0ZWRUcmFuc2xhdGVZLCBzZXRBbmltYXRlZFRyYW5zbGF0ZVldID0gdXNlU3RhdGU8QW5pbWF0ZWQuTm9kZT4oXG4gICAgKCkgPT4ge1xuICAgICAgY29uc3QgaW5wdXRSYW5nZTogQXJyYXk8bnVtYmVyPiA9IFstMSwgMF07XG4gICAgICBjb25zdCBvdXRwdXRSYW5nZTogQXJyYXk8bnVtYmVyPiA9IFswLCAwXTtcbiAgICAgIGNvbnN0IGluaXRpYWxUcmFuc2xhdGVZID0gc2Nyb2xsQW5pbWF0ZWRWYWx1ZS5pbnRlcnBvbGF0ZSh7XG4gICAgICAgIGlucHV0UmFuZ2UsXG4gICAgICAgIG91dHB1dFJhbmdlLFxuICAgICAgfSk7XG5cbiAgICAgIGlmIChvZmZzZXQgIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gQW5pbWF0ZWQuYWRkKGluaXRpYWxUcmFuc2xhdGVZLCBvZmZzZXQpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGluaXRpYWxUcmFuc2xhdGVZO1xuICAgIH0sXG4gICk7XG5cbiAgY29uc3QgaGF2ZVJlY2VpdmVkSW5pdGlhbFplcm9UcmFuc2xhdGVZID0gdXNlUmVmPGJvb2xlYW4+KHRydWUpO1xuICBjb25zdCB0cmFuc2xhdGVZRGVib3VuY2VUaW1lciA9IHVzZVJlZjw/VGltZW91dElEPihudWxsKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICh0cmFuc2xhdGVZICE9PSAwICYmIHRyYW5zbGF0ZVkgIT0gbnVsbCkge1xuICAgICAgaGF2ZVJlY2VpdmVkSW5pdGlhbFplcm9UcmFuc2xhdGVZLmN1cnJlbnQgPSBmYWxzZTtcbiAgICB9XG4gIH0sIFt0cmFuc2xhdGVZXSk7XG5cbiAgLy8gVGhpcyBpcyBjYWxsZWQgd2hlbmV2ZXIgdGhlIChJbnRlcnBvbGF0ZWQpIEFuaW1hdGVkIFZhbHVlXG4gIC8vIHVwZGF0ZXMsIHdoaWNoIGlzIHNldmVyYWwgdGltZXMgcGVyIGZyYW1lIGR1cmluZyBzY3JvbGxpbmcuXG4gIC8vIFRvIGVuc3VyZSB0aGF0IHRoZSBGYWJyaWMgU2hhZG93VHJlZSBoYXMgdGhlIG1vc3QgcmVjZW50XG4gIC8vIHRyYW5zbGF0ZSBzdHlsZSBvZiB0aGlzIG5vZGUsIHdlIGRlYm91bmNlIHRoZSB2YWx1ZSBhbmQgdGhlblxuICAvLyBwYXNzIGl0IHRocm91Z2ggdG8gdGhlIHVuZGVybHlpbmcgbm9kZSBkdXJpbmcgcmVuZGVyLlxuICAvLyBUaGlzIGlzOlxuICAvLyAxLiBPbmx5IGFuIGlzc3VlIGluIEZhYnJpYy5cbiAgLy8gMi4gV29yc2UgaW4gQW5kcm9pZCB0aGFuIGlPUy4gSW4gQW5kcm9pZCwgYnV0IG5vdCBpT1MsIHlvdVxuICAvLyAgICBjYW4gdG91Y2ggYW5kIG1vdmUgeW91ciBmaW5nZXIgc2xpZ2h0bHkgYW5kIHN0aWxsIHRyaWdnZXJcbiAgLy8gICAgYSBcInRhcFwiIGV2ZW50LiBJbiBpT1MsIG1vdmluZyB3aWxsIGNhbmNlbCB0aGUgdGFwIGluXG4gIC8vICAgIGJvdGggRmFicmljIGFuZCBub24tRmFicmljLiBPbiBBbmRyb2lkIHdoZW4geW91IG1vdmVcbiAgLy8gICAgeW91ciBmaW5nZXIsIHRoZSBoaXQtZGV0ZWN0aW9uIG1vdmVzIGZyb20gdGhlIEFuZHJvaWRcbiAgLy8gICAgcGxhdGZvcm0gdG8gSlMsIHNvIHdlIG5lZWQgdGhlIFNoYWRvd1RyZWUgdG8gaGF2ZSBrbm93bGVkZ2VcbiAgLy8gICAgb2YgdGhlIGN1cnJlbnQgcG9zaXRpb24uXG4gIGNvbnN0IGFuaW1hdGVkVmFsdWVMaXN0ZW5lciA9IHVzZUNhbGxiYWNrKCh7dmFsdWV9OiAkRmxvd0ZpeE1lKSA9PiB7XG4gICAgY29uc3QgZGVib3VuY2VUaW1lb3V0OiBudW1iZXIgPSBQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnID8gMTUgOiA2NDtcbiAgICAvLyBXaGVuIHRoZSBBbmltYXRlZEludGVycG9sYXRpb24gaXMgcmVjcmVhdGVkLCBpdCBhbHdheXMgaW5pdGlhbGl6ZXNcbiAgICAvLyB0byBhIHZhbHVlIG9mIHplcm8gYW5kIGVtaXRzIGEgdmFsdWUgY2hhbmdlIG9mIDAgdG8gaXRzIGxpc3RlbmVycy5cbiAgICBpZiAodmFsdWUgPT09IDAgJiYgIWhhdmVSZWNlaXZlZEluaXRpYWxaZXJvVHJhbnNsYXRlWS5jdXJyZW50KSB7XG4gICAgICBoYXZlUmVjZWl2ZWRJbml0aWFsWmVyb1RyYW5zbGF0ZVkuY3VycmVudCA9IHRydWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0cmFuc2xhdGVZRGVib3VuY2VUaW1lci5jdXJyZW50ICE9IG51bGwpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0cmFuc2xhdGVZRGVib3VuY2VUaW1lci5jdXJyZW50KTtcbiAgICB9XG4gICAgdHJhbnNsYXRlWURlYm91bmNlVGltZXIuY3VycmVudCA9IHNldFRpbWVvdXQoXG4gICAgICAoKSA9PiBzZXRUcmFuc2xhdGVZKHZhbHVlKSxcbiAgICAgIGRlYm91bmNlVGltZW91dCxcbiAgICApO1xuICB9LCBbXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBpbnB1dFJhbmdlOiBBcnJheTxudW1iZXI+ID0gWy0xLCAwXTtcbiAgICBjb25zdCBvdXRwdXRSYW5nZTogQXJyYXk8bnVtYmVyPiA9IFswLCAwXTtcblxuICAgIGlmIChtZWFzdXJlZCkge1xuICAgICAgaWYgKGludmVydGVkID09PSB0cnVlKSB7XG4gICAgICAgIC8vIFRoZSBpbnRlcnBvbGF0aW9uIGxvb2tzIGxpa2U6XG4gICAgICAgIC8vIC0gTmVnYXRpdmUgc2Nyb2xsOiBubyB0cmFuc2xhdGlvblxuICAgICAgICAvLyAtIGBzdGlja1N0YXJ0UG9pbnRgIGlzIHRoZSBwb2ludCBhdCB3aGljaCB0aGUgaGVhZGVyIHdpbGwgc3RhcnQgc3RpY2tpbmcuXG4gICAgICAgIC8vICAgSXQgaXMgY2FsY3VsYXRlZCB1c2luZyB0aGUgU2Nyb2xsVmlldyB2aWV3cG9ydCBoZWlnaHQgc28gaXQgaXMgYSB0aGUgYm90dG9tLlxuICAgICAgICAvLyAtIEhlYWRlcnMgdGhhdCBhcmUgaW4gdGhlIGluaXRpYWwgdmlld3BvcnQgd2lsbCBuZXZlciBzdGljaywgYHN0aWNrU3RhcnRQb2ludGBcbiAgICAgICAgLy8gICB3aWxsIGJlIG5lZ2F0aXZlLlxuICAgICAgICAvLyAtIEZyb20gMCB0byBgc3RpY2tTdGFydFBvaW50YCBubyB0cmFuc2xhdGlvbi4gVGhpcyB3aWxsIGNhdXNlIHRoZSBoZWFkZXJcbiAgICAgICAgLy8gICB0byBzY3JvbGwgbm9ybWFsbHkgdW50aWwgaXQgcmVhY2hlcyB0aGUgdG9wIG9mIHRoZSBzY3JvbGwgdmlldy5cbiAgICAgICAgLy8gLSBGcm9tIGBzdGlja1N0YXJ0UG9pbnRgIHRvIHdoZW4gdGhlIG5leHQgaGVhZGVyIHkgaGl0cyB0aGUgYm90dG9tIGVkZ2Ugb2YgdGhlIGhlYWRlcjogdHJhbnNsYXRlXG4gICAgICAgIC8vICAgZXF1YWxseSB0byBzY3JvbGwuIFRoaXMgd2lsbCBjYXVzZSB0aGUgaGVhZGVyIHRvIHN0YXkgYXQgdGhlIHRvcCBvZiB0aGUgc2Nyb2xsIHZpZXcuXG4gICAgICAgIC8vIC0gUGFzdCB0aGUgY29sbGlzaW9uIHdpdGggdGhlIG5leHQgaGVhZGVyIHk6IG5vIG1vcmUgdHJhbnNsYXRpb24uIFRoaXMgd2lsbCBjYXVzZSB0aGVcbiAgICAgICAgLy8gICBoZWFkZXIgdG8gY29udGludWUgc2Nyb2xsaW5nIHVwIGFuZCBtYWtlIHJvb20gZm9yIHRoZSBuZXh0IHN0aWNreSBoZWFkZXIuXG4gICAgICAgIC8vICAgSW4gdGhlIGNhc2UgdGhhdCB0aGVyZSBpcyBubyBuZXh0IGhlYWRlciBqdXN0IHRyYW5zbGF0ZSBlcXVhbGx5IHRvXG4gICAgICAgIC8vICAgc2Nyb2xsIGluZGVmaW5pdGVseS5cbiAgICAgICAgaWYgKHNjcm9sbFZpZXdIZWlnaHQgIT0gbnVsbCkge1xuICAgICAgICAgIGNvbnN0IHN0aWNrU3RhcnRQb2ludCA9IGxheW91dFkgKyBsYXlvdXRIZWlnaHQgLSBzY3JvbGxWaWV3SGVpZ2h0O1xuICAgICAgICAgIGlmIChzdGlja1N0YXJ0UG9pbnQgPiAwKSB7XG4gICAgICAgICAgICBpbnB1dFJhbmdlLnB1c2goc3RpY2tTdGFydFBvaW50KTtcbiAgICAgICAgICAgIG91dHB1dFJhbmdlLnB1c2goMCk7XG4gICAgICAgICAgICBpbnB1dFJhbmdlLnB1c2goc3RpY2tTdGFydFBvaW50ICsgMSk7XG4gICAgICAgICAgICBvdXRwdXRSYW5nZS5wdXNoKDEpO1xuICAgICAgICAgICAgLy8gSWYgdGhlIG5leHQgc3RpY2t5IGhlYWRlciBoYXMgbm90IGxvYWRlZCB5ZXQgKHByb2JhYmx5IHdpbmRvd2luZykgb3IgaXMgdGhlIGxhc3RcbiAgICAgICAgICAgIC8vIHdlIGNhbiBqdXN0IGtlZXAgaXQgc3RpY2tlZCBmb3JldmVyLlxuICAgICAgICAgICAgY29uc3QgY29sbGlzaW9uUG9pbnQgPVxuICAgICAgICAgICAgICAobmV4dEhlYWRlckxheW91dFkgfHwgMCkgLSBsYXlvdXRIZWlnaHQgLSBzY3JvbGxWaWV3SGVpZ2h0O1xuICAgICAgICAgICAgaWYgKGNvbGxpc2lvblBvaW50ID4gc3RpY2tTdGFydFBvaW50KSB7XG4gICAgICAgICAgICAgIGlucHV0UmFuZ2UucHVzaChjb2xsaXNpb25Qb2ludCwgY29sbGlzaW9uUG9pbnQgKyAxKTtcbiAgICAgICAgICAgICAgb3V0cHV0UmFuZ2UucHVzaChcbiAgICAgICAgICAgICAgICBjb2xsaXNpb25Qb2ludCAtIHN0aWNrU3RhcnRQb2ludCxcbiAgICAgICAgICAgICAgICBjb2xsaXNpb25Qb2ludCAtIHN0aWNrU3RhcnRQb2ludCxcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRoZSBpbnRlcnBvbGF0aW9uIGxvb2tzIGxpa2U6XG4gICAgICAgIC8vIC0gTmVnYXRpdmUgc2Nyb2xsOiBubyB0cmFuc2xhdGlvblxuICAgICAgICAvLyAtIEZyb20gMCB0byB0aGUgeSBvZiB0aGUgaGVhZGVyOiBubyB0cmFuc2xhdGlvbi4gVGhpcyB3aWxsIGNhdXNlIHRoZSBoZWFkZXJcbiAgICAgICAgLy8gICB0byBzY3JvbGwgbm9ybWFsbHkgdW50aWwgaXQgcmVhY2hlcyB0aGUgdG9wIG9mIHRoZSBzY3JvbGwgdmlldy5cbiAgICAgICAgLy8gLSBGcm9tIGhlYWRlciB5IHRvIHdoZW4gdGhlIG5leHQgaGVhZGVyIHkgaGl0cyB0aGUgYm90dG9tIGVkZ2Ugb2YgdGhlIGhlYWRlcjogdHJhbnNsYXRlXG4gICAgICAgIC8vICAgZXF1YWxseSB0byBzY3JvbGwuIFRoaXMgd2lsbCBjYXVzZSB0aGUgaGVhZGVyIHRvIHN0YXkgYXQgdGhlIHRvcCBvZiB0aGUgc2Nyb2xsIHZpZXcuXG4gICAgICAgIC8vIC0gUGFzdCB0aGUgY29sbGlzaW9uIHdpdGggdGhlIG5leHQgaGVhZGVyIHk6IG5vIG1vcmUgdHJhbnNsYXRpb24uIFRoaXMgd2lsbCBjYXVzZSB0aGVcbiAgICAgICAgLy8gICBoZWFkZXIgdG8gY29udGludWUgc2Nyb2xsaW5nIHVwIGFuZCBtYWtlIHJvb20gZm9yIHRoZSBuZXh0IHN0aWNreSBoZWFkZXIuXG4gICAgICAgIC8vICAgSW4gdGhlIGNhc2UgdGhhdCB0aGVyZSBpcyBubyBuZXh0IGhlYWRlciBqdXN0IHRyYW5zbGF0ZSBlcXVhbGx5IHRvXG4gICAgICAgIC8vICAgc2Nyb2xsIGluZGVmaW5pdGVseS5cbiAgICAgICAgaW5wdXRSYW5nZS5wdXNoKGxheW91dFkpO1xuICAgICAgICBvdXRwdXRSYW5nZS5wdXNoKDApO1xuICAgICAgICAvLyBJZiB0aGUgbmV4dCBzdGlja3kgaGVhZGVyIGhhcyBub3QgbG9hZGVkIHlldCAocHJvYmFibHkgd2luZG93aW5nKSBvciBpcyB0aGUgbGFzdFxuICAgICAgICAvLyB3ZSBjYW4ganVzdCBrZWVwIGl0IHN0aWNrZWQgZm9yZXZlci5cbiAgICAgICAgY29uc3QgY29sbGlzaW9uUG9pbnQgPSAobmV4dEhlYWRlckxheW91dFkgfHwgMCkgLSBsYXlvdXRIZWlnaHQ7XG4gICAgICAgIGlmIChjb2xsaXNpb25Qb2ludCA+PSBsYXlvdXRZKSB7XG4gICAgICAgICAgaW5wdXRSYW5nZS5wdXNoKGNvbGxpc2lvblBvaW50LCBjb2xsaXNpb25Qb2ludCArIDEpO1xuICAgICAgICAgIG91dHB1dFJhbmdlLnB1c2goY29sbGlzaW9uUG9pbnQgLSBsYXlvdXRZLCBjb2xsaXNpb25Qb2ludCAtIGxheW91dFkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlucHV0UmFuZ2UucHVzaChsYXlvdXRZICsgMSk7XG4gICAgICAgICAgb3V0cHV0UmFuZ2UucHVzaCgxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBuZXdBbmltYXRlZFRyYW5zbGF0ZVk6IEFuaW1hdGVkLk5vZGUgPSBzY3JvbGxBbmltYXRlZFZhbHVlLmludGVycG9sYXRlKHtcbiAgICAgIGlucHV0UmFuZ2UsXG4gICAgICBvdXRwdXRSYW5nZSxcbiAgICB9KTtcblxuICAgIGlmIChvZmZzZXQgIT0gbnVsbCkge1xuICAgICAgbmV3QW5pbWF0ZWRUcmFuc2xhdGVZID0gQW5pbWF0ZWQuYWRkKG5ld0FuaW1hdGVkVHJhbnNsYXRlWSwgb2Zmc2V0KTtcbiAgICB9XG5cbiAgICAvLyBhZGQgdGhlIGV2ZW50IGxpc3RlbmVyXG4gICAgbGV0IGFuaW1hdGVkTGlzdGVuZXJJZDtcbiAgICBpZiAoaXNGYWJyaWMpIHtcbiAgICAgIGFuaW1hdGVkTGlzdGVuZXJJZCA9IG5ld0FuaW1hdGVkVHJhbnNsYXRlWS5hZGRMaXN0ZW5lcihcbiAgICAgICAgYW5pbWF0ZWRWYWx1ZUxpc3RlbmVyLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBzZXRBbmltYXRlZFRyYW5zbGF0ZVkobmV3QW5pbWF0ZWRUcmFuc2xhdGVZKTtcblxuICAgIC8vIGNsZWFuIHVwIHRoZSBldmVudCBsaXN0ZW5lciBhbmQgdGltZXJcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgaWYgKGFuaW1hdGVkTGlzdGVuZXJJZCkge1xuICAgICAgICBuZXdBbmltYXRlZFRyYW5zbGF0ZVkucmVtb3ZlTGlzdGVuZXIoYW5pbWF0ZWRMaXN0ZW5lcklkKTtcbiAgICAgIH1cbiAgICAgIGlmICh0cmFuc2xhdGVZRGVib3VuY2VUaW1lci5jdXJyZW50ICE9IG51bGwpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRyYW5zbGF0ZVlEZWJvdW5jZVRpbWVyLmN1cnJlbnQpO1xuICAgICAgfVxuICAgIH07XG4gIH0sIFtcbiAgICBuZXh0SGVhZGVyTGF5b3V0WSxcbiAgICBtZWFzdXJlZCxcbiAgICBsYXlvdXRIZWlnaHQsXG4gICAgbGF5b3V0WSxcbiAgICBzY3JvbGxWaWV3SGVpZ2h0LFxuICAgIHNjcm9sbEFuaW1hdGVkVmFsdWUsXG4gICAgaW52ZXJ0ZWQsXG4gICAgb2Zmc2V0LFxuICAgIGFuaW1hdGVkVmFsdWVMaXN0ZW5lcixcbiAgICBpc0ZhYnJpYyxcbiAgXSk7XG5cbiAgY29uc3QgX29uTGF5b3V0ID0gKGV2ZW50OiBMYXlvdXRDaGFuZ2VFdmVudCkgPT4ge1xuICAgIHNldExheW91dFkoZXZlbnQubmF0aXZlRXZlbnQubGF5b3V0LnkpO1xuICAgIHNldExheW91dEhlaWdodChldmVudC5uYXRpdmVFdmVudC5sYXlvdXQuaGVpZ2h0KTtcbiAgICBzZXRNZWFzdXJlZCh0cnVlKTtcblxuICAgIHByb3BzLm9uTGF5b3V0KGV2ZW50KTtcbiAgICBjb25zdCBjaGlsZCA9IFJlYWN0LkNoaWxkcmVuLm9ubHk8JEZsb3dGaXhNZT4ocHJvcHMuY2hpbGRyZW4pO1xuICAgIGlmIChjaGlsZC5wcm9wcy5vbkxheW91dCkge1xuICAgICAgY2hpbGQucHJvcHMub25MYXlvdXQoZXZlbnQpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBjaGlsZCA9IFJlYWN0LkNoaWxkcmVuLm9ubHk8JEZsb3dGaXhNZT4ocHJvcHMuY2hpbGRyZW4pO1xuXG4gIGNvbnN0IHBhc3N0aHJvdWdoQW5pbWF0ZWRQcm9wRXhwbGljaXRWYWx1ZXMgPVxuICAgIGlzRmFicmljICYmIHRyYW5zbGF0ZVkgIT0gbnVsbFxuICAgICAgPyB7XG4gICAgICAgICAgc3R5bGU6IHt0cmFuc2Zvcm06IFt7dHJhbnNsYXRlWTogdHJhbnNsYXRlWX1dfSxcbiAgICAgICAgfVxuICAgICAgOiBudWxsO1xuXG4gIHJldHVybiAoXG4gICAgPEFuaW1hdGVkLlZpZXdcbiAgICAgIGNvbGxhcHNhYmxlPXtmYWxzZX1cbiAgICAgIG5hdGl2ZUlEPXtwcm9wcy5uYXRpdmVJRH1cbiAgICAgIG9uTGF5b3V0PXtfb25MYXlvdXR9XG4gICAgICAvKiAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ10gcGFzc3Rocm91Z2hBbmltYXRlZFByb3BFeHBsaWNpdFZhbHVlcyBpc24ndCBwcm9wZXJseVxuICAgICAgICAgaW5jbHVkZWQgaW4gdGhlIEFuaW1hdGVkLlZpZXcgZmxvdyB0eXBlLiAqL1xuICAgICAgcmVmPXtyZWZ9XG4gICAgICBzdHlsZT17W1xuICAgICAgICBjaGlsZC5wcm9wcy5zdHlsZSxcbiAgICAgICAgc3R5bGVzLmhlYWRlcixcbiAgICAgICAge3RyYW5zZm9ybTogW3t0cmFuc2xhdGVZOiBhbmltYXRlZFRyYW5zbGF0ZVl9XX0sXG4gICAgICBdfVxuICAgICAgcGFzc3Rocm91Z2hBbmltYXRlZFByb3BFeHBsaWNpdFZhbHVlcz17XG4gICAgICAgIHBhc3N0aHJvdWdoQW5pbWF0ZWRQcm9wRXhwbGljaXRWYWx1ZXNcbiAgICAgIH0+XG4gICAgICB7Y2xvbmVFbGVtZW50KGNoaWxkLCB7XG4gICAgICAgIHN0eWxlOiBzdHlsZXMuZmlsbCwgLy8gV2UgdHJhbnNmZXIgdGhlIGNoaWxkIHN0eWxlIHRvIHRoZSB3cmFwcGVyLlxuICAgICAgICBvbkxheW91dDogdW5kZWZpbmVkLCAvLyB3ZSBjYWxsIHRoaXMgbWFudWFsbHkgdGhyb3VnaCBvdXIgdGhpcy5fb25MYXlvdXRcbiAgICAgIH0pfVxuICAgIDwvQW5pbWF0ZWQuVmlldz5cbiAgKTtcbn07XG5cbmNvbnN0IHN0eWxlcyA9IFN0eWxlU2hlZXQuY3JlYXRlKHtcbiAgaGVhZGVyOiB7XG4gICAgekluZGV4OiAxMCxcbiAgfSxcbiAgZmlsbDoge1xuICAgIGZsZXg6IDEsXG4gIH0sXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgU2Nyb2xsVmlld1N0aWNreUhlYWRlcjtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFZQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQywrQkFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsV0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsU0FBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksYUFBQSxHQUFBTCxzQkFBQSxD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SUFDckIsSUFBTU0sS0FBSyxHQUFHdkYsS0FBSyxDQUFDd0YsUUFBUSxDQUFDQyxJQUFJLENBQWFsRixLQUFLLENBQUNtRixRQUFRLENBQUM7SUFDN0QsSUFBSUgsS0FBSyxDQUFDaEYsS0FBSyxDQUFDK0UsUUFBUSxFQUFFO01BQ3hCQyxLQUFLLENBQUNoRixLQUFLLENBQUMrRSxRQUFRLENBQUNMLEtBQUssQ0FBQztJQUM3QjtFQUNGLENBQUM7RUFFRCxJQUFNTSxLQUFLLEdBQUd2RixLQUFLLENBQUN3RixRQUFRLENBQUNDLElBQUksQ0FBYWxGLEtBQUssQ0FBQ21GLFFBQVEsQ0FBQztFQUU3RCxJQUFNQyxxQ0FBcUMsR0FDekNwRCxRQUFRLElBQUlQLFVBQVUsSUFBSSxJQUFJLEdBQzFCO0lBQ0U0RCxLQUFLLEVBQUU7TUFBQ0MsU0FBUyxFQUFFLENBQUM7UUFBQzdELFVBQVUsRUFBRUE7TUFBVSxDQUFDO0lBQUM7RUFDL0MsQ0FBQyxHQUNELElBQUk7RUFFVixPQUNFLElBQUEvQixXQUFBLENBQUE2RixHQUFBLEVBQUN2RyxTQUFBLENBQUFrQixPQUFRLENBQUNzRixJQUFJO0lBQ1pDLFdBQVcsRUFBRSxLQUFNO0lBQ25CQyxRQUFRLEVBQUUxRixLQUFLLENBQUMwRixRQUFTO0lBQ3pCWCxRQUFRLEVBQUVOLFNBQVU7SUFHcEIxRSxHQUFHLEVBQUVBLEdBQUk7SUFDVHNGLEtBQUssRUFBRSxDQUNMTCxLQUFLLENBQUNoRixLQUFLLENBQUNxRixLQUFLLEVBQ2pCTSxNQUFNLENBQUNDLE1BQU0sRUFDYjtNQUFDTixTQUFTLEVBQUUsQ0FBQztRQUFDN0QsVUFBVSxFQUFFMEI7TUFBa0IsQ0FBQztJQUFDLENBQUMsQ0FDL0M7SUFDRmlDLHFDQUFxQyxFQUNuQ0EscUNBQ0Q7SUFBQUQsUUFBQSxFQUNBLElBQUFVLG1CQUFZLEVBQUNiLEtBQUssRUFBRTtNQUNuQkssS0FBSyxFQUFFTSxNQUFNLENBQUNHLElBQUk7TUFDbEJmLFFBQVEsRUFBRWdCO0lBQ1osQ0FBQztFQUFDLENBQ1csQ0FBQztBQUVwQixDQUFDO0FBRUQsSUFBTUosTUFBTSxHQUFHSyxtQkFBVSxDQUFDQyxNQUFNLENBQUM7RUFDL0JMLE1BQU0sRUFBRTtJQUNOTSxNQUFNLEVBQUU7RUFDVixDQUFDO0VBQ0RKLElBQUksRUFBRTtJQUNKSyxJQUFJLEVBQUU7RUFDUjtBQUNGLENBQUMsQ0FBQztBQUFDLElBQUFDLFFBQUEsR0FBQUMsT0FBQSxDQUFBbkcsT0FBQSxHQUVZTixzQkFBc0IiLCJpZ25vcmVMaXN0IjpbXX0=