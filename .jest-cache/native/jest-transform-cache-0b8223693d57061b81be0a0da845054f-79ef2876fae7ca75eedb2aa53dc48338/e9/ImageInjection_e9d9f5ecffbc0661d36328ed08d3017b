857a973be67346f3c42a8dd3d5470386
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.unstable_getImageComponentDecorator = unstable_getImageComponentDecorator;
exports.unstable_registerImageAttachedCallback = unstable_registerImageAttachedCallback;
exports.unstable_setImageComponentDecorator = unstable_setImageComponentDecorator;
exports.unstable_unregisterImageAttachedCallback = unstable_unregisterImageAttachedCallback;
exports.useWrapRefWithImageAttachedCallbacks = useWrapRefWithImageAttachedCallbacks;
var _useMergeRefs = _interopRequireDefault(require("../Utilities/useMergeRefs"));
var _react = _interopRequireWildcard(require("react"));
var React = _react;
var injectedImageComponentDecorator;
function unstable_setImageComponentDecorator(imageComponentDecorator) {
  injectedImageComponentDecorator = imageComponentDecorator;
}
function unstable_getImageComponentDecorator() {
  return injectedImageComponentDecorator;
}
var imageAttachedCallbacks = new Set();
function unstable_registerImageAttachedCallback(callback) {
  imageAttachedCallbacks.add(callback);
}
function unstable_unregisterImageAttachedCallback(callback) {
  imageAttachedCallbacks.delete(callback);
}
function useWrapRefWithImageAttachedCallbacks(forwardedRef) {
  var pendingCleanupCallbacks = (0, _react.useRef)([]);
  var imageAttachedCallbacksRef = (0, _react.useRef)(null);
  if (imageAttachedCallbacksRef.current == null) {
    imageAttachedCallbacksRef.current = function (node) {
      if (node == null) {
        if (pendingCleanupCallbacks.current.length > 0) {
          pendingCleanupCallbacks.current.forEach(function (cb) {
            return cb();
          });
          pendingCleanupCallbacks.current = [];
        }
      } else {
        imageAttachedCallbacks.forEach(function (imageAttachedCallback) {
          var maybeCleanupCallback = imageAttachedCallback(node);
          if (maybeCleanupCallback != null) {
            pendingCleanupCallbacks.current.push(maybeCleanupCallback);
          }
        });
      }
    };
  }
  return (0, _useMergeRefs.default)(forwardedRef, imageAttachedCallbacksRef.current);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXNlTWVyZ2VSZWZzIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIlJlYWN0IiwiaW5qZWN0ZWRJbWFnZUNvbXBvbmVudERlY29yYXRvciIsInVuc3RhYmxlX3NldEltYWdlQ29tcG9uZW50RGVjb3JhdG9yIiwiaW1hZ2VDb21wb25lbnREZWNvcmF0b3IiLCJ1bnN0YWJsZV9nZXRJbWFnZUNvbXBvbmVudERlY29yYXRvciIsImltYWdlQXR0YWNoZWRDYWxsYmFja3MiLCJTZXQiLCJ1bnN0YWJsZV9yZWdpc3RlckltYWdlQXR0YWNoZWRDYWxsYmFjayIsImNhbGxiYWNrIiwiYWRkIiwidW5zdGFibGVfdW5yZWdpc3RlckltYWdlQXR0YWNoZWRDYWxsYmFjayIsImRlbGV0ZSIsInVzZVdyYXBSZWZXaXRoSW1hZ2VBdHRhY2hlZENhbGxiYWNrcyIsImZvcndhcmRlZFJlZiIsInBlbmRpbmdDbGVhbnVwQ2FsbGJhY2tzIiwidXNlUmVmIiwiaW1hZ2VBdHRhY2hlZENhbGxiYWNrc1JlZiIsImN1cnJlbnQiLCJub2RlIiwibGVuZ3RoIiwiZm9yRWFjaCIsImNiIiwiaW1hZ2VBdHRhY2hlZENhbGxiYWNrIiwibWF5YmVDbGVhbnVwQ2FsbGJhY2siLCJwdXNoIiwidXNlTWVyZ2VSZWZzIl0sInNvdXJjZXMiOlsiSW1hZ2VJbmplY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIE1ldGEgUGxhdGZvcm1zLCBJbmMuIGFuZCBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93IHN0cmljdC1sb2NhbFxuICogQGZvcm1hdFxuICovXG5cbmltcG9ydCB0eXBlIHtcbiAgQWJzdHJhY3RJbWFnZUFuZHJvaWQsXG4gIEFic3RyYWN0SW1hZ2VJT1MsXG4gIEltYWdlVHlwZSBhcyBJbWFnZUNvbXBvbmVudCxcbn0gZnJvbSAnLi9JbWFnZVR5cGVzLmZsb3cnO1xuXG5pbXBvcnQgdXNlTWVyZ2VSZWZzIGZyb20gJy4uL1V0aWxpdGllcy91c2VNZXJnZVJlZnMnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHt1c2VSZWZ9IGZyb20gJ3JlYWN0JztcblxudHlwZSBJbWFnZUNvbXBvbmVudERlY29yYXRvciA9IChBYnN0cmFjdEltYWdlQW5kcm9pZCA9PiBBYnN0cmFjdEltYWdlQW5kcm9pZCkgJlxuICAoQWJzdHJhY3RJbWFnZUlPUyA9PiBBYnN0cmFjdEltYWdlSU9TKTtcblxubGV0IGluamVjdGVkSW1hZ2VDb21wb25lbnREZWNvcmF0b3I6ID9JbWFnZUNvbXBvbmVudERlY29yYXRvcjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVuc3RhYmxlX3NldEltYWdlQ29tcG9uZW50RGVjb3JhdG9yKFxuICBpbWFnZUNvbXBvbmVudERlY29yYXRvcjogP0ltYWdlQ29tcG9uZW50RGVjb3JhdG9yLFxuKTogdm9pZCB7XG4gIGluamVjdGVkSW1hZ2VDb21wb25lbnREZWNvcmF0b3IgPSBpbWFnZUNvbXBvbmVudERlY29yYXRvcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuc3RhYmxlX2dldEltYWdlQ29tcG9uZW50RGVjb3JhdG9yKCk6ID9JbWFnZUNvbXBvbmVudERlY29yYXRvciB7XG4gIHJldHVybiBpbmplY3RlZEltYWdlQ29tcG9uZW50RGVjb3JhdG9yO1xufVxuXG50eXBlIEltYWdlSW5zdGFuY2UgPSBSZWFjdC5FbGVtZW50UmVmPEltYWdlQ29tcG9uZW50PjtcblxudHlwZSBJbWFnZUF0dGFjaGVkQ2FsbGJhY2sgPSAoXG4gIGltYWdlSW5zdGFuY2U6IEltYWdlSW5zdGFuY2UsXG4pID0+IHZvaWQgfCAoKCkgPT4gdm9pZCk7XG5cbmNvbnN0IGltYWdlQXR0YWNoZWRDYWxsYmFja3MgPSBuZXcgU2V0PEltYWdlQXR0YWNoZWRDYWxsYmFjaz4oKTtcblxuZXhwb3J0IGZ1bmN0aW9uIHVuc3RhYmxlX3JlZ2lzdGVySW1hZ2VBdHRhY2hlZENhbGxiYWNrKFxuICBjYWxsYmFjazogSW1hZ2VBdHRhY2hlZENhbGxiYWNrLFxuKTogdm9pZCB7XG4gIGltYWdlQXR0YWNoZWRDYWxsYmFja3MuYWRkKGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuc3RhYmxlX3VucmVnaXN0ZXJJbWFnZUF0dGFjaGVkQ2FsbGJhY2soXG4gIGNhbGxiYWNrOiBJbWFnZUF0dGFjaGVkQ2FsbGJhY2ssXG4pOiB2b2lkIHtcbiAgaW1hZ2VBdHRhY2hlZENhbGxiYWNrcy5kZWxldGUoY2FsbGJhY2spO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXNlV3JhcFJlZldpdGhJbWFnZUF0dGFjaGVkQ2FsbGJhY2tzKFxuICBmb3J3YXJkZWRSZWY6IFJlYWN0LlJlZlNldHRlcjxJbWFnZUluc3RhbmNlPixcbik6IFJlYWN0LlJlZlNldHRlcjxJbWFnZUluc3RhbmNlPiB7XG4gIGNvbnN0IHBlbmRpbmdDbGVhbnVwQ2FsbGJhY2tzID0gdXNlUmVmPEFycmF5PCgpID0+IHZvaWQ+PihbXSk7XG5cbiAgY29uc3QgaW1hZ2VBdHRhY2hlZENhbGxiYWNrc1JlZiA9XG4gICAgdXNlUmVmPD8obm9kZTogSW1hZ2VJbnN0YW5jZSB8IG51bGwpID0+IHZvaWQ+KG51bGwpO1xuXG4gIGlmIChpbWFnZUF0dGFjaGVkQ2FsbGJhY2tzUmVmLmN1cnJlbnQgPT0gbnVsbCkge1xuICAgIGltYWdlQXR0YWNoZWRDYWxsYmFja3NSZWYuY3VycmVudCA9IChub2RlOiBJbWFnZUluc3RhbmNlIHwgbnVsbCk6IHZvaWQgPT4ge1xuICAgICAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgICAgICBpZiAocGVuZGluZ0NsZWFudXBDYWxsYmFja3MuY3VycmVudC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgcGVuZGluZ0NsZWFudXBDYWxsYmFja3MuY3VycmVudC5mb3JFYWNoKGNiID0+IGNiKCkpO1xuICAgICAgICAgIHBlbmRpbmdDbGVhbnVwQ2FsbGJhY2tzLmN1cnJlbnQgPSBbXTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW1hZ2VBdHRhY2hlZENhbGxiYWNrcy5mb3JFYWNoKGltYWdlQXR0YWNoZWRDYWxsYmFjayA9PiB7XG4gICAgICAgICAgY29uc3QgbWF5YmVDbGVhbnVwQ2FsbGJhY2sgPSBpbWFnZUF0dGFjaGVkQ2FsbGJhY2sobm9kZSk7XG4gICAgICAgICAgaWYgKG1heWJlQ2xlYW51cENhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgIHBlbmRpbmdDbGVhbnVwQ2FsbGJhY2tzLmN1cnJlbnQucHVzaChtYXliZUNsZWFudXBDYWxsYmFjayk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLy8gYHVzZU1lcmdlUmVmc2AgcmV0dXJucyBhIHN0YWJsZSByZWYgaWYgaXRzIGFyZ3VtZW50cyBkb24ndCBjaGFuZ2UuXG4gIHJldHVybiB1c2VNZXJnZVJlZnM8SW1hZ2VJbnN0YW5jZT4oXG4gICAgZm9yd2FyZGVkUmVmLFxuICAgIGltYWdlQXR0YWNoZWRDYWxsYmFja3NSZWYuY3VycmVudCxcbiAgKTtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQWdCQSxJQUFBQSxhQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxNQUFBLEdBQUFDLHVCQUFBLENBQUFGLE9BQUE7QUFBK0IsSUFBQUcsS0FBQSxHQUFBRixNQUFBO0FBTS9CLElBQUlHLCtCQUF5RDtBQUV0RCxTQUFTQyxtQ0FBbUNBLENBQ2pEQyx1QkFBaUQsRUFDM0M7RUFDTkYsK0JBQStCLEdBQUdFLHVCQUF1QjtBQUMzRDtBQUVPLFNBQVNDLG1DQUFtQ0EsQ0FBQSxFQUE2QjtFQUM5RSxPQUFPSCwrQkFBK0I7QUFDeEM7QUFRQSxJQUFNSSxzQkFBc0IsR0FBRyxJQUFJQyxHQUFHLENBQXdCLENBQUM7QUFFeEQsU0FBU0Msc0NBQXNDQSxDQUNwREMsUUFBK0IsRUFDekI7RUFDTkgsc0JBQXNCLENBQUNJLEdBQUcsQ0FBQ0QsUUFBUSxDQUFDO0FBQ3RDO0FBRU8sU0FBU0Usd0NBQXdDQSxDQUN0REYsUUFBK0IsRUFDekI7RUFDTkgsc0JBQXNCLENBQUNNLE1BQU0sQ0FBQ0gsUUFBUSxDQUFDO0FBQ3pDO0FBRU8sU0FBU0ksb0NBQW9DQSxDQUNsREMsWUFBNEMsRUFDWjtFQUNoQyxJQUFNQyx1QkFBdUIsR0FBRyxJQUFBQyxhQUFNLEVBQW9CLEVBQUUsQ0FBQztFQUU3RCxJQUFNQyx5QkFBeUIsR0FDN0IsSUFBQUQsYUFBTSxFQUF3QyxJQUFJLENBQUM7RUFFckQsSUFBSUMseUJBQXlCLENBQUNDLE9BQU8sSUFBSSxJQUFJLEVBQUU7SUFDN0NELHlCQUF5QixDQUFDQyxPQUFPLEdBQUcsVUFBQ0MsSUFBMEIsRUFBVztNQUN4RSxJQUFJQSxJQUFJLElBQUksSUFBSSxFQUFFO1FBQ2hCLElBQUlKLHVCQUF1QixDQUFDRyxPQUFPLENBQUNFLE1BQU0sR0FBRyxDQUFDLEVBQUU7VUFDOUNMLHVCQUF1QixDQUFDRyxPQUFPLENBQUNHLE9BQU8sQ0FBQyxVQUFBQyxFQUFFO1lBQUEsT0FBSUEsRUFBRSxDQUFDLENBQUM7VUFBQSxFQUFDO1VBQ25EUCx1QkFBdUIsQ0FBQ0csT0FBTyxHQUFHLEVBQUU7UUFDdEM7TUFDRixDQUFDLE1BQU07UUFDTFosc0JBQXNCLENBQUNlLE9BQU8sQ0FBQyxVQUFBRSxxQkFBcUIsRUFBSTtVQUN0RCxJQUFNQyxvQkFBb0IsR0FBR0QscUJBQXFCLENBQUNKLElBQUksQ0FBQztVQUN4RCxJQUFJSyxvQkFBb0IsSUFBSSxJQUFJLEVBQUU7WUFDaENULHVCQUF1QixDQUFDRyxPQUFPLENBQUNPLElBQUksQ0FBQ0Qsb0JBQW9CLENBQUM7VUFDNUQ7UUFDRixDQUFDLENBQUM7TUFDSjtJQUNGLENBQUM7RUFDSDtFQUdBLE9BQU8sSUFBQUUscUJBQVksRUFDakJaLFlBQVksRUFDWkcseUJBQXlCLENBQUNDLE9BQzVCLENBQUM7QUFDSCIsImlnbm9yZUxpc3QiOltdfQ==