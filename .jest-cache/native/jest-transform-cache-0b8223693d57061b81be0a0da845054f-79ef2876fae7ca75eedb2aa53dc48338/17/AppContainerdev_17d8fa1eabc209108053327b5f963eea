82e16a33838c4ab22dc9b61daacfa4a0
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _ReactNativeStyleAttributes = _interopRequireDefault(require("../Components/View/ReactNativeStyleAttributes"));
var _View = _interopRequireDefault(require("../Components/View/View"));
var _DebuggingOverlay = _interopRequireDefault(require("../Debugging/DebuggingOverlay"));
var _useSubscribeToDebuggingOverlayRegistry = _interopRequireDefault(require("../Debugging/useSubscribeToDebuggingOverlayRegistry"));
var _RCTDeviceEventEmitter = _interopRequireDefault(require("../EventEmitter/RCTDeviceEventEmitter"));
var _LogBoxNotificationContainer = _interopRequireDefault(require("../LogBox/LogBoxNotificationContainer"));
var _StyleSheet = _interopRequireDefault(require("../StyleSheet/StyleSheet"));
var _RootTag = require("./RootTag");
var _react = _interopRequireWildcard(require("react"));
var React = _react;
var _jsxRuntime = require("react/jsx-runtime");
var useEffect = React.useEffect,
  useState = React.useState,
  useCallback = React.useCallback;
var reactDevToolsHook = window.__REACT_DEVTOOLS_GLOBAL_HOOK__;
if (reactDevToolsHook) {
  reactDevToolsHook.resolveRNStyle = require("../StyleSheet/flattenStyle").default;
  reactDevToolsHook.nativeStyleEditorValidAttributes = Object.keys(_ReactNativeStyleAttributes.default);
}
var InspectorDeferred = function InspectorDeferred(_ref) {
  var inspectedViewRef = _ref.inspectedViewRef,
    onInspectedViewRerenderRequest = _ref.onInspectedViewRerenderRequest,
    reactDevToolsAgent = _ref.reactDevToolsAgent;
  var Inspector = require("../../src/private/devsupport/devmenu/elementinspector/Inspector").default;
  return (0, _jsxRuntime.jsx)(Inspector, {
    inspectedViewRef: inspectedViewRef,
    onRequestRerenderApp: onInspectedViewRerenderRequest,
    reactDevToolsAgent: reactDevToolsAgent
  });
};
var ReactDevToolsOverlayDeferred = function ReactDevToolsOverlayDeferred(_ref2) {
  var inspectedViewRef = _ref2.inspectedViewRef,
    reactDevToolsAgent = _ref2.reactDevToolsAgent;
  var ReactDevToolsOverlay = require("../../src/private/devsupport/devmenu/elementinspector/ReactDevToolsOverlay").default;
  return (0, _jsxRuntime.jsx)(ReactDevToolsOverlay, {
    inspectedViewRef: inspectedViewRef,
    reactDevToolsAgent: reactDevToolsAgent
  });
};
var AppContainer = function AppContainer(_ref3) {
  var children = _ref3.children,
    fabric = _ref3.fabric,
    initialProps = _ref3.initialProps,
    _ref3$internal_exclud = _ref3.internal_excludeInspector,
    internal_excludeInspector = _ref3$internal_exclud === void 0 ? false : _ref3$internal_exclud,
    _ref3$internal_exclud2 = _ref3.internal_excludeLogBox,
    internal_excludeLogBox = _ref3$internal_exclud2 === void 0 ? false : _ref3$internal_exclud2,
    rootTag = _ref3.rootTag,
    WrapperComponent = _ref3.WrapperComponent,
    rootViewStyle = _ref3.rootViewStyle;
  var appContainerRootViewRef = (0, _react.useRef)(null);
  var innerViewRef = (0, _react.useRef)(null);
  var debuggingOverlayRef = (0, _react.useRef)(null);
  (0, _useSubscribeToDebuggingOverlayRegistry.default)(appContainerRootViewRef, debuggingOverlayRef);
  var _useState = useState(0),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    key = _useState2[0],
    setKey = _useState2[1];
  var _useState3 = useState(false),
    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
    shouldRenderInspector = _useState4[0],
    setShouldRenderInspector = _useState4[1];
  var _useState5 = useState(reactDevToolsHook == null ? void 0 : reactDevToolsHook.reactDevtoolsAgent),
    _useState6 = (0, _slicedToArray2.default)(_useState5, 2),
    reactDevToolsAgent = _useState6[0],
    setReactDevToolsAgent = _useState6[1];
  useEffect(function () {
    var inspectorSubscription = null;
    if (!internal_excludeInspector) {
      inspectorSubscription = _RCTDeviceEventEmitter.default.addListener('toggleElementInspector', function () {
        return setShouldRenderInspector(function (value) {
          return !value;
        });
      });
    }
    var reactDevToolsAgentListener = null;
    if (reactDevToolsHook != null && reactDevToolsAgent == null) {
      reactDevToolsAgentListener = setReactDevToolsAgent;
      reactDevToolsHook.on == null || reactDevToolsHook.on('react-devtools', reactDevToolsAgentListener);
    }
    return function () {
      var _inspectorSubscriptio;
      (_inspectorSubscriptio = inspectorSubscription) == null || _inspectorSubscriptio.remove();
      if ((reactDevToolsHook == null ? void 0 : reactDevToolsHook.off) != null && reactDevToolsAgentListener != null) {
        reactDevToolsHook.off('react-devtools', reactDevToolsAgentListener);
      }
    };
  }, []);
  var innerView = (0, _jsxRuntime.jsx)(_View.default, {
    collapsable: reactDevToolsAgent == null && !shouldRenderInspector,
    pointerEvents: "box-none",
    style: rootViewStyle || styles.container,
    ref: innerViewRef,
    children: children
  }, key);
  if (WrapperComponent != null) {
    innerView = (0, _jsxRuntime.jsx)(WrapperComponent, {
      initialProps: initialProps,
      fabric: fabric === true,
      children: innerView
    });
  }
  var onInspectedViewRerenderRequest = useCallback(function () {
    return setKey(function (k) {
      return k + 1;
    });
  }, []);
  return (0, _jsxRuntime.jsx)(_RootTag.RootTagContext.Provider, {
    value: (0, _RootTag.createRootTag)(rootTag),
    children: (0, _jsxRuntime.jsxs)(_View.default, {
      ref: appContainerRootViewRef,
      style: rootViewStyle || styles.container,
      pointerEvents: "box-none",
      children: [innerView, (0, _jsxRuntime.jsx)(_DebuggingOverlay.default, {
        ref: debuggingOverlayRef
      }), reactDevToolsAgent != null && (0, _jsxRuntime.jsx)(ReactDevToolsOverlayDeferred, {
        inspectedViewRef: innerViewRef,
        reactDevToolsAgent: reactDevToolsAgent
      }), shouldRenderInspector && (0, _jsxRuntime.jsx)(InspectorDeferred, {
        inspectedViewRef: innerViewRef,
        onInspectedViewRerenderRequest: onInspectedViewRerenderRequest,
        reactDevToolsAgent: reactDevToolsAgent
      }), !internal_excludeLogBox && (0, _jsxRuntime.jsx)(_LogBoxNotificationContainer.default, {})]
    })
  });
};
var styles = _StyleSheet.default.create({
  container: {
    flex: 1
  }
});
var _default = exports.default = AppContainer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfUmVhY3ROYXRpdmVTdHlsZUF0dHJpYnV0ZXMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9WaWV3IiwiX0RlYnVnZ2luZ092ZXJsYXkiLCJfdXNlU3Vic2NyaWJlVG9EZWJ1Z2dpbmdPdmVybGF5UmVnaXN0cnkiLCJfUkNURGV2aWNlRXZlbnRFbWl0dGVyIiwiX0xvZ0JveE5vdGlmaWNhdGlvbkNvbnRhaW5lciIsIl9TdHlsZVNoZWV0IiwiX1Jvb3RUYWciLCJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIlJlYWN0IiwiX2pzeFJ1bnRpbWUiLCJ1c2VFZmZlY3QiLCJ1c2VTdGF0ZSIsInVzZUNhbGxiYWNrIiwicmVhY3REZXZUb29sc0hvb2siLCJ3aW5kb3ciLCJfX1JFQUNUX0RFVlRPT0xTX0dMT0JBTF9IT09LX18iLCJyZXNvbHZlUk5TdHlsZSIsImRlZmF1bHQiLCJuYXRpdmVTdHlsZUVkaXRvclZhbGlkQXR0cmlidXRlcyIsIk9iamVjdCIsImtleXMiLCJSZWFjdE5hdGl2ZVN0eWxlQXR0cmlidXRlcyIsIkluc3BlY3RvckRlZmVycmVkIiwiX3JlZiIsImluc3BlY3RlZFZpZXdSZWYiLCJvbkluc3BlY3RlZFZpZXdSZXJlbmRlclJlcXVlc3QiLCJyZWFjdERldlRvb2xzQWdlbnQiLCJJbnNwZWN0b3IiLCJqc3giLCJvblJlcXVlc3RSZXJlbmRlckFwcCIsIlJlYWN0RGV2VG9vbHNPdmVybGF5RGVmZXJyZWQiLCJfcmVmMiIsIlJlYWN0RGV2VG9vbHNPdmVybGF5IiwiQXBwQ29udGFpbmVyIiwiX3JlZjMiLCJjaGlsZHJlbiIsImZhYnJpYyIsImluaXRpYWxQcm9wcyIsIl9yZWYzJGludGVybmFsX2V4Y2x1ZCIsImludGVybmFsX2V4Y2x1ZGVJbnNwZWN0b3IiLCJfcmVmMyRpbnRlcm5hbF9leGNsdWQyIiwiaW50ZXJuYWxfZXhjbHVkZUxvZ0JveCIsInJvb3RUYWciLCJXcmFwcGVyQ29tcG9uZW50Iiwicm9vdFZpZXdTdHlsZSIsImFwcENvbnRhaW5lclJvb3RWaWV3UmVmIiwidXNlUmVmIiwiaW5uZXJWaWV3UmVmIiwiZGVidWdnaW5nT3ZlcmxheVJlZiIsInVzZVN1YnNjcmliZVRvRGVidWdnaW5nT3ZlcmxheVJlZ2lzdHJ5IiwiX3VzZVN0YXRlIiwiX3VzZVN0YXRlMiIsIl9zbGljZWRUb0FycmF5MiIsImtleSIsInNldEtleSIsIl91c2VTdGF0ZTMiLCJfdXNlU3RhdGU0Iiwic2hvdWxkUmVuZGVySW5zcGVjdG9yIiwic2V0U2hvdWxkUmVuZGVySW5zcGVjdG9yIiwiX3VzZVN0YXRlNSIsInJlYWN0RGV2dG9vbHNBZ2VudCIsIl91c2VTdGF0ZTYiLCJzZXRSZWFjdERldlRvb2xzQWdlbnQiLCJpbnNwZWN0b3JTdWJzY3JpcHRpb24iLCJSQ1REZXZpY2VFdmVudEVtaXR0ZXIiLCJhZGRMaXN0ZW5lciIsInZhbHVlIiwicmVhY3REZXZUb29sc0FnZW50TGlzdGVuZXIiLCJvbiIsIl9pbnNwZWN0b3JTdWJzY3JpcHRpbyIsInJlbW92ZSIsIm9mZiIsImlubmVyVmlldyIsImNvbGxhcHNhYmxlIiwicG9pbnRlckV2ZW50cyIsInN0eWxlIiwic3R5bGVzIiwiY29udGFpbmVyIiwicmVmIiwiayIsIlJvb3RUYWdDb250ZXh0IiwiUHJvdmlkZXIiLCJjcmVhdGVSb290VGFnIiwianN4cyIsIlN0eWxlU2hlZXQiLCJjcmVhdGUiLCJmbGV4IiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiQXBwQ29udGFpbmVyLWRldi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZsb3cgc3RyaWN0LWxvY2FsXG4gKiBAZm9ybWF0XG4gKi9cblxuaW1wb3J0IHR5cGUge1xuICBSZWFjdERldlRvb2xzQWdlbnQsXG4gIFJlYWN0RGV2VG9vbHNHbG9iYWxIb29rLFxufSBmcm9tICcuLi9UeXBlcy9SZWFjdERldlRvb2xzVHlwZXMnO1xuaW1wb3J0IHR5cGUge1Byb3BzfSBmcm9tICcuL0FwcENvbnRhaW5lcic7XG5cbmltcG9ydCBSZWFjdE5hdGl2ZVN0eWxlQXR0cmlidXRlcyBmcm9tICcuLi9Db21wb25lbnRzL1ZpZXcvUmVhY3ROYXRpdmVTdHlsZUF0dHJpYnV0ZXMnO1xuaW1wb3J0IFZpZXcgZnJvbSAnLi4vQ29tcG9uZW50cy9WaWV3L1ZpZXcnO1xuaW1wb3J0IERlYnVnZ2luZ092ZXJsYXkgZnJvbSAnLi4vRGVidWdnaW5nL0RlYnVnZ2luZ092ZXJsYXknO1xuaW1wb3J0IHVzZVN1YnNjcmliZVRvRGVidWdnaW5nT3ZlcmxheVJlZ2lzdHJ5IGZyb20gJy4uL0RlYnVnZ2luZy91c2VTdWJzY3JpYmVUb0RlYnVnZ2luZ092ZXJsYXlSZWdpc3RyeSc7XG5pbXBvcnQgUkNURGV2aWNlRXZlbnRFbWl0dGVyIGZyb20gJy4uL0V2ZW50RW1pdHRlci9SQ1REZXZpY2VFdmVudEVtaXR0ZXInO1xuaW1wb3J0IExvZ0JveE5vdGlmaWNhdGlvbkNvbnRhaW5lciBmcm9tICcuLi9Mb2dCb3gvTG9nQm94Tm90aWZpY2F0aW9uQ29udGFpbmVyJztcbmltcG9ydCBTdHlsZVNoZWV0IGZyb20gJy4uL1N0eWxlU2hlZXQvU3R5bGVTaGVldCc7XG5pbXBvcnQge1Jvb3RUYWdDb250ZXh0LCBjcmVhdGVSb290VGFnfSBmcm9tICcuL1Jvb3RUYWcnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHt1c2VSZWZ9IGZyb20gJ3JlYWN0JztcblxuY29uc3Qge3VzZUVmZmVjdCwgdXNlU3RhdGUsIHVzZUNhbGxiYWNrfSA9IFJlYWN0O1xuXG5jb25zdCByZWFjdERldlRvb2xzSG9vazogUmVhY3REZXZUb29sc0dsb2JhbEhvb2sgPSAod2luZG93OiAkRmxvd0ZpeE1lKVxuICAuX19SRUFDVF9ERVZUT09MU19HTE9CQUxfSE9PS19fO1xuXG4vLyBSZXF1aXJlZCBmb3IgUmVhY3QgRGV2VG9vbHMgdG8gdmlldyAvIGVkaXQgUmVhY3QgTmF0aXZlIHN0eWxlcyBpbiBGbGlwcGVyLlxuLy8gRmxpcHBlciBkb2Vzbid0IGluamVjdCB0aGVzZSB2YWx1ZXMgd2hlbiBpbml0aWFsaXppbmcgRGV2VG9vbHMuXG5pZiAocmVhY3REZXZUb29sc0hvb2spIHtcbiAgcmVhY3REZXZUb29sc0hvb2sucmVzb2x2ZVJOU3R5bGUgPVxuICAgIHJlcXVpcmUoJy4uL1N0eWxlU2hlZXQvZmxhdHRlblN0eWxlJykuZGVmYXVsdDtcbiAgcmVhY3REZXZUb29sc0hvb2submF0aXZlU3R5bGVFZGl0b3JWYWxpZEF0dHJpYnV0ZXMgPSBPYmplY3Qua2V5cyhcbiAgICBSZWFjdE5hdGl2ZVN0eWxlQXR0cmlidXRlcyxcbiAgKTtcbn1cblxudHlwZSBJbnNwZWN0b3JEZWZlcnJlZFByb3BzID0ge1xuICBpbnNwZWN0ZWRWaWV3UmVmOiBJbnNwZWN0ZWRWaWV3UmVmLFxuICBvbkluc3BlY3RlZFZpZXdSZXJlbmRlclJlcXVlc3Q6ICgpID0+IHZvaWQsXG4gIHJlYWN0RGV2VG9vbHNBZ2VudD86IFJlYWN0RGV2VG9vbHNBZ2VudCxcbn07XG5cbmNvbnN0IEluc3BlY3RvckRlZmVycmVkID0gKHtcbiAgaW5zcGVjdGVkVmlld1JlZixcbiAgb25JbnNwZWN0ZWRWaWV3UmVyZW5kZXJSZXF1ZXN0LFxuICByZWFjdERldlRvb2xzQWdlbnQsXG59OiBJbnNwZWN0b3JEZWZlcnJlZFByb3BzKSA9PiB7XG4gIC8vIEQzOTM4Mjk2NyBhZGRzIGEgcmVxdWlyZSBjeWNsZTogSW5pdGlhbGl6ZUNvcmUgLT4gQXBwQ29udGFpbmVyIC0+IEluc3BlY3RvciAtPiBJbnNwZWN0b3JQYW5lbCAtPiBTY3JvbGxWaWV3IC0+IEluaXRpYWxpemVDb3JlXG4gIC8vIFdlIGNhbid0IHJlbW92ZSBpdCB5ZXQsIGZhbGxiYWNrIHRvIGR5bmFtaWMgcmVxdWlyZSBmb3Igbm93LiBUaGlzIGlzIHRoZSBvbmx5IHJlYXNvbiB3aHkgdGhpcyBsb2dpYyBpcyBpbiBhIHNlcGFyYXRlIGZ1bmN0aW9uLlxuICBjb25zdCBJbnNwZWN0b3IgPVxuICAgIHJlcXVpcmUoJy4uLy4uL3NyYy9wcml2YXRlL2RldnN1cHBvcnQvZGV2bWVudS9lbGVtZW50aW5zcGVjdG9yL0luc3BlY3RvcicpLmRlZmF1bHQ7XG5cbiAgcmV0dXJuIChcbiAgICA8SW5zcGVjdG9yXG4gICAgICBpbnNwZWN0ZWRWaWV3UmVmPXtpbnNwZWN0ZWRWaWV3UmVmfVxuICAgICAgb25SZXF1ZXN0UmVyZW5kZXJBcHA9e29uSW5zcGVjdGVkVmlld1JlcmVuZGVyUmVxdWVzdH1cbiAgICAgIHJlYWN0RGV2VG9vbHNBZ2VudD17cmVhY3REZXZUb29sc0FnZW50fVxuICAgIC8+XG4gICk7XG59O1xuXG50eXBlIFJlYWN0RGV2VG9vbHNPdmVybGF5RGVmZXJyZWRQcm9wcyA9IHtcbiAgaW5zcGVjdGVkVmlld1JlZjogSW5zcGVjdGVkVmlld1JlZixcbiAgcmVhY3REZXZUb29sc0FnZW50OiBSZWFjdERldlRvb2xzQWdlbnQsXG59O1xuXG5jb25zdCBSZWFjdERldlRvb2xzT3ZlcmxheURlZmVycmVkID0gKHtcbiAgaW5zcGVjdGVkVmlld1JlZixcbiAgcmVhY3REZXZUb29sc0FnZW50LFxufTogUmVhY3REZXZUb29sc092ZXJsYXlEZWZlcnJlZFByb3BzKSA9PiB7XG4gIGNvbnN0IFJlYWN0RGV2VG9vbHNPdmVybGF5ID1cbiAgICByZXF1aXJlKCcuLi8uLi9zcmMvcHJpdmF0ZS9kZXZzdXBwb3J0L2Rldm1lbnUvZWxlbWVudGluc3BlY3Rvci9SZWFjdERldlRvb2xzT3ZlcmxheScpLmRlZmF1bHQ7XG5cbiAgcmV0dXJuIChcbiAgICA8UmVhY3REZXZUb29sc092ZXJsYXlcbiAgICAgIGluc3BlY3RlZFZpZXdSZWY9e2luc3BlY3RlZFZpZXdSZWZ9XG4gICAgICByZWFjdERldlRvb2xzQWdlbnQ9e3JlYWN0RGV2VG9vbHNBZ2VudH1cbiAgICAvPlxuICApO1xufTtcblxuY29uc3QgQXBwQ29udGFpbmVyID0gKHtcbiAgY2hpbGRyZW4sXG4gIGZhYnJpYyxcbiAgaW5pdGlhbFByb3BzLFxuICBpbnRlcm5hbF9leGNsdWRlSW5zcGVjdG9yID0gZmFsc2UsXG4gIGludGVybmFsX2V4Y2x1ZGVMb2dCb3ggPSBmYWxzZSxcbiAgcm9vdFRhZyxcbiAgV3JhcHBlckNvbXBvbmVudCxcbiAgcm9vdFZpZXdTdHlsZSxcbn06IFByb3BzKTogUmVhY3QuTm9kZSA9PiB7XG4gIGNvbnN0IGFwcENvbnRhaW5lclJvb3RWaWV3UmVmOiBBcHBDb250YWluZXJSb290Vmlld1JlZiA9IHVzZVJlZihudWxsKTtcbiAgY29uc3QgaW5uZXJWaWV3UmVmOiBJbnNwZWN0ZWRWaWV3UmVmID0gdXNlUmVmKG51bGwpO1xuICBjb25zdCBkZWJ1Z2dpbmdPdmVybGF5UmVmOiBEZWJ1Z2dpbmdPdmVybGF5UmVmID0gdXNlUmVmKG51bGwpO1xuXG4gIHVzZVN1YnNjcmliZVRvRGVidWdnaW5nT3ZlcmxheVJlZ2lzdHJ5KFxuICAgIGFwcENvbnRhaW5lclJvb3RWaWV3UmVmLFxuICAgIGRlYnVnZ2luZ092ZXJsYXlSZWYsXG4gICk7XG5cbiAgY29uc3QgW2tleSwgc2V0S2V5XSA9IHVzZVN0YXRlKDApO1xuICBjb25zdCBbc2hvdWxkUmVuZGVySW5zcGVjdG9yLCBzZXRTaG91bGRSZW5kZXJJbnNwZWN0b3JdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbcmVhY3REZXZUb29sc0FnZW50LCBzZXRSZWFjdERldlRvb2xzQWdlbnRdID1cbiAgICB1c2VTdGF0ZTxSZWFjdERldlRvb2xzQWdlbnQgfCB2b2lkPihyZWFjdERldlRvb2xzSG9vaz8ucmVhY3REZXZ0b29sc0FnZW50KTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGxldCBpbnNwZWN0b3JTdWJzY3JpcHRpb24gPSBudWxsO1xuICAgIGlmICghaW50ZXJuYWxfZXhjbHVkZUluc3BlY3Rvcikge1xuICAgICAgaW5zcGVjdG9yU3Vic2NyaXB0aW9uID0gUkNURGV2aWNlRXZlbnRFbWl0dGVyLmFkZExpc3RlbmVyKFxuICAgICAgICAndG9nZ2xlRWxlbWVudEluc3BlY3RvcicsXG4gICAgICAgICgpID0+IHNldFNob3VsZFJlbmRlckluc3BlY3Rvcih2YWx1ZSA9PiAhdmFsdWUpLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBsZXQgcmVhY3REZXZUb29sc0FnZW50TGlzdGVuZXIgPSBudWxsO1xuICAgIC8vIElmIHRoaXMgaXMgZmlyc3QgcmVuZGVyLCBzdWJzY3JpYmUgdG8gdGhlIGV2ZW50IGZyb20gUmVhY3QgRGV2VG9vbHMgaG9va1xuICAgIGlmIChyZWFjdERldlRvb2xzSG9vayAhPSBudWxsICYmIHJlYWN0RGV2VG9vbHNBZ2VudCA9PSBudWxsKSB7XG4gICAgICByZWFjdERldlRvb2xzQWdlbnRMaXN0ZW5lciA9IHNldFJlYWN0RGV2VG9vbHNBZ2VudDtcbiAgICAgIHJlYWN0RGV2VG9vbHNIb29rLm9uPy4oJ3JlYWN0LWRldnRvb2xzJywgcmVhY3REZXZUb29sc0FnZW50TGlzdGVuZXIpO1xuICAgIH1cblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBpbnNwZWN0b3JTdWJzY3JpcHRpb24/LnJlbW92ZSgpO1xuXG4gICAgICBpZiAoXG4gICAgICAgIHJlYWN0RGV2VG9vbHNIb29rPy5vZmYgIT0gbnVsbCAmJlxuICAgICAgICByZWFjdERldlRvb2xzQWdlbnRMaXN0ZW5lciAhPSBudWxsXG4gICAgICApIHtcbiAgICAgICAgcmVhY3REZXZUb29sc0hvb2sub2ZmKCdyZWFjdC1kZXZ0b29scycsIHJlYWN0RGV2VG9vbHNBZ2VudExpc3RlbmVyKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgfSwgW10pO1xuXG4gIGxldCBpbm5lclZpZXc6IFJlYWN0Lk5vZGUgPSAoXG4gICAgPFZpZXdcbiAgICAgIGNvbGxhcHNhYmxlPXtyZWFjdERldlRvb2xzQWdlbnQgPT0gbnVsbCAmJiAhc2hvdWxkUmVuZGVySW5zcGVjdG9yfVxuICAgICAgcG9pbnRlckV2ZW50cz1cImJveC1ub25lXCJcbiAgICAgIGtleT17a2V5fVxuICAgICAgc3R5bGU9e3Jvb3RWaWV3U3R5bGUgfHwgc3R5bGVzLmNvbnRhaW5lcn1cbiAgICAgIHJlZj17aW5uZXJWaWV3UmVmfT5cbiAgICAgIHtjaGlsZHJlbn1cbiAgICA8L1ZpZXc+XG4gICk7XG5cbiAgaWYgKFdyYXBwZXJDb21wb25lbnQgIT0gbnVsbCkge1xuICAgIGlubmVyVmlldyA9IChcbiAgICAgIDxXcmFwcGVyQ29tcG9uZW50IGluaXRpYWxQcm9wcz17aW5pdGlhbFByb3BzfSBmYWJyaWM9e2ZhYnJpYyA9PT0gdHJ1ZX0+XG4gICAgICAgIHtpbm5lclZpZXd9XG4gICAgICA8L1dyYXBwZXJDb21wb25lbnQ+XG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IG9uSW5zcGVjdGVkVmlld1JlcmVuZGVyUmVxdWVzdCA9IHVzZUNhbGxiYWNrKFxuICAgICgpID0+IHNldEtleShrID0+IGsgKyAxKSxcbiAgICBbXSxcbiAgKTtcblxuICByZXR1cm4gKFxuICAgIDxSb290VGFnQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17Y3JlYXRlUm9vdFRhZyhyb290VGFnKX0+XG4gICAgICA8Vmlld1xuICAgICAgICByZWY9e2FwcENvbnRhaW5lclJvb3RWaWV3UmVmfVxuICAgICAgICBzdHlsZT17cm9vdFZpZXdTdHlsZSB8fCBzdHlsZXMuY29udGFpbmVyfVxuICAgICAgICBwb2ludGVyRXZlbnRzPVwiYm94LW5vbmVcIj5cbiAgICAgICAge2lubmVyVmlld31cblxuICAgICAgICA8RGVidWdnaW5nT3ZlcmxheSByZWY9e2RlYnVnZ2luZ092ZXJsYXlSZWZ9IC8+XG5cbiAgICAgICAge3JlYWN0RGV2VG9vbHNBZ2VudCAhPSBudWxsICYmIChcbiAgICAgICAgICA8UmVhY3REZXZUb29sc092ZXJsYXlEZWZlcnJlZFxuICAgICAgICAgICAgaW5zcGVjdGVkVmlld1JlZj17aW5uZXJWaWV3UmVmfVxuICAgICAgICAgICAgcmVhY3REZXZUb29sc0FnZW50PXtyZWFjdERldlRvb2xzQWdlbnR9XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cblxuICAgICAgICB7c2hvdWxkUmVuZGVySW5zcGVjdG9yICYmIChcbiAgICAgICAgICA8SW5zcGVjdG9yRGVmZXJyZWRcbiAgICAgICAgICAgIGluc3BlY3RlZFZpZXdSZWY9e2lubmVyVmlld1JlZn1cbiAgICAgICAgICAgIG9uSW5zcGVjdGVkVmlld1JlcmVuZGVyUmVxdWVzdD17b25JbnNwZWN0ZWRWaWV3UmVyZW5kZXJSZXF1ZXN0fVxuICAgICAgICAgICAgcmVhY3REZXZUb29sc0FnZW50PXtyZWFjdERldlRvb2xzQWdlbnR9XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cblxuICAgICAgICB7IWludGVybmFsX2V4Y2x1ZGVMb2dCb3ggJiYgPExvZ0JveE5vdGlmaWNhdGlvbkNvbnRhaW5lciAvPn1cbiAgICAgIDwvVmlldz5cbiAgICA8L1Jvb3RUYWdDb250ZXh0LlByb3ZpZGVyPlxuICApO1xufTtcblxuY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICBjb250YWluZXI6IHtmbGV4OiAxfSxcbn0pO1xuXG5leHBvcnQgdHlwZSBBcHBDb250YWluZXJSb290Vmlld1JlZiA9IFJlYWN0LlJlZk9iamVjdDxSZWFjdC5FbGVtZW50UmVmPFxuICB0eXBlb2YgVmlldyxcbj4gfCBudWxsPjtcbmV4cG9ydCB0eXBlIEluc3BlY3RlZFZpZXdSZWYgPSBSZWFjdC5SZWZPYmplY3Q8UmVhY3QuRWxlbWVudFJlZjxcbiAgdHlwZW9mIFZpZXcsXG4+IHwgbnVsbD47XG5leHBvcnQgdHlwZSBEZWJ1Z2dpbmdPdmVybGF5UmVmID0gUmVhY3QuUmVmT2JqZWN0PFJlYWN0LkVsZW1lbnRSZWY8XG4gIHR5cGVvZiBEZWJ1Z2dpbmdPdmVybGF5LFxuPiB8IG51bGw+O1xuXG5leHBvcnQgZGVmYXVsdCBBcHBDb250YWluZXI7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFnQkEsSUFBQUEsMkJBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLGlCQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyx1Q0FBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksc0JBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLDRCQUFBLEdBQUFOLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBTSxXQUFBLEdBQUFQLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBTyxRQUFBLEdBQUFQLE9BQUE7QUFDQSxJQUFBUSxNQUFBLEdBQUFDLHVCQUFBLENBQUFULE9BQUE7QUFBK0IsSUFBQVUsS0FBQSxHQUFBRixNQUFBO0FBQUEsSUFBQUcsV0FBQSxHQUFBWCxPQUFBO0FBRy9CLElBQU9ZLFNBQVMsR0FBMkJGLEtBQUssQ0FBekNFLFNBQVM7RUFBRUMsUUFBUSxHQUFpQkgsS0FBSyxDQUE5QkcsUUFBUTtFQUFFQyxXQUFXLEdBQUlKLEtBQUssQ0FBcEJJLFdBQVc7QUFFdkMsSUFBTUMsaUJBQTBDLEdBQUlDLE1BQU0sQ0FDdkRDLDhCQUE4QjtBQUlqQyxJQUFJRixpQkFBaUIsRUFBRTtFQUNyQkEsaUJBQWlCLENBQUNHLGNBQWMsR0FDOUJsQixPQUFPLDZCQUE2QixDQUFDLENBQUNtQixPQUFPO0VBQy9DSixpQkFBaUIsQ0FBQ0ssZ0NBQWdDLEdBQUdDLE1BQU0sQ0FBQ0MsSUFBSSxDQUM5REMsbUNBQ0YsQ0FBQztBQUNIO0FBUUEsSUFBTUMsaUJBQWlCLEdBQUcsU0FBcEJBLGlCQUFpQkEs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