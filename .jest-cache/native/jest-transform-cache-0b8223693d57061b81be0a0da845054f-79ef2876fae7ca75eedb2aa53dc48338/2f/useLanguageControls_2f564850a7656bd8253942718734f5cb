3e4aab696229da505c1b545b50cede67
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _react = require("react");
var _reactRedux = require("react-redux");
var _i18n = require("../../../../i18n");
var _hooks = require("../../../../hooks");
var _selectors = require("../../../../store/selectors");
var _ui = require("../../../../store/slices/ui.slice");
var _storage = require("../../../../services/storage");
var _types = require("./types");
var getDefaultLocale = function getDefaultLocale(supportedLocales) {
  return (supportedLocales == null ? void 0 : supportedLocales[0]) || 'en';
};
var isSupportedLocale = function isSupportedLocale(value, supportedLocales) {
  if (!value || !Array.isArray(supportedLocales)) return false;
  return supportedLocales.includes(value);
};
var buildOptions = function buildOptions(supportedLocales, t) {
  if (!Array.isArray(supportedLocales)) return [];
  return supportedLocales.map(function (value) {
    var labelKey = _types.LOCALE_LABEL_KEYS[value] || `settings.language.options.${value}`;
    return {
      value: value,
      label: t(labelKey)
    };
  });
};
var useLanguageControls = function useLanguageControls() {
  var _useI18n = (0, _hooks.useI18n)(),
    t = _useI18n.t;
  var dispatch = (0, _reactRedux.useDispatch)();
  var storedLocale = (0, _reactRedux.useSelector)(_selectors.selectLocale);
  var i18n = (0, _react.useMemo)(function () {
    return (0, _i18n.createI18n)({
      initialLocale: storedLocale
    });
  }, [storedLocale]);
  var supportedLocales = i18n.supportedLocales;
  var fallbackLocale = getDefaultLocale(supportedLocales);
  var locale = isSupportedLocale(storedLocale, supportedLocales) ? storedLocale : fallbackLocale;
  var options = (0, _react.useMemo)(function () {
    return buildOptions(supportedLocales, t);
  }, [supportedLocales, t]);
  var setLocale = (0, _react.useCallback)(function (nextLocale) {
    if (!isSupportedLocale(nextLocale, supportedLocales)) return;
    if (nextLocale === locale) return;
    dispatch(_ui.actions.setLocale(nextLocale));
    void _storage.async.setItem(_types.LOCALE_STORAGE_KEY, nextLocale);
  }, [dispatch, locale, supportedLocales]);
  return {
    locale: locale,
    options: options,
    setLocale: setLocale
  };
};
var _default = exports.default = useLanguageControls;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3JlYWN0UmVkdXgiLCJfaTE4biIsIl9ob29rcyIsIl9zZWxlY3RvcnMiLCJfdWkiLCJfc3RvcmFnZSIsIl90eXBlcyIsImdldERlZmF1bHRMb2NhbGUiLCJzdXBwb3J0ZWRMb2NhbGVzIiwiaXNTdXBwb3J0ZWRMb2NhbGUiLCJ2YWx1ZSIsIkFycmF5IiwiaXNBcnJheSIsImluY2x1ZGVzIiwiYnVpbGRPcHRpb25zIiwidCIsIm1hcCIsImxhYmVsS2V5IiwiTE9DQUxFX0xBQkVMX0tFWVMiLCJsYWJlbCIsInVzZUxhbmd1YWdlQ29udHJvbHMiLCJfdXNlSTE4biIsInVzZUkxOG4iLCJkaXNwYXRjaCIsInVzZURpc3BhdGNoIiwic3RvcmVkTG9jYWxlIiwidXNlU2VsZWN0b3IiLCJzZWxlY3RMb2NhbGUiLCJpMThuIiwidXNlTWVtbyIsImNyZWF0ZUkxOG4iLCJpbml0aWFsTG9jYWxlIiwiZmFsbGJhY2tMb2NhbGUiLCJsb2NhbGUiLCJvcHRpb25zIiwic2V0TG9jYWxlIiwidXNlQ2FsbGJhY2siLCJuZXh0TG9jYWxlIiwiYWN0aW9ucyIsImFzeW5jU3RvcmFnZSIsInNldEl0ZW0iLCJMT0NBTEVfU1RPUkFHRV9LRVkiLCJfZGVmYXVsdCIsImV4cG9ydHMiLCJkZWZhdWx0Il0sInNvdXJjZXMiOlsidXNlTGFuZ3VhZ2VDb250cm9scy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogdXNlTGFuZ3VhZ2VDb250cm9scyBIb29rXHJcbiAqIExhbmd1YWdlIHNlbGVjdGlvbiBsb2dpYyB3aXRoIHBlcnNpc3RlbmNlXHJcbiAqIEZpbGU6IHVzZUxhbmd1YWdlQ29udHJvbHMuanNcclxuICovXHJcbmltcG9ydCB7IHVzZUNhbGxiYWNrLCB1c2VNZW1vIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyB1c2VEaXNwYXRjaCwgdXNlU2VsZWN0b3IgfSBmcm9tICdyZWFjdC1yZWR1eCc7XHJcbmltcG9ydCB7IGNyZWF0ZUkxOG4gfSBmcm9tICdAaTE4bic7XHJcbmltcG9ydCB7IHVzZUkxOG4gfSBmcm9tICdAaG9va3MnO1xyXG5pbXBvcnQgeyBzZWxlY3RMb2NhbGUgfSBmcm9tICdAc3RvcmUvc2VsZWN0b3JzJztcclxuaW1wb3J0IHsgYWN0aW9ucyB9IGZyb20gJ0BzdG9yZS9zbGljZXMvdWkuc2xpY2UnO1xyXG5pbXBvcnQgeyBhc3luYyBhcyBhc3luY1N0b3JhZ2UgfSBmcm9tICdAc2VydmljZXMvc3RvcmFnZSc7XHJcbmltcG9ydCB7IExPQ0FMRV9MQUJFTF9LRVlTLCBMT0NBTEVfU1RPUkFHRV9LRVkgfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbmNvbnN0IGdldERlZmF1bHRMb2NhbGUgPSAoc3VwcG9ydGVkTG9jYWxlcykgPT4gc3VwcG9ydGVkTG9jYWxlcz8uWzBdIHx8ICdlbic7XHJcblxyXG5jb25zdCBpc1N1cHBvcnRlZExvY2FsZSA9ICh2YWx1ZSwgc3VwcG9ydGVkTG9jYWxlcykgPT4ge1xyXG4gIGlmICghdmFsdWUgfHwgIUFycmF5LmlzQXJyYXkoc3VwcG9ydGVkTG9jYWxlcykpIHJldHVybiBmYWxzZTtcclxuICByZXR1cm4gc3VwcG9ydGVkTG9jYWxlcy5pbmNsdWRlcyh2YWx1ZSk7XHJcbn07XHJcblxyXG5jb25zdCBidWlsZE9wdGlvbnMgPSAoc3VwcG9ydGVkTG9jYWxlcywgdCkgPT4ge1xyXG4gIGlmICghQXJyYXkuaXNBcnJheShzdXBwb3J0ZWRMb2NhbGVzKSkgcmV0dXJuIFtdO1xyXG4gIHJldHVybiBzdXBwb3J0ZWRMb2NhbGVzLm1hcCgodmFsdWUpID0+IHtcclxuICAgIGNvbnN0IGxhYmVsS2V5ID0gTE9DQUxFX0xBQkVMX0tFWVNbdmFsdWVdIHx8IGBzZXR0aW5ncy5sYW5ndWFnZS5vcHRpb25zLiR7dmFsdWV9YDtcclxuICAgIHJldHVybiB7IHZhbHVlLCBsYWJlbDogdChsYWJlbEtleSkgfTtcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IHVzZUxhbmd1YWdlQ29udHJvbHMgPSAoKSA9PiB7XHJcbiAgY29uc3QgeyB0IH0gPSB1c2VJMThuKCk7XHJcbiAgY29uc3QgZGlzcGF0Y2ggPSB1c2VEaXNwYXRjaCgpO1xyXG4gIGNvbnN0IHN0b3JlZExvY2FsZSA9IHVzZVNlbGVjdG9yKHNlbGVjdExvY2FsZSk7XHJcbiAgY29uc3QgaTE4biA9IHVzZU1lbW8oKCkgPT4gY3JlYXRlSTE4bih7IGluaXRpYWxMb2NhbGU6IHN0b3JlZExvY2FsZSB9KSwgW3N0b3JlZExvY2FsZV0pO1xyXG4gIGNvbnN0IHN1cHBvcnRlZExvY2FsZXMgPSBpMThuLnN1cHBvcnRlZExvY2FsZXM7XHJcbiAgY29uc3QgZmFsbGJhY2tMb2NhbGUgPSBnZXREZWZhdWx0TG9jYWxlKHN1cHBvcnRlZExvY2FsZXMpO1xyXG4gIGNvbnN0IGxvY2FsZSA9IGlzU3VwcG9ydGVkTG9jYWxlKHN0b3JlZExvY2FsZSwgc3VwcG9ydGVkTG9jYWxlcykgPyBzdG9yZWRMb2NhbGUgOiBmYWxsYmFja0xvY2FsZTtcclxuXHJcbiAgY29uc3Qgb3B0aW9ucyA9IHVzZU1lbW8oKCkgPT4gYnVpbGRPcHRpb25zKHN1cHBvcnRlZExvY2FsZXMsIHQpLCBbc3VwcG9ydGVkTG9jYWxlcywgdF0pO1xyXG5cclxuICBjb25zdCBzZXRMb2NhbGUgPSB1c2VDYWxsYmFjayhcclxuICAgIChuZXh0TG9jYWxlKSA9PiB7XHJcbiAgICAgIGlmICghaXNTdXBwb3J0ZWRMb2NhbGUobmV4dExvY2FsZSwgc3VwcG9ydGVkTG9jYWxlcykpIHJldHVybjtcclxuICAgICAgaWYgKG5leHRMb2NhbGUgPT09IGxvY2FsZSkgcmV0dXJuO1xyXG4gICAgICBkaXNwYXRjaChhY3Rpb25zLnNldExvY2FsZShuZXh0TG9jYWxlKSk7XHJcbiAgICAgIHZvaWQgYXN5bmNTdG9yYWdlLnNldEl0ZW0oTE9DQUxFX1NUT1JBR0VfS0VZLCBuZXh0TG9jYWxlKTtcclxuICAgIH0sXHJcbiAgICBbZGlzcGF0Y2gsIGxvY2FsZSwgc3VwcG9ydGVkTG9jYWxlc11cclxuICApO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgbG9jYWxlLFxyXG4gICAgb3B0aW9ucyxcclxuICAgIHNldExvY2FsZSxcclxuICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgdXNlTGFuZ3VhZ2VDb250cm9scztcclxuIl0sIm1hcHBpbmdzIjoiOzs7O0FBS0EsSUFBQUEsTUFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsV0FBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsS0FBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsTUFBQSxHQUFBSCxPQUFBO0FBQ0EsSUFBQUksVUFBQSxHQUFBSixPQUFBO0FBQ0EsSUFBQUssR0FBQSxHQUFBTCxPQUFBO0FBQ0EsSUFBQU0sUUFBQSxHQUFBTixPQUFBO0FBQ0EsSUFBQU8sTUFBQSxHQUFBUCxPQUFBO0FBRUEsSUFBTVEsZ0JBQWdCLEdBQUcsU0FBbkJBLGdCQUFnQkEsQ0FBSUMsZ0JBQWdCO0VBQUEsT0FBSyxDQUFBQSxnQkFBZ0Isb0JBQWhCQSxnQkFBZ0IsQ0FBRyxDQUFDLENBQUMsS0FBSSxJQUFJO0FBQUE7QUFFNUUsSUFBTUMsaUJBQWlCLEdBQUcsU0FBcEJBLGlCQUFpQkEsQ0FBSUMsS0FBSyxFQUFFRixnQkFBZ0IsRUFBSztFQUNyRCxJQUFJLENBQUNFLEtBQUssSUFBSSxDQUFDQyxLQUFLLENBQUNDLE9BQU8sQ0FBQ0osZ0JBQWdCLENBQUMsRUFBRSxPQUFPLEtBQUs7RUFDNUQsT0FBT0EsZ0JBQWdCLENBQUNLLFFBQVEsQ0FBQ0gsS0FBSyxDQUFDO0FBQ3pDLENBQUM7QUFFRCxJQUFNSSxZQUFZLEdBQUcsU0FBZkEsWUFBWUEsQ0FBSU4sZ0JBQWdCLEVBQUVPLENBQUMsRUFBSztFQUM1QyxJQUFJLENBQUNKLEtBQUssQ0FBQ0MsT0FBTyxDQUFDSixnQkFBZ0IsQ0FBQyxFQUFFLE9BQU8sRUFBRTtFQUMvQyxPQUFPQSxnQkFBZ0IsQ0FBQ1EsR0FBRyxDQUFDLFVBQUNOLEtBQUssRUFBSztJQUNyQyxJQUFNTyxRQUFRLEdBQUdDLHdCQUFpQixDQUFDUixLQUFLLENBQUMsSUFBSSw2QkFBNkJBLEtBQUssRUFBRTtJQUNqRixPQUFPO01BQUVBLEtBQUssRUFBTEEsS0FBSztNQUFFUyxLQUFLLEVBQUVKLENBQUMsQ0FBQ0UsUUFBUTtJQUFFLENBQUM7RUFDdEMsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUVELElBQU1HLG1CQUFtQixHQUFHLFNBQXRCQSxtQkFBbUJBLENBQUEsRUFBUztFQUNoQyxJQUFBQyxRQUFBLEdBQWMsSUFBQUMsY0FBTyxFQUFDLENBQUM7SUFBZlAsQ0FBQyxHQUFBTSxRQUFBLENBQUROLENBQUM7RUFDVCxJQUFNUSxRQUFRLEdBQUcsSUFBQUMsdUJBQVcsRUFBQyxDQUFDO0VBQzlCLElBQU1DLFlBQVksR0FBRyxJQUFBQyx1QkFBVyxFQUFDQyx1QkFBWSxDQUFDO0VBQzlDLElBQU1DLElBQUksR0FBRyxJQUFBQyxjQUFPLEVBQUM7SUFBQSxPQUFNLElBQUFDLGdCQUFVLEVBQUM7TUFBRUMsYUFBYSxFQUFFTjtJQUFhLENBQUMsQ0FBQztFQUFBLEdBQUUsQ0FBQ0EsWUFBWSxDQUFDLENBQUM7RUFDdkYsSUFBTWpCLGdCQUFnQixHQUFHb0IsSUFBSSxDQUFDcEIsZ0JBQWdCO0VBQzlDLElBQU13QixjQUFjLEdBQUd6QixnQkFBZ0IsQ0FBQ0MsZ0JBQWdCLENBQUM7RUFDekQsSUFBTXlCLE1BQU0sR0FBR3hCLGlCQUFpQixDQUFDZ0IsWUFBWSxFQUFFakIsZ0JBQWdCLENBQUMsR0FBR2lCLFlBQVksR0FBR08sY0FBYztFQUVoRyxJQUFNRSxPQUFPLEdBQUcsSUFBQUwsY0FBTyxFQUFDO0lBQUEsT0FBTWYsWUFBWSxDQUFDTixnQkFBZ0IsRUFBRU8sQ0FBQyxDQUFDO0VBQUEsR0FBRSxDQUFDUCxnQkFBZ0IsRUFBRU8sQ0FBQyxDQUFDLENBQUM7RUFFdkYsSUFBTW9CLFNBQVMsR0FBRyxJQUFBQyxrQkFBVyxFQUMzQixVQUFDQyxVQUFVLEVBQUs7SUFDZCxJQUFJLENBQUM1QixpQkFBaUIsQ0FBQzRCLFVBQVUsRUFBRTdCLGdCQUFnQixDQUFDLEVBQUU7SUFDdEQsSUFBSTZCLFVBQVUsS0FBS0osTUFBTSxFQUFFO0lBQzNCVixRQUFRLENBQUNlLFdBQU8sQ0FBQ0gsU0FBUyxDQUFDRSxVQUFVLENBQUMsQ0FBQztJQUN2QyxLQUFLRSxjQUFZLENBQUNDLE9BQU8sQ0FBQ0MseUJBQWtCLEVBQUVKLFVBQVUsQ0FBQztFQUMzRCxDQUFDLEVBQ0QsQ0FBQ2QsUUFBUSxFQUFFVSxNQUFNLEVBQUV6QixnQkFBZ0IsQ0FDckMsQ0FBQztFQUVELE9BQU87SUFDTHlCLE1BQU0sRUFBTkEsTUFBTTtJQUNOQyxPQUFPLEVBQVBBLE9BQU87SUFDUEMsU0FBUyxFQUFUQTtFQUNGLENBQUM7QUFDSCxDQUFDO0FBQUMsSUFBQU8sUUFBQSxHQUFBQyxPQUFBLENBQUFDLE9BQUEsR0FFYXhCLG1CQUFtQiIsImlnbm9yZUxpc3QiOltdfQ==