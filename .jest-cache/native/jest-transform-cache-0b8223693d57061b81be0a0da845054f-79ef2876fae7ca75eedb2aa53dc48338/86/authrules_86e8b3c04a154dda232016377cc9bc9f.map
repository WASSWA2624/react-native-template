{"version":3,"names":["_zod","require","phoneSchema","z","string","min","regex","credentialsSchema","object","email","optional","phone","password","tenant_id","uuid","facility_id","refine","value","Boolean","message","path","passthrough","authPayloadSchema","parseCredentials","exports","parse","parseAuthPayload"],"sources":["auth.rules.js"],"sourcesContent":["/**\r\n * Auth Rules\r\n * Validation for auth payloads\r\n * File: auth.rules.js\r\n */\r\nimport { z } from 'zod';\r\n\r\nconst phoneSchema = z.string().min(10).regex(/^[0-9]+$/);\r\n\r\nconst credentialsSchema = z\r\n  .object({\r\n    email: z.string().email().optional(),\r\n    phone: phoneSchema.optional(),\r\n    password: z.string().min(1),\r\n    tenant_id: z.string().uuid().optional(),\r\n    facility_id: z.string().uuid().optional(),\r\n  })\r\n  .refine((value) => Boolean(value.email || value.phone), {\r\n    message: 'identifier_required',\r\n    path: ['email'],\r\n  })\r\n  .passthrough();\r\n\r\nconst authPayloadSchema = z.object({}).passthrough();\r\n\r\nconst parseCredentials = (value) => credentialsSchema.parse(value ?? {});\r\nconst parseAuthPayload = (value) => authPayloadSchema.parse(value ?? {});\r\n\r\nexport { parseCredentials, parseAuthPayload };\r\n"],"mappings":";;;;AAKA,IAAAA,IAAA,GAAAC,OAAA;AAEA,IAAMC,WAAW,GAAGC,MAAC,CAACC,MAAM,CAAC,CAAC,CAACC,GAAG,CAAC,EAAE,CAAC,CAACC,KAAK,CAAC,UAAU,CAAC;AAExD,IAAMC,iBAAiB,GAAGJ,MAAC,CACxBK,MAAM,CAAC;EACNC,KAAK,EAAEN,MAAC,CAACC,MAAM,CAAC,CAAC,CAACK,KAAK,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC;EACpCC,KAAK,EAAET,WAAW,CAACQ,QAAQ,CAAC,CAAC;EAC7BE,QAAQ,EAAET,MAAC,CAACC,MAAM,CAAC,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC;EAC3BQ,SAAS,EAAEV,MAAC,CAACC,MAAM,CAAC,CAAC,CAACU,IAAI,CAAC,CAAC,CAACJ,QAAQ,CAAC,CAAC;EACvCK,WAAW,EAAEZ,MAAC,CAACC,MAAM,CAAC,CAAC,CAACU,IAAI,CAAC,CAAC,CAACJ,QAAQ,CAAC;AAC1C,CAAC,CAAC,CACDM,MAAM,CAAC,UAACC,KAAK;EAAA,OAAKC,OAAO,CAACD,KAAK,CAACR,KAAK,IAAIQ,KAAK,CAACN,KAAK,CAAC;AAAA,GAAE;EACtDQ,OAAO,EAAE,qBAAqB;EAC9BC,IAAI,EAAE,CAAC,OAAO;AAChB,CAAC,CAAC,CACDC,WAAW,CAAC,CAAC;AAEhB,IAAMC,iBAAiB,GAAGnB,MAAC,CAACK,MAAM,CAAC,CAAC,CAAC,CAAC,CAACa,WAAW,CAAC,CAAC;AAEpD,IAAME,gBAAgB,GAAAC,OAAA,CAAAD,gBAAA,GAAG,SAAnBA,gBAAgBA,CAAIN,KAAK;EAAA,OAAKV,iBAAiB,CAACkB,KAAK,CAACR,KAAK,WAALA,KAAK,GAAI,CAAC,CAAC,CAAC;AAAA;AACxE,IAAMS,gBAAgB,GAAAF,OAAA,CAAAE,gBAAA,GAAG,SAAnBA,gBAAgBA,CAAIT,KAAK;EAAA,OAAKK,iBAAiB,CAACG,KAAK,CAACR,KAAK,WAALA,KAAK,GAAI,CAAC,CAAC,CAAC;AAAA","ignoreList":[]}