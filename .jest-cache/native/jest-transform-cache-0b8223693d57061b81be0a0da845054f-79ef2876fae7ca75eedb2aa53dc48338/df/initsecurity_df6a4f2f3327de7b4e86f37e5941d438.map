{"version":3,"names":["tokenManager","logger","initSecurity","_initSecurity","apply","arguments","_asyncToGenerator","cov_2chneqhtuy","f","s","accessToken","getAccessToken","refreshToken","getRefreshToken","b","isExpired","isTokenExpired","info","error","message"],"sources":["init.security.js"],"sourcesContent":["/**\r\n * Security Initialization\r\n * File: init.security.js\r\n */\r\nimport { tokenManager } from '@security';\r\nimport { logger } from '@logging';\r\n\r\nexport async function initSecurity() {\r\n  try {\r\n    // Check if tokens exist and are valid\r\n    const accessToken = await tokenManager.getAccessToken();\r\n    const refreshToken = await tokenManager.getRefreshToken();\r\n    \r\n    if (accessToken) {\r\n      const isExpired = tokenManager.isTokenExpired(accessToken);\r\n      if (isExpired && refreshToken) {\r\n        logger.info('Access token expired, refresh token available');\r\n      } else if (isExpired) {\r\n        logger.info('Tokens expired, user will need to re-authenticate');\r\n      } else {\r\n        logger.info('Valid session found on startup');\r\n      }\r\n    } else {\r\n      logger.info('No session found on startup');\r\n    }\r\n    \r\n    // Initialize encryption keys (if needed)\r\n    // Encryption keys are initialized lazily when needed\r\n    \r\n    logger.info('Security initialized successfully');\r\n  } catch (error) {\r\n    // Security failures must not crash app, but should be logged\r\n    logger.error('Security initialization failed', { error: error.message });\r\n    // Don't throw - allow app to continue, but security features may be limited\r\n  }\r\n}\r\n\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA,SAASA,YAAY;AACrB,SAASC,MAAM;AAEf,gBAAsBC,YAAYA,CAAA;EAAA,OAAAC,aAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AA4BjC,SAAAF,cAAA;EAAAA,aAAA,GAAAG,iBAAA,CA5BM,aAA8B;IAAAC,cAAA,GAAAC,CAAA;IAAAD,cAAA,GAAAE,CAAA;IACnC,IAAI;MAEF,IAAMC,WAAW,IAAAH,cAAA,GAAAE,CAAA,aAAST,YAAY,CAACW,cAAc,CAAC,CAAC;MACvD,IAAMC,YAAY,IAAAL,cAAA,GAAAE,CAAA,aAAST,YAAY,CAACa,eAAe,CAAC,CAAC;MAACN,cAAA,GAAAE,CAAA;MAE1D,IAAIC,WAAW,EAAE;QAAAH,cAAA,GAAAO,CAAA;QACf,IAAMC,SAAS,IAAAR,cAAA,GAAAE,CAAA,OAAGT,YAAY,CAACgB,cAAc,CAACN,WAAW,CAAC;QAACH,cAAA,GAAAE,CAAA;QAC3D,IAAI,CAAAF,cAAA,GAAAO,CAAA,UAAAC,SAAS,MAAAR,cAAA,GAAAO,CAAA,UAAIF,YAAY,GAAE;UAAAL,cAAA,GAAAO,CAAA;UAAAP,cAAA,GAAAE,CAAA;UAC7BR,MAAM,CAACgB,IAAI,CAAC,+CAA+C,CAAC;QAC9D,CAAC,MAAM;UAAAV,cAAA,GAAAO,CAAA;UAAAP,cAAA,GAAAE,CAAA;UAAA,IAAIM,SAAS,EAAE;YAAAR,cAAA,GAAAO,CAAA;YAAAP,cAAA,GAAAE,CAAA;YACpBR,MAAM,CAACgB,IAAI,CAAC,mDAAmD,CAAC;UAClE,CAAC,MAAM;YAAAV,cAAA,GAAAO,CAAA;YAAAP,cAAA,GAAAE,CAAA;YACLR,MAAM,CAACgB,IAAI,CAAC,gCAAgC,CAAC;UAC/C;QAAA;MACF,CAAC,MAAM;QAAAV,cAAA,GAAAO,CAAA;QAAAP,cAAA,GAAAE,CAAA;QACLR,MAAM,CAACgB,IAAI,CAAC,6BAA6B,CAAC;MAC5C;MAACV,cAAA,GAAAE,CAAA;MAKDR,MAAM,CAACgB,IAAI,CAAC,mCAAmC,CAAC;IAClD,CAAC,CAAC,OAAOC,KAAK,EAAE;MAAAX,cAAA,GAAAE,CAAA;MAEdR,MAAM,CAACiB,KAAK,CAAC,gCAAgC,EAAE;QAAEA,KAAK,EAAEA,KAAK,CAACC;MAAQ,CAAC,CAAC;IAE1E;EACF,CAAC;EAAA,OAAAhB,aAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA","ignoreList":[]}