4f5849d3fa0da1d2c77472f1d479324e
import _asyncToGenerator from "@babel/runtime/helpers/asyncToGenerator";
function cov_2chneqhtuy() {
  var path = "D:\\coding\\apps\\hms\\hms-frontend\\src\\bootstrap\\init.security.js";
  var hash = "2f7d59183bba9705e5b3bdd29caa0bec0c1dfbf6";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "D:\\coding\\apps\\hms\\hms-frontend\\src\\bootstrap\\init.security.js",
    statementMap: {
      "0": {
        start: {
          line: 9,
          column: 2
        },
        end: {
          line: 35,
          column: 3
        }
      },
      "1": {
        start: {
          line: 11,
          column: 24
        },
        end: {
          line: 11,
          column: 59
        }
      },
      "2": {
        start: {
          line: 12,
          column: 25
        },
        end: {
          line: 12,
          column: 61
        }
      },
      "3": {
        start: {
          line: 14,
          column: 4
        },
        end: {
          line: 25,
          column: 5
        }
      },
      "4": {
        start: {
          line: 15,
          column: 24
        },
        end: {
          line: 15,
          column: 64
        }
      },
      "5": {
        start: {
          line: 16,
          column: 6
        },
        end: {
          line: 22,
          column: 7
        }
      },
      "6": {
        start: {
          line: 17,
          column: 8
        },
        end: {
          line: 17,
          column: 69
        }
      },
      "7": {
        start: {
          line: 18,
          column: 13
        },
        end: {
          line: 22,
          column: 7
        }
      },
      "8": {
        start: {
          line: 19,
          column: 8
        },
        end: {
          line: 19,
          column: 73
        }
      },
      "9": {
        start: {
          line: 21,
          column: 8
        },
        end: {
          line: 21,
          column: 54
        }
      },
      "10": {
        start: {
          line: 24,
          column: 6
        },
        end: {
          line: 24,
          column: 49
        }
      },
      "11": {
        start: {
          line: 30,
          column: 4
        },
        end: {
          line: 30,
          column: 53
        }
      },
      "12": {
        start: {
          line: 33,
          column: 4
        },
        end: {
          line: 33,
          column: 77
        }
      }
    },
    fnMap: {
      "0": {
        name: "initSecurity",
        decl: {
          start: {
            line: 8,
            column: 22
          },
          end: {
            line: 8,
            column: 34
          }
        },
        loc: {
          start: {
            line: 8,
            column: 37
          },
          end: {
            line: 36,
            column: 1
          }
        },
        line: 8
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 14,
            column: 4
          },
          end: {
            line: 25,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 14,
            column: 4
          },
          end: {
            line: 25,
            column: 5
          }
        }, {
          start: {
            line: 23,
            column: 11
          },
          end: {
            line: 25,
            column: 5
          }
        }],
        line: 14
      },
      "1": {
        loc: {
          start: {
            line: 16,
            column: 6
          },
          end: {
            line: 22,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 16,
            column: 6
          },
          end: {
            line: 22,
            column: 7
          }
        }, {
          start: {
            line: 18,
            column: 13
          },
          end: {
            line: 22,
            column: 7
          }
        }],
        line: 16
      },
      "2": {
        loc: {
          start: {
            line: 16,
            column: 10
          },
          end: {
            line: 16,
            column: 35
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 16,
            column: 10
          },
          end: {
            line: 16,
            column: 19
          }
        }, {
          start: {
            line: 16,
            column: 23
          },
          end: {
            line: 16,
            column: 35
          }
        }],
        line: 16
      },
      "3": {
        loc: {
          start: {
            line: 18,
            column: 13
          },
          end: {
            line: 22,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 18,
            column: 13
          },
          end: {
            line: 22,
            column: 7
          }
        }, {
          start: {
            line: 20,
            column: 13
          },
          end: {
            line: 22,
            column: 7
          }
        }],
        line: 18
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0
    },
    f: {
      "0": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "2f7d59183bba9705e5b3bdd29caa0bec0c1dfbf6"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    cov_2chneqhtuy = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2chneqhtuy();
import { tokenManager } from "../security";
import { logger } from "../logging";
export function initSecurity() {
  return _initSecurity.apply(this, arguments);
}
function _initSecurity() {
  _initSecurity = _asyncToGenerator(function* () {
    cov_2chneqhtuy().f[0]++;
    cov_2chneqhtuy().s[0]++;
    try {
      var accessToken = (cov_2chneqhtuy().s[1]++, yield tokenManager.getAccessToken());
      var refreshToken = (cov_2chneqhtuy().s[2]++, yield tokenManager.getRefreshToken());
      cov_2chneqhtuy().s[3]++;
      if (accessToken) {
        cov_2chneqhtuy().b[0][0]++;
        var isExpired = (cov_2chneqhtuy().s[4]++, tokenManager.isTokenExpired(accessToken));
        cov_2chneqhtuy().s[5]++;
        if ((cov_2chneqhtuy().b[2][0]++, isExpired) && (cov_2chneqhtuy().b[2][1]++, refreshToken)) {
          cov_2chneqhtuy().b[1][0]++;
          cov_2chneqhtuy().s[6]++;
          logger.info('Access token expired, refresh token available');
        } else {
          cov_2chneqhtuy().b[1][1]++;
          cov_2chneqhtuy().s[7]++;
          if (isExpired) {
            cov_2chneqhtuy().b[3][0]++;
            cov_2chneqhtuy().s[8]++;
            logger.info('Tokens expired, user will need to re-authenticate');
          } else {
            cov_2chneqhtuy().b[3][1]++;
            cov_2chneqhtuy().s[9]++;
            logger.info('Valid session found on startup');
          }
        }
      } else {
        cov_2chneqhtuy().b[0][1]++;
        cov_2chneqhtuy().s[10]++;
        logger.info('No session found on startup');
      }
      cov_2chneqhtuy().s[11]++;
      logger.info('Security initialized successfully');
    } catch (error) {
      cov_2chneqhtuy().s[12]++;
      logger.error('Security initialization failed', {
        error: error.message
      });
    }
  });
  return _initSecurity.apply(this, arguments);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ0b2tlbk1hbmFnZXIiLCJsb2dnZXIiLCJpbml0U2VjdXJpdHkiLCJfaW5pdFNlY3VyaXR5IiwiYXBwbHkiLCJhcmd1bWVudHMiLCJfYXN5bmNUb0dlbmVyYXRvciIsImNvdl8yY2huZXFodHV5IiwiZiIsInMiLCJhY2Nlc3NUb2tlbiIsImdldEFjY2Vzc1Rva2VuIiwicmVmcmVzaFRva2VuIiwiZ2V0UmVmcmVzaFRva2VuIiwiYiIsImlzRXhwaXJlZCIsImlzVG9rZW5FeHBpcmVkIiwiaW5mbyIsImVycm9yIiwibWVzc2FnZSJdLCJzb3VyY2VzIjpbImluaXQuc2VjdXJpdHkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFNlY3VyaXR5IEluaXRpYWxpemF0aW9uXHJcbiAqIEZpbGU6IGluaXQuc2VjdXJpdHkuanNcclxuICovXHJcbmltcG9ydCB7IHRva2VuTWFuYWdlciB9IGZyb20gJ0BzZWN1cml0eSc7XHJcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0Bsb2dnaW5nJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbml0U2VjdXJpdHkoKSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIENoZWNrIGlmIHRva2VucyBleGlzdCBhbmQgYXJlIHZhbGlkXHJcbiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IHRva2VuTWFuYWdlci5nZXRBY2Nlc3NUb2tlbigpO1xyXG4gICAgY29uc3QgcmVmcmVzaFRva2VuID0gYXdhaXQgdG9rZW5NYW5hZ2VyLmdldFJlZnJlc2hUb2tlbigpO1xyXG4gICAgXHJcbiAgICBpZiAoYWNjZXNzVG9rZW4pIHtcclxuICAgICAgY29uc3QgaXNFeHBpcmVkID0gdG9rZW5NYW5hZ2VyLmlzVG9rZW5FeHBpcmVkKGFjY2Vzc1Rva2VuKTtcclxuICAgICAgaWYgKGlzRXhwaXJlZCAmJiByZWZyZXNoVG9rZW4pIHtcclxuICAgICAgICBsb2dnZXIuaW5mbygnQWNjZXNzIHRva2VuIGV4cGlyZWQsIHJlZnJlc2ggdG9rZW4gYXZhaWxhYmxlJyk7XHJcbiAgICAgIH0gZWxzZSBpZiAoaXNFeHBpcmVkKSB7XHJcbiAgICAgICAgbG9nZ2VyLmluZm8oJ1Rva2VucyBleHBpcmVkLCB1c2VyIHdpbGwgbmVlZCB0byByZS1hdXRoZW50aWNhdGUnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBsb2dnZXIuaW5mbygnVmFsaWQgc2Vzc2lvbiBmb3VuZCBvbiBzdGFydHVwJyk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxvZ2dlci5pbmZvKCdObyBzZXNzaW9uIGZvdW5kIG9uIHN0YXJ0dXAnKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSW5pdGlhbGl6ZSBlbmNyeXB0aW9uIGtleXMgKGlmIG5lZWRlZClcclxuICAgIC8vIEVuY3J5cHRpb24ga2V5cyBhcmUgaW5pdGlhbGl6ZWQgbGF6aWx5IHdoZW4gbmVlZGVkXHJcbiAgICBcclxuICAgIGxvZ2dlci5pbmZvKCdTZWN1cml0eSBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHknKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgLy8gU2VjdXJpdHkgZmFpbHVyZXMgbXVzdCBub3QgY3Jhc2ggYXBwLCBidXQgc2hvdWxkIGJlIGxvZ2dlZFxyXG4gICAgbG9nZ2VyLmVycm9yKCdTZWN1cml0eSBpbml0aWFsaXphdGlvbiBmYWlsZWQnLCB7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgLy8gRG9uJ3QgdGhyb3cgLSBhbGxvdyBhcHAgdG8gY29udGludWUsIGJ1dCBzZWN1cml0eSBmZWF0dXJlcyBtYXkgYmUgbGltaXRlZFxyXG4gIH1cclxufVxyXG5cclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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