{"version":3,"names":["useState","useCallback","useEffect","useRef","cov_21ym5ekk2u","s","useImage","_ref","source","fallback","onLoad","onError","f","_ref2","_ref3","_slicedToArray","isLoading","setIsLoading","_ref4","_ref5","hasError","setHasError","_ref6","_ref7","currentSource","setCurrentSource","currentSourceRef","fallbackRef","onErrorRef","current","b","handleLoad","event","handleError","prevSource","prevSourceStr","uri","fallbackStr"],"sources":["useImage.js"],"sourcesContent":["/**\r\n * Image Hook\r\n * Shared logic for Image component (loading, error handling)\r\n * File: useImage.js\r\n */\r\nimport { useState, useCallback, useEffect, useRef } from 'react';\r\n\r\n/**\r\n * Custom hook for Image component logic\r\n * @param {Object} props - Image props\r\n * @param {string|Object} props.source - Image source URI (string or {uri: string})\r\n * @param {string|Object} props.fallback - Fallback image source\r\n * @param {Function} props.onLoad - Load handler\r\n * @param {Function} props.onError - Error handler\r\n * @returns {Object} Image state and handlers\r\n */\r\nconst useImage = ({ source, fallback, onLoad, onError }) => {\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [hasError, setHasError] = useState(false);\r\n  const [currentSource, setCurrentSource] = useState(source);\r\n  const currentSourceRef = useRef(source);\r\n  const fallbackRef = useRef(fallback);\r\n  const onErrorRef = useRef(onError);\r\n\r\n  // Update refs when props change\r\n  useEffect(() => {\r\n    fallbackRef.current = fallback;\r\n    onErrorRef.current = onError;\r\n  }, [fallback, onError]);\r\n\r\n  // Update currentSource when source prop changes\r\n  useEffect(() => {\r\n    if (source !== currentSourceRef.current) {\r\n      currentSourceRef.current = source;\r\n      setCurrentSource(source);\r\n      setIsLoading(true);\r\n      setHasError(false);\r\n    }\r\n  }, [source]);\r\n\r\n  const handleLoad = useCallback(\r\n    (event) => {\r\n      setIsLoading(false);\r\n      setHasError(false);\r\n      if (onLoad) {\r\n        onLoad(event);\r\n      }\r\n    },\r\n    [onLoad]\r\n  );\r\n\r\n  const handleError = useCallback(\r\n    (event) => {\r\n      setIsLoading(false);\r\n      // Normalize sources for comparison (handle both string and object formats)\r\n      const prevSource = currentSourceRef.current;\r\n      const prevSourceStr = typeof prevSource === 'string' ? prevSource : prevSource?.uri;\r\n      const fallback = fallbackRef.current;\r\n      const fallbackStr = typeof fallback === 'string' ? fallback : fallback?.uri;\r\n      \r\n      if (fallback && prevSourceStr !== fallbackStr) {\r\n        // Switch to fallback synchronously\r\n        currentSourceRef.current = fallback;\r\n        setCurrentSource(fallback);\r\n        setHasError(false);\r\n        setIsLoading(true);\r\n        if (onErrorRef.current) {\r\n          onErrorRef.current(event);\r\n        }\r\n      } else {\r\n        setHasError(true);\r\n        if (onErrorRef.current) {\r\n          onErrorRef.current(event);\r\n        }\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  return {\r\n    isLoading,\r\n    hasError,\r\n    currentSource,\r\n    handleLoad,\r\n    handleError,\r\n  };\r\n};\r\n\r\nexport default useImage;\r\n\r\n"],"mappings":"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","ignoreList":[]}