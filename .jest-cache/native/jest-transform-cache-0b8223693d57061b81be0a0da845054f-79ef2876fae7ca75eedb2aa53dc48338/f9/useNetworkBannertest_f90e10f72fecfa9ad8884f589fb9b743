f09537f5f03f91a868aba51aee8a3888
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _react = _interopRequireDefault(require("react"));
var _reactNative = require("@testing-library/react-native");
var _reactRedux = require("react-redux");
var _toolkit = require("@reduxjs/toolkit");
var _useNetworkBanner = _interopRequireDefault(require("../../hooks/useNetworkBanner"));
var _rootReducer = _interopRequireDefault(require("../../store/rootReducer"));
var _network = require("../../store/slices/network.slice");
var _jsxRuntime = require("react/jsx-runtime");
var createMockStore = function createMockStore() {
  var preloadedState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  return (0, _toolkit.configureStore)({
    reducer: _rootReducer.default,
    preloadedState: preloadedState
  });
};
var TestComponent = function TestComponent(_ref) {
  var onResult = _ref.onResult,
    duration = _ref.duration;
  var result = (0, _useNetworkBanner.default)({
    duration: duration
  });
  _react.default.useEffect(function () {
    onResult(result);
  });
  return null;
};
describe('useNetworkBanner', function () {
  beforeEach(function () {
    jest.useFakeTimers();
  });
  afterEach(function () {
    jest.runOnlyPendingTimers();
    jest.useRealTimers();
  });
  it('shows online banner after reconnect and hides it', (0, _asyncToGenerator2.default)(function* () {
    var store = createMockStore({
      network: {
        isOnline: false,
        isSyncing: false
      }
    });
    var result;
    (0, _reactNative.render)((0, _jsxRuntime.jsx)(_reactRedux.Provider, {
      store: store,
      children: (0, _jsxRuntime.jsx)(TestComponent, {
        duration: 2000,
        onResult: function onResult(value) {
          return result = value;
        }
      })
    }));
    yield (0, _reactNative.waitFor)(function () {
      expect(result.isOffline).toBe(true);
      expect(result.showOnlineBanner).toBe(false);
    });
    (0, _reactNative.act)(function () {
      store.dispatch(_network.actions.setOnline(true));
    });
    yield (0, _reactNative.waitFor)(function () {
      expect(result.isOnline).toBe(true);
      expect(result.showOnlineBanner).toBe(true);
    });
    (0, _reactNative.act)(function () {
      jest.advanceTimersByTime(2000);
    });
    yield (0, _reactNative.waitFor)(function () {
      expect(result.showOnlineBanner).toBe(false);
    });
  }));
  it('clears online banner when offline', (0, _asyncToGenerator2.default)(function* () {
    var store = createMockStore({
      network: {
        isOnline: true,
        isSyncing: false
      }
    });
    var result;
    (0, _reactNative.render)((0, _jsxRuntime.jsx)(_reactRedux.Provider, {
      store: store,
      children: (0, _jsxRuntime.jsx)(TestComponent, {
        duration: 1000,
        onResult: function onResult(value) {
          return result = value;
        }
      })
    }));
    yield (0, _reactNative.waitFor)(function () {
      expect(result.isOnline).toBe(true);
      expect(result.showOnlineBanner).toBe(false);
    });
    (0, _reactNative.act)(function () {
      store.dispatch(_network.actions.setOnline(false));
    });
    yield (0, _reactNative.waitFor)(function () {
      expect(result.isOffline).toBe(true);
      expect(result.showOnlineBanner).toBe(false);
    });
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9yZWFjdE5hdGl2ZSIsIl9yZWFjdFJlZHV4IiwiX3Rvb2xraXQiLCJfdXNlTmV0d29ya0Jhbm5lciIsIl9yb290UmVkdWNlciIsIl9uZXR3b3JrIiwiX2pzeFJ1bnRpbWUiLCJjcmVhdGVNb2NrU3RvcmUiLCJwcmVsb2FkZWRTdGF0ZSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImNvbmZpZ3VyZVN0b3JlIiwicmVkdWNlciIsInJvb3RSZWR1Y2VyIiwiVGVzdENvbXBvbmVudCIsIl9yZWYiLCJvblJlc3VsdCIsImR1cmF0aW9uIiwicmVzdWx0IiwidXNlTmV0d29ya0Jhbm5lciIsIlJlYWN0IiwidXNlRWZmZWN0IiwiZGVzY3JpYmUiLCJiZWZvcmVFYWNoIiwiamVzdCIsInVzZUZha2VUaW1lcnMiLCJhZnRlckVhY2giLCJydW5Pbmx5UGVuZGluZ1RpbWVycyIsInVzZVJlYWxUaW1lcnMiLCJpdCIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImRlZmF1bHQiLCJzdG9yZSIsIm5ldHdvcmsiLCJpc09ubGluZSIsImlzU3luY2luZyIsInJlbmRlciIsImpzeCIsIlByb3ZpZGVyIiwiY2hpbGRyZW4iLCJ2YWx1ZSIsIndhaXRGb3IiLCJleHBlY3QiLCJpc09mZmxpbmUiLCJ0b0JlIiwic2hvd09ubGluZUJhbm5lciIsImFjdCIsImRpc3BhdGNoIiwibmV0d29ya0FjdGlvbnMiLCJzZXRPbmxpbmUiLCJhZHZhbmNlVGltZXJzQnlUaW1lIl0sInNvdXJjZXMiOlsidXNlTmV0d29ya0Jhbm5lci50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiB1c2VOZXR3b3JrQmFubmVyIEhvb2sgVGVzdHNcclxuICogRmlsZTogdXNlTmV0d29ya0Jhbm5lci50ZXN0LmpzXHJcbiAqL1xyXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBhY3QsIHJlbmRlciwgd2FpdEZvciB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QtbmF0aXZlJztcclxuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tICdyZWFjdC1yZWR1eCc7XHJcbmltcG9ydCB7IGNvbmZpZ3VyZVN0b3JlIH0gZnJvbSAnQHJlZHV4anMvdG9vbGtpdCc7XHJcbmltcG9ydCB1c2VOZXR3b3JrQmFubmVyIGZyb20gJ0Bob29rcy91c2VOZXR3b3JrQmFubmVyJztcclxuaW1wb3J0IHJvb3RSZWR1Y2VyIGZyb20gJ0BzdG9yZS9yb290UmVkdWNlcic7XHJcbmltcG9ydCB7IGFjdGlvbnMgYXMgbmV0d29ya0FjdGlvbnMgfSBmcm9tICdAc3RvcmUvc2xpY2VzL25ldHdvcmsuc2xpY2UnO1xyXG5cclxuY29uc3QgY3JlYXRlTW9ja1N0b3JlID0gKHByZWxvYWRlZFN0YXRlID0ge30pID0+XHJcbiAgY29uZmlndXJlU3RvcmUoe1xyXG4gICAgcmVkdWNlcjogcm9vdFJlZHVjZXIsXHJcbiAgICBwcmVsb2FkZWRTdGF0ZSxcclxuICB9KTtcclxuXHJcbmNvbnN0IFRlc3RDb21wb25lbnQgPSAoeyBvblJlc3VsdCwgZHVyYXRpb24gfSkgPT4ge1xyXG4gIGNvbnN0IHJlc3VsdCA9IHVzZU5ldHdvcmtCYW5uZXIoeyBkdXJhdGlvbiB9KTtcclxuXHJcbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcclxuICAgIG9uUmVzdWx0KHJlc3VsdCk7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBudWxsO1xyXG59O1xyXG5cclxuZGVzY3JpYmUoJ3VzZU5ldHdvcmtCYW5uZXInLCAoKSA9PiB7XHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICBqZXN0LnVzZUZha2VUaW1lcnMoKTtcclxuICB9KTtcclxuXHJcbiAgYWZ0ZXJFYWNoKCgpID0+IHtcclxuICAgIGplc3QucnVuT25seVBlbmRpbmdUaW1lcnMoKTtcclxuICAgIGplc3QudXNlUmVhbFRpbWVycygpO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnc2hvd3Mgb25saW5lIGJhbm5lciBhZnRlciByZWNvbm5lY3QgYW5kIGhpZGVzIGl0JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3Qgc3RvcmUgPSBjcmVhdGVNb2NrU3RvcmUoe1xyXG4gICAgICBuZXR3b3JrOiB7IGlzT25saW5lOiBmYWxzZSwgaXNTeW5jaW5nOiBmYWxzZSB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IHJlc3VsdDtcclxuICAgIHJlbmRlcihcclxuICAgICAgPFByb3ZpZGVyIHN0b3JlPXtzdG9yZX0+XHJcbiAgICAgICAgPFRlc3RDb21wb25lbnQgZHVyYXRpb249ezIwMDB9IG9uUmVzdWx0PXsodmFsdWUpID0+IChyZXN1bHQgPSB2YWx1ZSl9IC8+XHJcbiAgICAgIDwvUHJvdmlkZXI+XHJcbiAgICApO1xyXG5cclxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICBleHBlY3QocmVzdWx0LmlzT2ZmbGluZSkudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5zaG93T25saW5lQmFubmVyKS50b0JlKGZhbHNlKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGFjdCgoKSA9PiB7XHJcbiAgICAgIHN0b3JlLmRpc3BhdGNoKG5ldHdvcmtBY3Rpb25zLnNldE9ubGluZSh0cnVlKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5pc09ubGluZSkudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5zaG93T25saW5lQmFubmVyKS50b0JlKHRydWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYWN0KCgpID0+IHtcclxuICAgICAgamVzdC5hZHZhbmNlVGltZXJzQnlUaW1lKDIwMDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQuc2hvd09ubGluZUJhbm5lcikudG9CZShmYWxzZSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ2NsZWFycyBvbmxpbmUgYmFubmVyIHdoZW4gb2ZmbGluZScsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IHN0b3JlID0gY3JlYXRlTW9ja1N0b3JlKHtcclxuICAgICAgbmV0d29yazogeyBpc09ubGluZTogdHJ1ZSwgaXNTeW5jaW5nOiBmYWxzZSB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IHJlc3VsdDtcclxuICAgIHJlbmRlcihcclxuICAgICAgPFByb3ZpZGVyIHN0b3JlPXtzdG9yZX0+XHJcbiAgICAgICAgPFRlc3RDb21wb25lbnQgZHVyYXRpb249ezEwMDB9IG9uUmVzdWx0PXsodmFsdWUpID0+IChyZXN1bHQgPSB2YWx1ZSl9IC8+XHJcbiAgICAgIDwvUHJvdmlkZXI+XHJcbiAgICApO1xyXG5cclxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICBleHBlY3QocmVzdWx0LmlzT25saW5lKS50b0JlKHRydWUpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnNob3dPbmxpbmVCYW5uZXIpLnRvQmUoZmFsc2UpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYWN0KCgpID0+IHtcclxuICAgICAgc3RvcmUuZGlzcGF0Y2gobmV0d29ya0FjdGlvbnMuc2V0T25saW5lKGZhbHNlKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5pc09mZmxpbmUpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQuc2hvd09ubGluZUJhbm5lcikudG9CZShmYWxzZSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7XHJcbiJdLCJtYXBwaW5ncyI6Ijs7QUFJQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxZQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxXQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxRQUFB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