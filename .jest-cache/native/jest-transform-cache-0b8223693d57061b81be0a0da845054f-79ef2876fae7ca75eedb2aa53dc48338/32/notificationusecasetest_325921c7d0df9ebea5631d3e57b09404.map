{"version":3,"names":["_getJestObj","mock","notificationApi","list","jest","fn","get","markNotificationReadApi","markNotificationUnreadApi","getNotificationTargetsApi","getNotificationPreferencesApi","updateNotificationPreferencesApi","queueRequestIfOffline","_interopRequireDefault","require","default","_asyncToGenerator2","_notification","_notification2","_request","_crudUsecaseRunner","_require","describe","beforeEach","mockResolvedValue","data","id","read","runCrudUsecaseTests","listNotifications","getNotification","extraActions","listNotificationTargets","getNotificationPreferences","it","expect","markNotificationRead","resolves","toEqual","markNotificationUnread","payload","channel","updateNotificationPreferences"],"sources":["notification.usecase.test.js"],"sourcesContent":["/**\r\n * Notification Usecase Tests\r\n * File: notification.usecase.test.js\r\n */\r\nimport {\r\n  getNotification,\r\n  getNotificationPreferences,\r\n  listNotifications,\r\n  listNotificationTargets,\r\n  markNotificationRead,\r\n  markNotificationUnread,\r\n  updateNotificationPreferences,\r\n} from '@features/notification';\r\nimport {\r\n  getNotificationPreferencesApi,\r\n  getNotificationTargetsApi,\r\n  markNotificationReadApi,\r\n  markNotificationUnreadApi,\r\n  notificationApi,\r\n  updateNotificationPreferencesApi,\r\n} from '@features/notification/notification.api';\r\nimport { queueRequestIfOffline } from '@offline/request';\r\nimport { runCrudUsecaseTests } from '../../helpers/crud-usecase-runner';\r\n\r\njest.mock('@features/notification/notification.api', () => ({\r\n  notificationApi: {\r\n    list: jest.fn(),\r\n    get: jest.fn(),\r\n  },\r\n  markNotificationReadApi: jest.fn(),\r\n  markNotificationUnreadApi: jest.fn(),\r\n  getNotificationTargetsApi: jest.fn(),\r\n  getNotificationPreferencesApi: jest.fn(),\r\n  updateNotificationPreferencesApi: jest.fn(),\r\n}));\r\n\r\njest.mock('@offline/request', () => ({\r\n  queueRequestIfOffline: jest.fn(),\r\n}));\r\n\r\ndescribe('notification.usecase', () => {\r\n  beforeEach(() => {\r\n    notificationApi.list.mockResolvedValue({ data: [{ id: '1' }] });\r\n    notificationApi.get.mockResolvedValue({ data: { id: '1' } });\r\n    markNotificationReadApi.mockResolvedValue({ data: { id: '1', read: true } });\r\n    markNotificationUnreadApi.mockResolvedValue({ data: { id: '1', read: false } });\r\n    getNotificationTargetsApi.mockResolvedValue({ data: [{ id: 't1' }] });\r\n    getNotificationPreferencesApi.mockResolvedValue({ data: { id: 'prefs' } });\r\n    updateNotificationPreferencesApi.mockResolvedValue({ data: { id: 'prefs' } });\r\n  });\r\n\r\n  runCrudUsecaseTests(\r\n    {\r\n      list: listNotifications,\r\n      get: getNotification,\r\n      extraActions: [\r\n        { fn: listNotificationTargets },\r\n        { fn: getNotificationPreferences },\r\n      ],\r\n    },\r\n    { queueRequestIfOffline }\r\n  );\r\n\r\n  it('marks notifications read/unread online', async () => {\r\n    queueRequestIfOffline.mockResolvedValue(false);\r\n    await expect(markNotificationRead('1')).resolves.toEqual({ id: '1', read: true });\r\n    await expect(markNotificationUnread('1')).resolves.toEqual({ id: '1', read: false });\r\n  });\r\n\r\n  it('queues notification read/unread updates', async () => {\r\n    queueRequestIfOffline.mockResolvedValue(true);\r\n    await expect(markNotificationRead('1')).resolves.toEqual({ id: '1', read: true });\r\n    await expect(markNotificationUnread('1')).resolves.toEqual({ id: '1', read: false });\r\n  });\r\n\r\n  it('updates notification preferences online', async () => {\r\n    const payload = { channel: 'email' };\r\n    queueRequestIfOffline.mockResolvedValue(false);\r\n    await expect(updateNotificationPreferences(payload)).resolves.toEqual({ id: 'prefs' });\r\n  });\r\n\r\n  it('queues notification preferences updates', async () => {\r\n    const payload = { channel: 'sms' };\r\n    queueRequestIfOffline.mockResolvedValue(true);\r\n    await expect(updateNotificationPreferences(payload)).resolves.toEqual(payload);\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}