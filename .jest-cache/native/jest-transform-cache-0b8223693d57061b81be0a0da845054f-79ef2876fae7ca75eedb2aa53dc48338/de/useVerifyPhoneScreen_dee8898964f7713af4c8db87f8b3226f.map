{"version":3,"names":["useCallback","useMemo","useState","useRouter","useAuth","useI18n","useNetwork","normalizePhoneNumber","cov_23xruqhz7a","s","resolveErrorMessage","t","errorCode","f","b","key","resolved","useVerifyPhoneScreen","_ref","router","_ref2","isOffline","_ref3","verifyPhone","clearError","isLoading","_ref4","_ref5","_slicedToArray","token","setToken","_ref6","_ref7","phone","setPhone","_ref8","_ref9","isSubmitted","setIsSubmitted","errorMessage","canSubmit","Boolean","handleSubmit","_asyncToGenerator","result","trim","succeeded","error","handleChangeToken","value","handleChangePhone","handleGoToLogin","push"],"sources":["useVerifyPhoneScreen.js"],"sourcesContent":["/**\r\n * useVerifyPhoneScreen Hook\r\n * Shared behavior/logic for VerifyPhoneScreen across all platforms.\r\n * File: useVerifyPhoneScreen.js\r\n */\r\nimport { useCallback, useMemo, useState } from 'react';\r\nimport { useRouter } from 'expo-router';\r\nimport { useAuth, useI18n, useNetwork } from '@hooks';\r\nimport { normalizePhoneNumber } from '@utils';\r\n\r\nconst resolveErrorMessage = (t, errorCode) => {\r\n  if (!errorCode) return null;\r\n  const key = `errors.codes.${errorCode}`;\r\n  const resolved = t(key);\r\n  return resolved === key ? t('errors.codes.UNKNOWN_ERROR') : resolved;\r\n};\r\n\r\nconst useVerifyPhoneScreen = () => {\r\n  const { t } = useI18n();\r\n  const router = useRouter();\r\n  const { isOffline } = useNetwork();\r\n  const { verifyPhone, clearError, isLoading, errorCode } = useAuth();\r\n  const [token, setToken] = useState('');\r\n  const [phone, setPhone] = useState('');\r\n  const [isSubmitted, setIsSubmitted] = useState(false);\r\n\r\n  const errorMessage = useMemo(\r\n    () => resolveErrorMessage(t, errorCode),\r\n    [errorCode, t]\r\n  );\r\n\r\n  const canSubmit = useMemo(\r\n    () => Boolean(token && phone) && !isLoading && !isOffline,\r\n    [isLoading, isOffline, phone, token]\r\n  );\r\n\r\n  const handleSubmit = useCallback(async () => {\r\n    if (!canSubmit) return false;\r\n    clearError();\r\n    const result = await verifyPhone({\r\n      token: token.trim(),\r\n      phone: normalizePhoneNumber(phone),\r\n    });\r\n    const succeeded = !result?.error;\r\n    if (succeeded) {\r\n      setIsSubmitted(true);\r\n    }\r\n    return succeeded;\r\n  }, [canSubmit, clearError, phone, token, verifyPhone]);\r\n\r\n  const handleChangeToken = useCallback((value) => {\r\n    setToken(value);\r\n    setIsSubmitted(false);\r\n  }, []);\r\n\r\n  const handleChangePhone = useCallback((value) => {\r\n    setPhone(value);\r\n    setIsSubmitted(false);\r\n  }, []);\r\n\r\n  const handleGoToLogin = useCallback(() => {\r\n    router.push('/login');\r\n  }, [router]);\r\n\r\n  return {\r\n    token,\r\n    phone,\r\n    isSubmitted,\r\n    errorMessage,\r\n    isLoading,\r\n    isOffline,\r\n    canSubmit,\r\n    handleSubmit,\r\n    handleChangeToken,\r\n    handleChangePhone,\r\n    handleGoToLogin,\r\n  };\r\n};\r\n\r\nexport default useVerifyPhoneScreen;\r\n\r\n"],"mappings":"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","ignoreList":[]}