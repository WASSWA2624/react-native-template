{"version":3,"names":["React","useEffect","useState","Provider","PersistGate","ActivityIndicator","Slot","ErrorBoundary","I18nProvider","bootstrapApp","logger","store","StyledLoadingContainer","StyledActivityIndicator","ThemeProviderWrapper","jsx","_jsx","cov_287irkw6dz","s","RootLayout","f","_ref","_ref2","_slicedToArray","isBootstrapReady","setIsBootstrapReady","_ref3","_ref4","bootstrapError","setBootstrapError","initializeApp","_ref5","_asyncToGenerator","error","message","stack","apply","arguments","b","children","size","loading","persistor"],"sources":["_layout.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Provider } from 'react-redux';\r\nimport { PersistGate } from 'redux-persist/integration/react';\r\nimport { ActivityIndicator } from 'react-native';\r\nimport { Slot } from 'expo-router';\r\nimport { ErrorBoundary } from '@errors';\r\nimport { I18nProvider } from '@i18n';\r\nimport { bootstrapApp } from '@bootstrap';\r\nimport { logger } from '@logging';\r\nimport store from '@store';\r\nimport { StyledLoadingContainer, StyledActivityIndicator } from '@platform/layouts/common/RootLayoutStyles';\r\nimport ThemeProviderWrapper from '@platform/layouts/common/ThemeProviderWrapper';\r\n\r\n/**\r\n * Root Layout Component\r\n * \r\n * This is the root layout for Expo App Router.\r\n * All providers will be added here in subsequent steps.\r\n * \r\n * Per app-router.mdc: Root layout responsibilities (providers/startup wiring)\r\n * are defined in bootstrap-config.mdc.\r\n * \r\n * Per bootstrap-config.mdc: ErrorBoundary is mounted only in root layout.\r\n * Per errors-logging.mdc: ErrorBoundary catches render/runtime errors and displays fallback UI.\r\n * \r\n * Per bootstrap-config.mdc: Redux Provider mounted only in root layout.\r\n * Per state-management.mdc: Store access patterns via Provider.\r\n * \r\n * Per bootstrap-config.mdc: ThemeProvider mounted only in root layout.\r\n * Per theme-design.mdc: Theme consumption via styled-components.\r\n * \r\n * Per bootstrap-config.mdc: Localization Provider mounted only in root layout.\r\n * Per i18n.mdc: i18n provider/registry, locale handling.\r\n * \r\n * Per bootstrap-config.mdc: Bootstrap runs in correct order (security → store → theme → offline)\r\n * before rendering providers. Bootstrap errors are handled gracefully per bootstrap-config.mdc.\r\n * \r\n * Note: Expo Router root layout uses <Slot /> to render child routes, not {children}\r\n */\r\nconst RootLayout = () => {\r\n  const [isBootstrapReady, setIsBootstrapReady] = useState(false);\r\n  const [bootstrapError, setBootstrapError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    /**\r\n     * Initialize app systems in correct order per bootstrap-config.mdc:\r\n     * 1. Security (protects everything)\r\n     * 2. Store (required by most layers)\r\n     * 3. Theme (required by UI)\r\n     * 4. Offline (depends on store and services)\r\n     */\r\n    const initializeApp = async () => {\r\n      try {\r\n        await bootstrapApp();\r\n        setIsBootstrapReady(true);\r\n      } catch (error) {\r\n        // Per bootstrap-config.mdc: Fatal errors must block rendering\r\n        // Non-fatal errors must be logged\r\n        // Per errors-logging.mdc: Log errors via logger\r\n        logger.error('Bootstrap initialization failed', {\r\n          error: error.message,\r\n          stack: error.stack,\r\n        });\r\n        \r\n        // Store error to block rendering (fatal error)\r\n        setBootstrapError(error);\r\n        \r\n        // Note: ErrorBoundary will catch if this causes a render error\r\n        // For now, we'll log and set error state to prevent rendering\r\n      }\r\n    };\r\n\r\n    initializeApp();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  // Per bootstrap-config.mdc: Fatal errors must block rendering\r\n  if (bootstrapError) {\r\n    // ErrorBoundary will handle this, but we prevent rendering providers\r\n    // until bootstrap succeeds\r\n    return (\r\n      <ErrorBoundary>\r\n        <StyledLoadingContainer>\r\n          <StyledActivityIndicator size=\"large\" />\r\n        </StyledLoadingContainer>\r\n      </ErrorBoundary>\r\n    );\r\n  }\r\n\r\n  // Per bootstrap-config.mdc: Add loading state while bootstrap completes\r\n  if (!isBootstrapReady) {\r\n    return (\r\n      <ErrorBoundary>\r\n        <StyledLoadingContainer>\r\n          <StyledActivityIndicator size=\"large\" />\r\n        </StyledLoadingContainer>\r\n      </ErrorBoundary>\r\n    );\r\n  }\r\n\r\n  // Bootstrap completed successfully, render providers\r\n  return (\r\n    <ErrorBoundary>\r\n      <Provider store={store}>\r\n        <PersistGate\r\n          loading={\r\n            <StyledLoadingContainer>\r\n              <StyledActivityIndicator size=\"large\" />\r\n            </StyledLoadingContainer>\r\n          }\r\n          persistor={store.persistor}\r\n        >\r\n          <ThemeProviderWrapper>\r\n            <I18nProvider>\r\n              <Slot />\r\n            </I18nProvider>\r\n          </ThemeProviderWrapper>\r\n        </PersistGate>\r\n      </Provider>\r\n    </ErrorBoundary>\r\n  );\r\n};\r\n\r\nexport default RootLayout;\r\n\r\n"],"mappings":"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","ignoreList":[]}