6b965de5e069e1c8686f9c175d6f67d6
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getImageSourcesFromImageProps = getImageSourcesFromImageProps;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _resolveAssetSource = _interopRequireDefault(require("./resolveAssetSource"));
function getImageSourcesFromImageProps(imageProps) {
  var source = (0, _resolveAssetSource.default)(imageProps.source);
  var sources;
  var crossOrigin = imageProps.crossOrigin,
    referrerPolicy = imageProps.referrerPolicy,
    src = imageProps.src,
    srcSet = imageProps.srcSet,
    width = imageProps.width,
    height = imageProps.height;
  var headers = {};
  if (crossOrigin === 'use-credentials') {
    headers['Access-Control-Allow-Credentials'] = 'true';
  }
  if (referrerPolicy != null) {
    headers['Referrer-Policy'] = referrerPolicy;
  }
  if (srcSet != null) {
    var sourceList = [];
    var srcSetList = srcSet.split(', ');
    var shouldUseSrcForDefaultScale = true;
    srcSetList.forEach(function (imageSrc) {
      var _imageSrc$split = imageSrc.split(' '),
        _imageSrc$split2 = (0, _slicedToArray2.default)(_imageSrc$split, 2),
        uri = _imageSrc$split2[0],
        _imageSrc$split2$ = _imageSrc$split2[1],
        xScale = _imageSrc$split2$ === void 0 ? '1x' : _imageSrc$split2$;
      if (!xScale.endsWith('x')) {
        console.warn('The provided format for scale is not supported yet. Please use scales like 1x, 2x, etc.');
      } else {
        var scale = parseInt(xScale.split('x')[0], 10);
        if (!isNaN(scale)) {
          shouldUseSrcForDefaultScale = scale === 1 ? false : shouldUseSrcForDefaultScale;
          sourceList.push({
            headers: headers,
            scale: scale,
            uri: uri,
            width: width,
            height: height
          });
        }
      }
    });
    if (shouldUseSrcForDefaultScale && src != null) {
      sourceList.push({
        headers: headers,
        scale: 1,
        uri: src,
        width: width,
        height: height
      });
    }
    if (sourceList.length === 0) {
      console.warn('The provided value for srcSet is not valid.');
    }
    sources = sourceList;
  } else if (src != null) {
    sources = [{
      uri: src,
      headers: headers,
      width: width,
      height: height
    }];
  } else if (source != null && source.uri && Object.keys(headers).length > 0) {
    sources = [Object.assign({}, source, {
      headers: headers
    })];
  } else {
    sources = source;
  }
  return sources;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImRlZmF1bHQiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImdldEltYWdlU291cmNlc0Zyb21JbWFnZVByb3BzIiwiX3NsaWNlZFRvQXJyYXkyIiwiX3Jlc29sdmVBc3NldFNvdXJjZSIsImltYWdlUHJvcHMiLCJzb3VyY2UiLCJyZXNvbHZlQXNzZXRTb3VyY2UiLCJzb3VyY2VzIiwiY3Jvc3NPcmlnaW4iLCJyZWZlcnJlclBvbGljeSIsInNyYyIsInNyY1NldCIsIndpZHRoIiwiaGVpZ2h0IiwiaGVhZGVycyIsInNvdXJjZUxpc3QiLCJzcmNTZXRMaXN0Iiwic3BsaXQiLCJzaG91bGRVc2VTcmNGb3JEZWZhdWx0U2NhbGUiLCJmb3JFYWNoIiwiaW1hZ2VTcmMiLCJfaW1hZ2VTcmMkc3BsaXQiLCJfaW1hZ2VTcmMkc3BsaXQyIiwidXJpIiwiX2ltYWdlU3JjJHNwbGl0MiQiLCJ4U2NhbGUiLCJlbmRzV2l0aCIsImNvbnNvbGUiLCJ3YXJuIiwic2NhbGUiLCJwYXJzZUludCIsImlzTmFOIiwicHVzaCIsImxlbmd0aCIsImtleXMiLCJhc3NpZ24iXSwic291cmNlcyI6WyJJbWFnZVNvdXJjZVV0aWxzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBNZXRhIFBsYXRmb3JtcywgSW5jLiBhbmQgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvdyBzdHJpY3QtbG9jYWxcbiAqIEBmb3JtYXRcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCB0eXBlIHtSZXNvbHZlZEFzc2V0U291cmNlfSBmcm9tICcuL0Fzc2V0U291cmNlUmVzb2x2ZXInO1xuaW1wb3J0IHR5cGUge0ltYWdlUHJvcHN9IGZyb20gJy4vSW1hZ2VQcm9wcyc7XG5cbmltcG9ydCByZXNvbHZlQXNzZXRTb3VyY2UgZnJvbSAnLi9yZXNvbHZlQXNzZXRTb3VyY2UnO1xuXG4vKipcbiAqIEEgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyB0aGUgYXBwcm9wcmlhdGUgdmFsdWUgZm9yIGltYWdlIHNvdXJjZVxuICogYnkgcmVzb2x2aW5nIHRoZSBgc291cmNlYCwgYHNyY2AgYW5kIGBzcmNTZXRgIHByb3BzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0SW1hZ2VTb3VyY2VzRnJvbUltYWdlUHJvcHMoXG4gIGltYWdlUHJvcHM6IEltYWdlUHJvcHMsXG4pOiA/UmVzb2x2ZWRBc3NldFNvdXJjZSB8ICRSZWFkT25seUFycmF5PHt1cmk6IHN0cmluZywgLi4ufT4ge1xuICBsZXQgc291cmNlID0gcmVzb2x2ZUFzc2V0U291cmNlKGltYWdlUHJvcHMuc291cmNlKTtcblxuICBsZXQgc291cmNlcztcblxuICBjb25zdCB7Y3Jvc3NPcmlnaW4sIHJlZmVycmVyUG9saWN5LCBzcmMsIHNyY1NldCwgd2lkdGgsIGhlaWdodH0gPSBpbWFnZVByb3BzO1xuXG4gIGNvbnN0IGhlYWRlcnM6IHtbc3RyaW5nXTogc3RyaW5nfSA9IHt9O1xuICBpZiAoY3Jvc3NPcmlnaW4gPT09ICd1c2UtY3JlZGVudGlhbHMnKSB7XG4gICAgaGVhZGVyc1snQWNjZXNzLUNvbnRyb2wtQWxsb3ctQ3JlZGVudGlhbHMnXSA9ICd0cnVlJztcbiAgfVxuICBpZiAocmVmZXJyZXJQb2xpY3kgIT0gbnVsbCkge1xuICAgIGhlYWRlcnNbJ1JlZmVycmVyLVBvbGljeSddID0gcmVmZXJyZXJQb2xpY3k7XG4gIH1cbiAgaWYgKHNyY1NldCAhPSBudWxsKSB7XG4gICAgY29uc3Qgc291cmNlTGlzdCA9IFtdO1xuICAgIGNvbnN0IHNyY1NldExpc3QgPSBzcmNTZXQuc3BsaXQoJywgJyk7XG4gICAgLy8gYHNyY2AgcHJvcCBzaG91bGQgYmUgdXNlZCB3aXRoIGRlZmF1bHQgc2NhbGUgaWYgYHNyY1NldGAgZG9lcyBub3QgaGF2ZSAxeCBzY2FsZS5cbiAgICBsZXQgc2hvdWxkVXNlU3JjRm9yRGVmYXVsdFNjYWxlID0gdHJ1ZTtcbiAgICBzcmNTZXRMaXN0LmZvckVhY2goaW1hZ2VTcmMgPT4ge1xuICAgICAgY29uc3QgW3VyaSwgeFNjYWxlID0gJzF4J10gPSBpbWFnZVNyYy5zcGxpdCgnICcpO1xuICAgICAgaWYgKCF4U2NhbGUuZW5kc1dpdGgoJ3gnKSkge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgJ1RoZSBwcm92aWRlZCBmb3JtYXQgZm9yIHNjYWxlIGlzIG5vdCBzdXBwb3J0ZWQgeWV0LiBQbGVhc2UgdXNlIHNjYWxlcyBsaWtlIDF4LCAyeCwgZXRjLicsXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBzY2FsZSA9IHBhcnNlSW50KHhTY2FsZS5zcGxpdCgneCcpWzBdLCAxMCk7XG4gICAgICAgIGlmICghaXNOYU4oc2NhbGUpKSB7XG4gICAgICAgICAgLy8gMXggc2NhbGUgaXMgcHJvdmlkZWQgaW4gYHNyY1NldGAgcHJvcCBzbyBpZ25vcmUgdGhlIGBzcmNgIHByb3AgaWYgcHJvdmlkZWQuXG4gICAgICAgICAgc2hvdWxkVXNlU3JjRm9yRGVmYXVsdFNjYWxlID1cbiAgICAgICAgICAgIHNjYWxlID09PSAxID8gZmFsc2UgOiBzaG91bGRVc2VTcmNGb3JEZWZhdWx0U2NhbGU7XG4gICAgICAgICAgc291cmNlTGlzdC5wdXNoKHtoZWFkZXJzLCBzY2FsZSwgdXJpLCB3aWR0aCwgaGVpZ2h0fSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChzaG91bGRVc2VTcmNGb3JEZWZhdWx0U2NhbGUgJiYgc3JjICE9IG51bGwpIHtcbiAgICAgIHNvdXJjZUxpc3QucHVzaCh7XG4gICAgICAgIGhlYWRlcnMsXG4gICAgICAgIHNjYWxlOiAxLFxuICAgICAgICB1cmk6IHNyYyxcbiAgICAgICAgd2lkdGgsXG4gICAgICAgIGhlaWdodCxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoc291cmNlTGlzdC5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnNvbGUud2FybignVGhlIHByb3ZpZGVkIHZhbHVlIGZvciBzcmNTZXQgaXMgbm90IHZhbGlkLicpO1xuICAgIH1cblxuICAgIHNvdXJjZXMgPSBzb3VyY2VMaXN0O1xuICB9IGVsc2UgaWYgKHNyYyAhPSBudWxsKSB7XG4gICAgc291cmNlcyA9IFt7dXJpOiBzcmMsIGhlYWRlcnM6IGhlYWRlcnMsIHdpZHRoLCBoZWlnaHR9XTtcbiAgfSBlbHNlIGlmIChzb3VyY2UgIT0gbnVsbCAmJiBzb3VyY2UudXJpICYmIE9iamVjdC5rZXlzKGhlYWRlcnMpLmxlbmd0aCA+IDApIHtcbiAgICBzb3VyY2VzID0gW3suLi5zb3VyY2UsIGhlYWRlcnN9XTtcbiAgfSBlbHNlIHtcbiAgICBzb3VyY2VzID0gc291cmNlO1xuICB9XG4gIHJldHVybiBzb3VyY2VzO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFVQSxZQUFZOztBQUFDLElBQUFBLHNCQUFBLEdBQUFDLE9BQUEsaURBQUFDLE9BQUE7QUFBQUMsTUFBQSxDQUFBQyxjQUFBLENBQUFDLE9BQUE7RUFBQUMsS0FBQTtBQUFBO0FBQUFELE9BQUEsQ0FBQUUsNkJBQUEsR0FBQUEsNkJBQUE7QUFBQSxJQUFBQyxlQUFBLEdBQUFSLHNCQUFBLENBQUFDLE9BQUE7QUFLYixJQUFBUSxtQkFBQSxHQUFBVCxzQkFBQSxDQUFBQyxPQUFBO0FBTU8sU0FBU00sNkJBQTZCQSxDQUMzQ0csVUFBc0IsRUFDcUM7RUFDM0QsSUFBSUMsTUFBTSxHQUFHLElBQUFDLDJCQUFrQixFQUFDRixVQUFVLENBQUNDLE1BQU0sQ0FBQztFQUVsRCxJQUFJRSxPQUFPO0VBRVgsSUFBT0MsV0FBVyxHQUFnREosVUFBVSxDQUFyRUksV0FBVztJQUFFQyxjQUFjLEdBQWdDTCxVQUFVLENBQXhESyxjQUFjO0lBQUVDLEdBQUcsR0FBMkJOLFVBQVUsQ0FBeENNLEdBQUc7SUFBRUMsTUFBTSxHQUFtQlAsVUFBVSxDQUFuQ08sTUFBTTtJQUFFQyxLQUFLLEdBQVlSLFVBQVUsQ0FBM0JRLEtBQUs7SUFBRUMsTUFBTSxHQUFJVCxVQUFVLENBQXBCUyxNQUFNO0VBRTlELElBQU1DLE9BQTJCLEdBQUcsQ0FBQyxDQUFDO0VBQ3RDLElBQUlOLFdBQVcsS0FBSyxpQkFBaUIsRUFBRTtJQUNyQ00sT0FBTyxDQUFDLGtDQUFrQyxDQUFDLEdBQUcsTUFBTTtFQUN0RDtFQUNBLElBQUlMLGNBQWMsSUFBSSxJQUFJLEVBQUU7SUFDMUJLLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHTCxjQUFjO0VBQzdDO0VBQ0EsSUFBSUUsTUFBTSxJQUFJLElBQUksRUFBRTtJQUNsQixJQUFNSSxVQUFVLEdBQUcsRUFBRTtJQUNyQixJQUFNQyxVQUFVLEdBQUdMLE1BQU0sQ0FBQ00sS0FBSyxDQUFDLElBQUksQ0FBQztJQUVyQyxJQUFJQywyQkFBMkIsR0FBRyxJQUFJO0lBQ3RDRixVQUFVLENBQUNHLE9BQU8sQ0FBQyxVQUFBQyxRQUFRLEVBQUk7TUFDN0IsSUFBQUMsZUFBQSxHQUE2QkQsUUFBUSxDQUFDSCxLQUFLLENBQUMsR0FBRyxDQUFDO1FBQUFLLGdCQUFBLE9BQUFwQixlQUFBLENBQUFOLE9BQUEsRUFBQXlCLGVBQUE7UUFBekNFLEdBQUcsR0FBQUQsZ0JBQUE7UUFBQUUsaUJBQUEsR0FBQUYsZ0JBQUE7UUFBRUcsTUFBTSxHQUFBRCxpQkFBQSxjQUFHLElBQUksR0FBQUEsaUJBQUE7TUFDekIsSUFBSSxDQUFDQyxNQUFNLENBQUNDLFFBQVEsQ0FBQyxHQUFHLENBQUMsRUFBRTtRQUN6QkMsT0FBTyxDQUFDQyxJQUFJLENBQ1YseUZBQ0YsQ0FBQztNQUNILENBQUMsTUFBTTtRQUNMLElBQU1DLEtBQUssR0FBR0MsUUFBUSxDQUFDTCxNQUFNLENBQUNSLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDaEQsSUFBSSxDQUFDYyxLQUFLLENBQUNGLEtBQUssQ0FBQyxFQUFFO1VBRWpCWCwyQkFBMkIsR0FDekJXLEtBQUssS0FBSyxDQUFDLEdBQUcsS0FBSyxHQUFHWCwyQkFBMkI7VUFDbkRILFVBQVUsQ0FBQ2lCLElBQUksQ0FBQztZQUFDbEIsT0FBTyxFQUFQQSxPQUFPO1lBQUVlLEtBQUssRUFBTEEsS0FBSztZQUFFTixHQUFHLEVBQUhBLEdBQUc7WUFBRVgsS0FBSyxFQUFMQSxLQUFLO1lBQUVDLE1BQU0sRUFBTkE7VUFBTSxDQUFDLENBQUM7UUFDdkQ7TUFDRjtJQUNGLENBQUMsQ0FBQztJQUVGLElBQUlLLDJCQUEyQixJQUFJUixHQUFHLElBQUksSUFBSSxFQUFFO01BQzlDSyxVQUFVLENBQUNpQixJQUFJLENBQUM7UUFDZGxCLE9BQU8sRUFBUEEsT0FBTztRQUNQZSxLQUFLLEVBQUUsQ0FBQztRQUNSTixHQUFHLEVBQUViLEdBQUc7UUFDUkUsS0FBSyxFQUFMQSxLQUFLO1FBQ0xDLE1BQU0sRUFBTkE7TUFDRixDQUFDLENBQUM7SUFDSjtJQUNBLElBQUlFLFVBQVUsQ0FBQ2tCLE1BQU0sS0FBSyxDQUFDLEVBQUU7TUFDM0JOLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLDZDQUE2QyxDQUFDO0lBQzdEO0lBRUFyQixPQUFPLEdBQUdRLFVBQVU7RUFDdEIsQ0FBQyxNQUFNLElBQUlMLEdBQUcsSUFBSSxJQUFJLEVBQUU7SUFDdEJILE9BQU8sR0FBRyxDQUFDO01BQUNnQixHQUFHLEVBQUViLEdBQUc7TUFBRUksT0FBTyxFQUFFQSxPQUFPO01BQUVGLEtBQUssRUFBTEEsS0FBSztNQUFFQyxNQUFNLEVBQU5BO0lBQU0sQ0FBQyxDQUFDO0VBQ3pELENBQUMsTUFBTSxJQUFJUixNQUFNLElBQUksSUFBSSxJQUFJQSxNQUFNLENBQUNrQixHQUFHLElBQUkxQixNQUFNLENBQUNxQyxJQUFJLENBQUNwQixPQUFPLENBQUMsQ0FBQ21CLE1BQU0sR0FBRyxDQUFDLEVBQUU7SUFDMUUxQixPQUFPLEdBQUcsQ0FBQVYsTUFBQSxDQUFBc0MsTUFBQSxLQUFLOUIsTUFBTTtNQUFFUyxPQUFPLEVBQVBBO0lBQU8sR0FBRTtFQUNsQyxDQUFDLE1BQU07SUFDTFAsT0FBTyxHQUFHRixNQUFNO0VBQ2xCO0VBQ0EsT0FBT0UsT0FBTztBQUNoQiIsImlnbm9yZUxpc3QiOltdfQ==