e74997b808e3cd4e17fc2ddc03865ac2
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var ReactNativeFeatureFlags = _interopRequireWildcard(require("../../src/private/featureflags/ReactNativeFeatureFlags"));
var _EventEmitter = _interopRequireDefault(require("../vendor/emitter/EventEmitter"));
var BatchedBridge = require("../BatchedBridge/BatchedBridge").default;
var TaskQueue = require("./TaskQueue").default;
var invariant = require('invariant');
var _emitter = new _EventEmitter.default();
var DEBUG_DELAY = 0;
var DEBUG = false;
var InteractionManagerImpl = {
  Events: {
    interactionStart: 'interactionStart',
    interactionComplete: 'interactionComplete'
  },
  runAfterInteractions: function runAfterInteractions(task) {
    var tasks = [];
    var promise = new Promise(function (resolve) {
      _scheduleUpdate();
      if (task) {
        tasks.push(task);
      }
      tasks.push({
        run: resolve,
        name: 'resolve ' + (task && task.name || '?')
      });
      _taskQueue.enqueueTasks(tasks);
    });
    return {
      then: promise.then.bind(promise),
      cancel: function cancel() {
        _taskQueue.cancelTasks(tasks);
      }
    };
  },
  createInteractionHandle: function createInteractionHandle() {
    DEBUG && console.log('InteractionManager: create interaction handle');
    _scheduleUpdate();
    var handle = ++_inc;
    _addInteractionSet.add(handle);
    return handle;
  },
  clearInteractionHandle: function clearInteractionHandle(handle) {
    DEBUG && console.log('InteractionManager: clear interaction handle');
    invariant(!!handle, 'InteractionManager: Must provide a handle to clear.');
    _scheduleUpdate();
    _addInteractionSet.delete(handle);
    _deleteInteractionSet.add(handle);
  },
  addListener: _emitter.addListener.bind(_emitter),
  setDeadline: function setDeadline(deadline) {
    _deadline = deadline;
  }
};
var _interactionSet = new Set();
var _addInteractionSet = new Set();
var _deleteInteractionSet = new Set();
var _taskQueue = new TaskQueue({
  onMoreTasks: _scheduleUpdate
});
var _nextUpdateHandle = 0;
var _inc = 0;
var _deadline = -1;
function _scheduleUpdate() {
  if (!_nextUpdateHandle) {
    if (_deadline > 0) {
      _nextUpdateHandle = setTimeout(_processUpdate, 0 + DEBUG_DELAY);
    } else {
      _nextUpdateHandle = setImmediate(_processUpdate);
    }
  }
}
function _processUpdate() {
  _nextUpdateHandle = 0;
  var interactionCount = _interactionSet.size;
  _addInteractionSet.forEach(function (handle) {
    return _interactionSet.add(handle);
  });
  _deleteInteractionSet.forEach(function (handle) {
    return _interactionSet.delete(handle);
  });
  var nextInteractionCount = _interactionSet.size;
  if (interactionCount !== 0 && nextInteractionCount === 0) {
    _emitter.emit(InteractionManager.Events.interactionComplete);
  } else if (interactionCount === 0 && nextInteractionCount !== 0) {
    _emitter.emit(InteractionManager.Events.interactionStart);
  }
  if (nextInteractionCount === 0) {
    while (_taskQueue.hasTasksToProcess()) {
      _taskQueue.processNext();
      if (_deadline > 0 && BatchedBridge.getEventLoopRunningTime() >= _deadline) {
        _scheduleUpdate();
        break;
      }
    }
  }
  _addInteractionSet.clear();
  _deleteInteractionSet.clear();
}
var InteractionManager = ReactNativeFeatureFlags.disableInteractionManager() ? require("./InteractionManagerStub").default : InteractionManagerImpl;
var _default = exports.default = InteractionManager;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZWFjdE5hdGl2ZUZlYXR1cmVGbGFncyIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwicmVxdWlyZSIsIl9FdmVudEVtaXR0ZXIiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiQmF0Y2hlZEJyaWRnZSIsImRlZmF1bHQiLCJUYXNrUXVldWUiLCJpbnZhcmlhbnQiLCJfZW1pdHRlciIsIkV2ZW50RW1pdHRlciIsIkRFQlVHX0RFTEFZIiwiREVCVUciLCJJbnRlcmFjdGlvbk1hbmFnZXJJbXBsIiwiRXZlbnRzIiwiaW50ZXJhY3Rpb25TdGFydCIsImludGVyYWN0aW9uQ29tcGxldGUiLCJydW5BZnRlckludGVyYWN0aW9ucyIsInRhc2siLCJ0YXNrcyIsInByb21pc2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsIl9zY2hlZHVsZVVwZGF0ZSIsInB1c2giLCJydW4iLCJuYW1lIiwiX3Rhc2tRdWV1ZSIsImVucXVldWVUYXNrcyIsInRoZW4iLCJiaW5kIiwiY2FuY2VsIiwiY2FuY2VsVGFza3MiLCJjcmVhdGVJbnRlcmFjdGlvbkhhbmRsZSIsImNvbnNvbGUiLCJsb2ciLCJoYW5kbGUiLCJfaW5jIiwiX2FkZEludGVyYWN0aW9uU2V0IiwiYWRkIiwiY2xlYXJJbnRlcmFjdGlvbkhhbmRsZSIsImRlbGV0ZSIsIl9kZWxldGVJbnRlcmFjdGlvblNldCIsImFkZExpc3RlbmVyIiwic2V0RGVhZGxpbmUiLCJkZWFkbGluZSIsIl9kZWFkbGluZSIsIl9pbnRlcmFjdGlvblNldCIsIlNldCIsIm9uTW9yZVRhc2tzIiwiX25leHRVcGRhdGVIYW5kbGUiLCJzZXRUaW1lb3V0IiwiX3Byb2Nlc3NVcGRhdGUiLCJzZXRJbW1lZGlhdGUiLCJpbnRlcmFjdGlvbkNvdW50Iiwic2l6ZSIsImZvckVhY2giLCJuZXh0SW50ZXJhY3Rpb25Db3VudCIsImVtaXQiLCJJbnRlcmFjdGlvbk1hbmFnZXIiLCJoYXNUYXNrc1RvUHJvY2VzcyIsInByb2Nlc3NOZXh0IiwiZ2V0RXZlbnRMb29wUnVubmluZ1RpbWUiLCJjbGVhciIsImRpc2FibGVJbnRlcmFjdGlvbk1hbmFnZXIiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyJJbnRlcmFjdGlvbk1hbmFnZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIE1ldGEgUGxhdGZvcm1zLCBJbmMuIGFuZCBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93IHN0cmljdC1sb2NhbFxuICogQGZvcm1hdFxuICovXG5cbmltcG9ydCB0eXBlIHtFdmVudFN1YnNjcmlwdGlvbn0gZnJvbSAnLi4vdmVuZG9yL2VtaXR0ZXIvRXZlbnRFbWl0dGVyJztcbmltcG9ydCB0eXBlIHtUYXNrfSBmcm9tICcuL1Rhc2tRdWV1ZSc7XG5cbmltcG9ydCAqIGFzIFJlYWN0TmF0aXZlRmVhdHVyZUZsYWdzIGZyb20gJy4uLy4uL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncyc7XG5pbXBvcnQgRXZlbnRFbWl0dGVyIGZyb20gJy4uL3ZlbmRvci9lbWl0dGVyL0V2ZW50RW1pdHRlcic7XG5cbmNvbnN0IEJhdGNoZWRCcmlkZ2UgPSByZXF1aXJlKCcuLi9CYXRjaGVkQnJpZGdlL0JhdGNoZWRCcmlkZ2UnKS5kZWZhdWx0O1xuY29uc3QgVGFza1F1ZXVlID0gcmVxdWlyZSgnLi9UYXNrUXVldWUnKS5kZWZhdWx0O1xuY29uc3QgaW52YXJpYW50ID0gcmVxdWlyZSgnaW52YXJpYW50Jyk7XG5cbmV4cG9ydCB0eXBlIHtUYXNrLCBTaW1wbGVUYXNrLCBQcm9taXNlVGFza30gZnJvbSAnLi9UYXNrUXVldWUnO1xuXG5leHBvcnQgdHlwZSBIYW5kbGUgPSBudW1iZXI7XG5cbmNvbnN0IF9lbWl0dGVyID0gbmV3IEV2ZW50RW1pdHRlcjx7XG4gIGludGVyYWN0aW9uQ29tcGxldGU6IFtdLFxuICBpbnRlcmFjdGlvblN0YXJ0OiBbXSxcbn0+KCk7XG5cbmNvbnN0IERFQlVHX0RFTEFZOiAwID0gMDtcbmNvbnN0IERFQlVHOiBmYWxzZSA9IGZhbHNlO1xuXG5jb25zdCBJbnRlcmFjdGlvbk1hbmFnZXJJbXBsID0ge1xuICBFdmVudHM6IHtcbiAgICBpbnRlcmFjdGlvblN0YXJ0OiAnaW50ZXJhY3Rpb25TdGFydCcsXG4gICAgaW50ZXJhY3Rpb25Db21wbGV0ZTogJ2ludGVyYWN0aW9uQ29tcGxldGUnLFxuICB9LFxuXG4gIC8qKlxuICAgKiBTY2hlZHVsZSBhIGZ1bmN0aW9uIHRvIHJ1biBhZnRlciBhbGwgaW50ZXJhY3Rpb25zIGhhdmUgY29tcGxldGVkLiBSZXR1cm5zIGEgY2FuY2VsbGFibGVcbiAgICogXCJwcm9taXNlXCIuXG4gICAqL1xuICBydW5BZnRlckludGVyYWN0aW9ucyh0YXNrOiA/VGFzayk6IHtcbiAgICB0aGVuOiA8VT4oXG4gICAgICBvbkZ1bGZpbGw/OiA/KHZvaWQpID0+ID8oUHJvbWlzZTxVPiB8IFUpLFxuICAgICAgb25SZWplY3Q/OiA/KGVycm9yOiBtaXhlZCkgPT4gPyhQcm9taXNlPFU+IHwgVSksXG4gICAgKSA9PiBQcm9taXNlPFU+LFxuICAgIGNhbmNlbDogKCkgPT4gdm9pZCxcbiAgICAuLi5cbiAgfSB7XG4gICAgY29uc3QgdGFza3M6IEFycmF5PFRhc2s+ID0gW107XG4gICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlOiAoKSA9PiB2b2lkKSA9PiB7XG4gICAgICBfc2NoZWR1bGVVcGRhdGUoKTtcbiAgICAgIGlmICh0YXNrKSB7XG4gICAgICAgIHRhc2tzLnB1c2godGFzayk7XG4gICAgICB9XG4gICAgICB0YXNrcy5wdXNoKHtcbiAgICAgICAgcnVuOiByZXNvbHZlLFxuICAgICAgICBuYW1lOiAncmVzb2x2ZSAnICsgKCh0YXNrICYmIHRhc2submFtZSkgfHwgJz8nKSxcbiAgICAgIH0pO1xuICAgICAgX3Rhc2tRdWV1ZS5lbnF1ZXVlVGFza3ModGFza3MpO1xuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICAvLyAkRmxvd0ZpeE1lW21ldGhvZC11bmJpbmRpbmddIGFkZGVkIHdoZW4gaW1wcm92aW5nIHR5cGluZyBmb3IgdGhpcyBwYXJhbWV0ZXJzXG4gICAgICB0aGVuOiBwcm9taXNlLnRoZW4uYmluZChwcm9taXNlKSxcbiAgICAgIGNhbmNlbDogZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGFza1F1ZXVlLmNhbmNlbFRhc2tzKHRhc2tzKTtcbiAgICAgIH0sXG4gICAgfTtcbiAgfSxcblxuICAvKipcbiAgICogTm90aWZ5IG1hbmFnZXIgdGhhdCBhbiBpbnRlcmFjdGlvbiBoYXMgc3RhcnRlZC5cbiAgICovXG4gIGNyZWF0ZUludGVyYWN0aW9uSGFuZGxlKCk6IEhhbmRsZSB7XG4gICAgREVCVUcgJiYgY29uc29sZS5sb2coJ0ludGVyYWN0aW9uTWFuYWdlcjogY3JlYXRlIGludGVyYWN0aW9uIGhhbmRsZScpO1xuICAgIF9zY2hlZHVsZVVwZGF0ZSgpO1xuICAgIGNvbnN0IGhhbmRsZSA9ICsrX2luYztcbiAgICBfYWRkSW50ZXJhY3Rpb25TZXQuYWRkKGhhbmRsZSk7XG4gICAgcmV0dXJuIGhhbmRsZTtcbiAgfSxcblxuICAvKipcbiAgICogTm90aWZ5IG1hbmFnZXIgdGhhdCBhbiBpbnRlcmFjdGlvbiBoYXMgY29tcGxldGVkLlxuICAgKi9cbiAgY2xlYXJJbnRlcmFjdGlvbkhhbmRsZShoYW5kbGU6IEhhbmRsZSkge1xuICAgIERFQlVHICYmIGNvbnNvbGUubG9nKCdJbnRlcmFjdGlvbk1hbmFnZXI6IGNsZWFyIGludGVyYWN0aW9uIGhhbmRsZScpO1xuICAgIGludmFyaWFudCghIWhhbmRsZSwgJ0ludGVyYWN0aW9uTWFuYWdlcjogTXVzdCBwcm92aWRlIGEgaGFuZGxlIHRvIGNsZWFyLicpO1xuICAgIF9zY2hlZHVsZVVwZGF0ZSgpO1xuICAgIF9hZGRJbnRlcmFjdGlvblNldC5kZWxldGUoaGFuZGxlKTtcbiAgICBfZGVsZXRlSW50ZXJhY3Rpb25TZXQuYWRkKGhhbmRsZSk7XG4gIH0sXG5cbiAgLy8gJEZsb3dGaXhNZVt1bmNsZWFyLXR5cGVdIHVuY2xlYXIgdHlwZSBvZiBfZW1pdHRlclxuICAvLyAkRmxvd0ZpeE1lW21ldGhvZC11bmJpbmRpbmddIGFkZGVkIHdoZW4gaW1wcm92aW5nIHR5cGluZyBmb3IgdGhpcyBwYXJhbWV0ZXJzXG4gIGFkZExpc3RlbmVyOiBfZW1pdHRlci5hZGRMaXN0ZW5lci5iaW5kKF9lbWl0dGVyKSBhcyAoXG4gICAgZXZlbnRUeXBlOiBzdHJpbmcsXG4gICAgLy8gJEZsb3dGaXhNZVt1bmNsZWFyLXR5cGVdIHVuY2xlYXIgdHlwZSBvZiBhcmd1bWVudHNcbiAgICBsaXN0ZW5lcjogKC4uLmFyZ3M6IGFueSkgPT4gbWl4ZWQsXG4gICAgY29udGV4dDogbWl4ZWQsXG4gICkgPT4gRXZlbnRTdWJzY3JpcHRpb24sXG5cbiAgLyoqXG4gICAqIEEgcG9zaXRpdmUgbnVtYmVyIHdpbGwgdXNlIHNldFRpbWVvdXQgdG8gc2NoZWR1bGUgYW55IHRhc2tzIGFmdGVyIHRoZVxuICAgKiBldmVudExvb3BSdW5uaW5nVGltZSBoaXRzIHRoZSBkZWFkbGluZSB2YWx1ZSwgb3RoZXJ3aXNlIGFsbCB0YXNrcyB3aWxsIGJlXG4gICAqIGV4ZWN1dGVkIGluIG9uZSBzZXRJbW1lZGlhdGUgYmF0Y2ggKGRlZmF1bHQpLlxuICAgKi9cbiAgc2V0RGVhZGxpbmUoZGVhZGxpbmU6IG51bWJlcikge1xuICAgIF9kZWFkbGluZSA9IGRlYWRsaW5lO1xuICB9LFxufTtcblxuY29uc3QgX2ludGVyYWN0aW9uU2V0ID0gbmV3IFNldDxudW1iZXIgfCBIYW5kbGU+KCk7XG5jb25zdCBfYWRkSW50ZXJhY3Rpb25TZXQgPSBuZXcgU2V0PG51bWJlciB8IEhhbmRsZT4oKTtcbmNvbnN0IF9kZWxldGVJbnRlcmFjdGlvblNldCA9IG5ldyBTZXQ8SGFuZGxlPigpO1xuY29uc3QgX3Rhc2tRdWV1ZSA9IG5ldyBUYXNrUXVldWUoe29uTW9yZVRhc2tzOiBfc2NoZWR1bGVVcGRhdGV9KTtcbmxldCBfbmV4dFVwZGF0ZUhhbmRsZTogJEZsb3dGaXhNZSB8IFRpbWVvdXRJRCA9IDA7XG5sZXQgX2luYyA9IDA7XG5sZXQgX2RlYWRsaW5lID0gLTE7XG5cbi8qKlxuICogU2NoZWR1bGUgYW4gYXN5bmNocm9ub3VzIHVwZGF0ZSB0byB0aGUgaW50ZXJhY3Rpb24gc3RhdGUuXG4gKi9cbmZ1bmN0aW9uIF9zY2hlZHVsZVVwZGF0ZSgpIHtcbiAgaWYgKCFfbmV4dFVwZGF0ZUhhbmRsZSkge1xuICAgIGlmIChfZGVhZGxpbmUgPiAwKSB7XG4gICAgICBfbmV4dFVwZGF0ZUhhbmRsZSA9IHNldFRpbWVvdXQoX3Byb2Nlc3NVcGRhdGUsIDAgKyBERUJVR19ERUxBWSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIF9uZXh0VXBkYXRlSGFuZGxlID0gc2V0SW1tZWRpYXRlKF9wcm9jZXNzVXBkYXRlKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBOb3RpZnkgbGlzdGVuZXJzLCBwcm9jZXNzIHF1ZXVlLCBldGNcbiAqL1xuZnVuY3Rpb24gX3Byb2Nlc3NVcGRhdGUoKSB7XG4gIF9uZXh0VXBkYXRlSGFuZGxlID0gMDtcblxuICBjb25zdCBpbnRlcmFjdGlvbkNvdW50ID0gX2ludGVyYWN0aW9uU2V0LnNpemU7XG4gIF9hZGRJbnRlcmFjdGlvblNldC5mb3JFYWNoKGhhbmRsZSA9PiBfaW50ZXJhY3Rpb25TZXQuYWRkKGhhbmRsZSkpO1xuICBfZGVsZXRlSW50ZXJhY3Rpb25TZXQuZm9yRWFjaChoYW5kbGUgPT4gX2ludGVyYWN0aW9uU2V0LmRlbGV0ZShoYW5kbGUpKTtcbiAgY29uc3QgbmV4dEludGVyYWN0aW9uQ291bnQgPSBfaW50ZXJhY3Rpb25TZXQuc2l6ZTtcblxuICBpZiAoaW50ZXJhY3Rpb25Db3VudCAhPT0gMCAmJiBuZXh0SW50ZXJhY3Rpb25Db3VudCA9PT0gMCkge1xuICAgIC8vIHRyYW5zaXRpb24gZnJvbSAxKyAtLT4gMCBpbnRlcmFjdGlvbnNcbiAgICAvKiAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ10gTmF0dXJhbCBJbmZlcmVuY2Ugcm9sbG91dC4gU2VlXG4gICAgICogaHR0cHM6Ly9mYnVybC5jb20vd29ya3BsYWNlLzYyOTFnZnZ1ICovXG4gICAgLyogJEZsb3dGaXhNZVtpbnZhbGlkLWNvbXB1dGVkLXByb3BdIE5hdHVyYWwgSW5mZXJlbmNlIHJvbGxvdXQuIFNlZVxuICAgICAqIGh0dHBzOi8vZmJ1cmwuY29tL3dvcmtwbGFjZS82MjkxZ2Z2dSAqL1xuICAgIF9lbWl0dGVyLmVtaXQoSW50ZXJhY3Rpb25NYW5hZ2VyLkV2ZW50cy5pbnRlcmFjdGlvbkNvbXBsZXRlKTtcbiAgfSBlbHNlIGlmIChpbnRlcmFjdGlvbkNvdW50ID09PSAwICYmIG5leHRJbnRlcmFjdGlvbkNvdW50ICE9PSAwKSB7XG4gICAgLy8gdHJhbnNpdGlvbiBmcm9tIDAgLS0+IDErIGludGVyYWN0aW9uc1xuICAgIC8qICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXSBOYXR1cmFsIEluZmVyZW5jZSByb2xsb3V0LiBTZWVcbiAgICAgKiBodHRwczovL2ZidXJsLmNvbS93b3JrcGxhY2UvNjI5MWdmdnUgKi9cbiAgICAvKiAkRmxvd0ZpeE1lW2ludmFsaWQtY29tcHV0ZWQtcHJvcF0gTmF0dXJhbCBJbmZlcmVuY2Ugcm9sbG91dC4gU2VlXG4gICAgICogaHR0cHM6Ly9mYnVybC5jb20vd29ya3BsYWNlLzYyOTFnZnZ1ICovXG4gICAgX2VtaXR0ZXIuZW1pdChJbnRlcmFjdGlvbk1hbmFnZXIuRXZlbnRzLmludGVyYWN0aW9uU3RhcnQpO1xuICB9XG5cbiAgLy8gcHJvY2VzcyB0aGUgcXVldWUgcmVnYXJkbGVzcyBvZiBhIHRyYW5zaXRpb25cbiAgaWYgKG5leHRJbnRlcmFjdGlvbkNvdW50ID09PSAwKSB7XG4gICAgd2hpbGUgKF90YXNrUXVldWUuaGFzVGFza3NUb1Byb2Nlc3MoKSkge1xuICAgICAgX3Rhc2tRdWV1ZS5wcm9jZXNzTmV4dCgpO1xuICAgICAgaWYgKFxuICAgICAgICBfZGVhZGxpbmUgPiAwICYmXG4gICAgICAgIEJhdGNoZWRCcmlkZ2UuZ2V0RXZlbnRMb29wUnVubmluZ1RpbWUoKSA+PSBfZGVhZGxpbmVcbiAgICAgICkge1xuICAgICAgICAvLyBIaXQgZGVhZGxpbmUgYmVmb3JlIHByb2Nlc3NpbmcgYWxsIHRhc2tzLCBzbyBwcm9jZXNzIG1vcmUgbGF0ZXIuXG4gICAgICAgIF9zY2hlZHVsZVVwZGF0ZSgpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgX2FkZEludGVyYWN0aW9uU2V0LmNsZWFyKCk7XG4gIF9kZWxldGVJbnRlcmFjdGlvblNldC5jbGVhcigpO1xufVxuXG4vKipcbiAqIEludGVyYWN0aW9uTWFuYWdlciBhbGxvd3MgbG9uZy1ydW5uaW5nIHdvcmsgdG8gYmUgc2NoZWR1bGVkIGFmdGVyIGFueVxuICogaW50ZXJhY3Rpb25zL2FuaW1hdGlvbnMgaGF2ZSBjb21wbGV0ZWQuIEluIHBhcnRpY3VsYXIsIHRoaXMgYWxsb3dzIEphdmFTY3JpcHRcbiAqIGFuaW1hdGlvbnMgdG8gcnVuIHNtb290aGx5LlxuICpcbiAqIEFwcGxpY2F0aW9ucyBjYW4gc2NoZWR1bGUgdGFza3MgdG8gcnVuIGFmdGVyIGludGVyYWN0aW9ucyB3aXRoIHRoZSBmb2xsb3dpbmc6XG4gKlxuICogYGBgXG4gKiBJbnRlcmFjdGlvbk1hbmFnZXIucnVuQWZ0ZXJJbnRlcmFjdGlvbnMoKCkgPT4ge1xuICogICAvLyAuLi5sb25nLXJ1bm5pbmcgc3luY2hyb25vdXMgdGFzay4uLlxuICogfSk7XG4gKiBgYGBcbiAqXG4gKiBDb21wYXJlIHRoaXMgdG8gb3RoZXIgc2NoZWR1bGluZyBhbHRlcm5hdGl2ZXM6XG4gKlxuICogLSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKTogZm9yIGNvZGUgdGhhdCBhbmltYXRlcyBhIHZpZXcgb3ZlciB0aW1lLlxuICogLSBzZXRJbW1lZGlhdGUvc2V0VGltZW91dCgpOiBydW4gY29kZSBsYXRlciwgbm90ZSB0aGlzIG1heSBkZWxheSBhbmltYXRpb25zLlxuICogLSBydW5BZnRlckludGVyYWN0aW9ucygpOiBydW4gY29kZSBsYXRlciwgd2l0aG91dCBkZWxheWluZyBhY3RpdmUgYW5pbWF0aW9ucy5cbiAqXG4gKiBUaGUgdG91Y2ggaGFuZGxpbmcgc3lzdGVtIGNvbnNpZGVycyBvbmUgb3IgbW9yZSBhY3RpdmUgdG91Y2hlcyB0byBiZSBhblxuICogJ2ludGVyYWN0aW9uJyBhbmQgd2lsbCBkZWxheSBgcnVuQWZ0ZXJJbnRlcmFjdGlvbnMoKWAgY2FsbGJhY2tzIHVudGlsIGFsbFxuICogdG91Y2hlcyBoYXZlIGVuZGVkIG9yIGJlZW4gY2FuY2VsbGVkLlxuICpcbiAqIEludGVyYWN0aW9uTWFuYWdlciBhbHNvIGFsbG93cyBhcHBsaWNhdGlvbnMgdG8gcmVnaXN0ZXIgYW5pbWF0aW9ucyBieVxuICogY3JlYXRpbmcgYW4gaW50ZXJhY3Rpb24gJ2hhbmRsZScgb24gYW5pbWF0aW9uIHN0YXJ0LCBhbmQgY2xlYXJpbmcgaXQgdXBvblxuICogY29tcGxldGlvbjpcbiAqXG4gKiBgYGBcbiAqIHZhciBoYW5kbGUgPSBJbnRlcmFjdGlvbk1hbmFnZXIuY3JlYXRlSW50ZXJhY3Rpb25IYW5kbGUoKTtcbiAqIC8vIHJ1biBhbmltYXRpb24uLi4gKGBydW5BZnRlckludGVyYWN0aW9uc2AgdGFza3MgYXJlIHF1ZXVlZClcbiAqIC8vIGxhdGVyLCBvbiBhbmltYXRpb24gY29tcGxldGlvbjpcbiAqIEludGVyYWN0aW9uTWFuYWdlci5jbGVhckludGVyYWN0aW9uSGFuZGxlKGhhbmRsZSk7XG4gKiAvLyBxdWV1ZWQgdGFza3MgcnVuIGlmIGFsbCBoYW5kbGVzIHdlcmUgY2xlYXJlZFxuICogYGBgXG4gKlxuICogYHJ1bkFmdGVySW50ZXJhY3Rpb25zYCB0YWtlcyBlaXRoZXIgYSBwbGFpbiBjYWxsYmFjayBmdW5jdGlvbiwgb3IgYVxuICogYFByb21pc2VUYXNrYCBvYmplY3Qgd2l0aCBhIGBnZW5gIG1ldGhvZCB0aGF0IHJldHVybnMgYSBgUHJvbWlzZWAuICBJZiBhXG4gKiBgUHJvbWlzZVRhc2tgIGlzIHN1cHBsaWVkLCB0aGVuIGl0IGlzIGZ1bGx5IHJlc29sdmVkIChpbmNsdWRpbmcgYXN5bmNocm9ub3VzXG4gKiBkZXBlbmRlbmNpZXMgdGhhdCBhbHNvIHNjaGVkdWxlIG1vcmUgdGFza3MgdmlhIGBydW5BZnRlckludGVyYWN0aW9uc2ApIGJlZm9yZVxuICogc3RhcnRpbmcgb24gdGhlIG5leHQgdGFzayB0aGF0IG1pZ2h0IGhhdmUgYmVlbiBxdWV1ZWQgdXAgc3luY2hyb25vdXNseVxuICogZWFybGllci5cbiAqXG4gKiBCeSBkZWZhdWx0LCBxdWV1ZWQgdGFza3MgYXJlIGV4ZWN1dGVkIHRvZ2V0aGVyIGluIGEgbG9vcCBpbiBvbmVcbiAqIGBzZXRJbW1lZGlhdGVgIGJhdGNoLiBJZiBgc2V0RGVhZGxpbmVgIGlzIGNhbGxlZCB3aXRoIGEgcG9zaXRpdmUgbnVtYmVyLCB0aGVuXG4gKiB0YXNrcyB3aWxsIG9ubHkgYmUgZXhlY3V0ZWQgdW50aWwgdGhlIGRlYWRsaW5lIChpbiB0ZXJtcyBvZiBqcyBldmVudCBsb29wIHJ1blxuICogdGltZSkgYXBwcm9hY2hlcywgYXQgd2hpY2ggcG9pbnQgZXhlY3V0aW9uIHdpbGwgeWllbGQgdmlhIHNldFRpbWVvdXQsXG4gKiBhbGxvd2luZyBldmVudHMgc3VjaCBhcyB0b3VjaGVzIHRvIHN0YXJ0IGludGVyYWN0aW9ucyBhbmQgYmxvY2sgcXVldWVkIHRhc2tzXG4gKiBmcm9tIGV4ZWN1dGluZywgbWFraW5nIGFwcHMgbW9yZSByZXNwb25zaXZlLlxuICpcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmNvbnN0IEludGVyYWN0aW9uTWFuYWdlciA9IChcbiAgUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MuZGlzYWJsZUludGVyYWN0aW9uTWFuYWdlcigpXG4gICAgPyAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS12YXJpYW5jZV1cbiAgICAgIHJlcXVpcmUoJy4vSW50ZXJhY3Rpb25NYW5hZ2VyU3R1YicpLmRlZmF1bHRcbiAgICA6IEludGVyYWN0aW9uTWFuYWdlckltcGxcbikgYXMgdHlwZW9mIEludGVyYWN0aW9uTWFuYWdlckltcGw7XG5cbmV4cG9ydCBkZWZhdWx0IEludGVyYWN0aW9uTWFuYWdlcjtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBYUEsSUFBQUEsdUJBQUEsR0FBQUMsdUJBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLGFBQUEsR0FBQUMsc0JBQUEsQ0FBQUYsT0FBQTtBQUVBLElBQU1HLGFBQWEsR0FBR0gsT0FBTyxpQ0FBaUMsQ0FBQyxDQUFDSSxPQUFPO0FBQ3ZFLElBQU1DLFNBQVMsR0FBR0wsT0FBTyxjQUFjLENBQUMsQ0FBQ0ksT0FBTztBQUNoRCxJQUFNRSxTQUFTLEdBQUdOLE9BQU8sQ0FBQyxXQUFXLENBQUM7QUFNdEMsSUFBTU8sUUFBUSxHQUFHLElBQUlDLHFCQUFZLENBRzlCLENBQUM7QUFFSixJQUFNQyxXQUFjLEdBQUcsQ0FBQztBQUN4QixJQUFNQyxLQUFZLEdBQUcsS0FBSztBQUUxQixJQUFNQyxzQkFBc0IsR0FBRztFQUM3QkMsTUFBTSxFQUFFO0lBQ05DLGdCQUFnQixFQUFFLGtCQUFrQjtJQUNwQ0MsbUJBQW1CLEVBQUU7RUFDdkIsQ0FBQztFQU1EQyxvQkFBb0IsV0FBcEJBLG9CQUFvQkEsQ0FBQ0MsSUFBVyxFQU85QjtJQUNBLElBQU1DLEtBQWtCLEdBQUcsRUFBRTtJQUM3QixJQUFNQyxPQUFPLEdBQUcsSUFBSUMsT0FBTyxDQUFDLFVBQUNDLE9BQW1CLEVBQUs7TUFDbkRDLGVBQWUsQ0FBQyxDQUFDO01BQ2pCLElBQUlMLElBQUksRUFBRTtRQUNSQyxLQUFLLENBQUNLLElBQUksQ0FBQ04sSUFBSSxDQUFDO01BQ2xCO01BQ0FDLEtBQUssQ0FBQ0ssSUFBSSxDQUFDO1FBQ1RDLEdB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