1a395a7b92672174902443decc35d9a2
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _react = _interopRequireDefault(require("react"));
var _reactRedux = require("react-redux");
var _toolkit = require("@reduxjs/toolkit");
var _reactNative = require("@testing-library/react-native");
var _rootReducer = _interopRequireDefault(require("../../store/rootReducer"));
var _usePrimaryNavigation = _interopRequireDefault(require("../../hooks/usePrimaryNavigation"));
var _jsxRuntime = require("react/jsx-runtime");
var TestComponent = function TestComponent(_ref) {
  var onResult = _ref.onResult;
  var result = (0, _usePrimaryNavigation.default)();
  _react.default.useEffect(function () {
    onResult(result);
  }, [onResult, result]);
  return null;
};
var createStore = function createStore() {
  var preloadedState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  return (0, _toolkit.configureStore)({
    reducer: _rootReducer.default,
    preloadedState: Object.assign({
      ui: {
        theme: 'light',
        locale: 'en',
        isLoading: false,
        isAuthenticated: false,
        user: null
      },
      network: {
        isOnline: true
      }
    }, preloadedState)
  });
};
describe('usePrimaryNavigation', function () {
  it('builds main and patient items with labels', function () {
    var store = createStore({
      ui: {
        theme: 'light',
        locale: 'en',
        isLoading: false,
        isAuthenticated: true,
        user: {
          role: 'patient'
        }
      }
    });
    var result;
    (0, _reactNative.render)((0, _jsxRuntime.jsx)(_reactRedux.Provider, {
      store: store,
      children: (0, _jsxRuntime.jsx)(TestComponent, {
        onResult: function onResult(value) {
          return result = value;
        }
      })
    }));
    expect(result.mainItems.length).toBeGreaterThan(0);
    expect(result.patientItems.length).toBeGreaterThan(0);
    expect(result.mainItems[0].label).toBeDefined();
    expect(result.patientItems[0].label).toBeDefined();
  });
  it('filters items by role using isItemVisible', function () {
    var store = createStore({
      ui: {
        theme: 'light',
        locale: 'en',
        isLoading: false,
        isAuthenticated: true,
        user: {
          role: 'patient'
        }
      }
    });
    var result;
    (0, _reactNative.render)((0, _jsxRuntime.jsx)(_reactRedux.Provider, {
      store: store,
      children: (0, _jsxRuntime.jsx)(TestComponent, {
        onResult: function onResult(value) {
          return result = value;
        }
      })
    }));
    var patientItem = {
      roles: ['patient']
    };
    var staffItem = {
      roles: ['admin']
    };
    expect(result.isItemVisible(patientItem)).toBe(true);
    expect(result.isItemVisible(staffItem)).toBe(false);
  });
  it('hides role-scoped items when unauthenticated', function () {
    var store = createStore();
    var result;
    (0, _reactNative.render)((0, _jsxRuntime.jsx)(_reactRedux.Provider, {
      store: store,
      children: (0, _jsxRuntime.jsx)(TestComponent, {
        onResult: function onResult(value) {
          return result = value;
        }
      })
    }));
    expect(result.isItemVisible({
      roles: ['patient']
    })).toBe(false);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9yZWFjdFJlZHV4IiwiX3Rvb2xraXQiLCJfcmVhY3ROYXRpdmUiLCJfcm9vdFJlZHVjZXIiLCJfdXNlUHJpbWFyeU5hdmlnYXRpb24iLCJfanN4UnVudGltZSIsIlRlc3RDb21wb25lbnQiLCJfcmVmIiwib25SZXN1bHQiLCJyZXN1bHQiLCJ1c2VQcmltYXJ5TmF2aWdhdGlvbiIsIlJlYWN0IiwidXNlRWZmZWN0IiwiY3JlYXRlU3RvcmUiLCJwcmVsb2FkZWRTdGF0ZSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImNvbmZpZ3VyZVN0b3JlIiwicmVkdWNlciIsInJvb3RSZWR1Y2VyIiwiT2JqZWN0IiwiYXNzaWduIiwidWkiLCJ0aGVtZSIsImxvY2FsZSIsImlzTG9hZGluZyIsImlzQXV0aGVudGljYXRlZCIsInVzZXIiLCJuZXR3b3JrIiwiaXNPbmxpbmUiLCJkZXNjcmliZSIsIml0Iiwic3RvcmUiLCJyb2xlIiwicmVuZGVyIiwianN4IiwiUHJvdmlkZXIiLCJjaGlsZHJlbiIsInZhbHVlIiwiZXhwZWN0IiwibWFpbkl0ZW1zIiwidG9CZUdyZWF0ZXJUaGFuIiwicGF0aWVudEl0ZW1zIiwibGFiZWwiLCJ0b0JlRGVmaW5lZCIsInBhdGllbnRJdGVtIiwicm9sZXMiLCJzdGFmZkl0ZW0iLCJpc0l0ZW1WaXNpYmxlIiwidG9CZSJdLCJzb3VyY2VzIjpbInVzZVByaW1hcnlOYXZpZ2F0aW9uLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIHVzZVByaW1hcnlOYXZpZ2F0aW9uIEhvb2sgVGVzdHNcclxuICogRmlsZTogdXNlUHJpbWFyeU5hdmlnYXRpb24udGVzdC5qc1xyXG4gKi9cclxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tICdyZWFjdC1yZWR1eCc7XHJcbmltcG9ydCB7IGNvbmZpZ3VyZVN0b3JlIH0gZnJvbSAnQHJlZHV4anMvdG9vbGtpdCc7XHJcbmltcG9ydCB7IHJlbmRlciB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QtbmF0aXZlJztcclxuaW1wb3J0IHJvb3RSZWR1Y2VyIGZyb20gJ0BzdG9yZS9yb290UmVkdWNlcic7XHJcbmltcG9ydCB1c2VQcmltYXJ5TmF2aWdhdGlvbiBmcm9tICdAaG9va3MvdXNlUHJpbWFyeU5hdmlnYXRpb24nO1xyXG5cclxuY29uc3QgVGVzdENvbXBvbmVudCA9ICh7IG9uUmVzdWx0IH0pID0+IHtcclxuICBjb25zdCByZXN1bHQgPSB1c2VQcmltYXJ5TmF2aWdhdGlvbigpO1xyXG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBvblJlc3VsdChyZXN1bHQpO1xyXG4gIH0sIFtvblJlc3VsdCwgcmVzdWx0XSk7XHJcbiAgcmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVTdG9yZSA9IChwcmVsb2FkZWRTdGF0ZSA9IHt9KSA9PlxyXG4gIGNvbmZpZ3VyZVN0b3JlKHtcclxuICAgIHJlZHVjZXI6IHJvb3RSZWR1Y2VyLFxyXG4gICAgcHJlbG9hZGVkU3RhdGU6IHtcclxuICAgICAgdWk6IHtcclxuICAgICAgICB0aGVtZTogJ2xpZ2h0JyxcclxuICAgICAgICBsb2NhbGU6ICdlbicsXHJcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcclxuICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxyXG4gICAgICAgIHVzZXI6IG51bGwsXHJcbiAgICAgIH0sXHJcbiAgICAgIG5ldHdvcms6IHtcclxuICAgICAgICBpc09ubGluZTogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgICAgLi4ucHJlbG9hZGVkU3RhdGUsXHJcbiAgICB9LFxyXG4gIH0pO1xyXG5cclxuZGVzY3JpYmUoJ3VzZVByaW1hcnlOYXZpZ2F0aW9uJywgKCkgPT4ge1xyXG4gIGl0KCdidWlsZHMgbWFpbiBhbmQgcGF0aWVudCBpdGVtcyB3aXRoIGxhYmVscycsICgpID0+IHtcclxuICAgIGNvbnN0IHN0b3JlID0gY3JlYXRlU3RvcmUoe1xyXG4gICAgICB1aToge1xyXG4gICAgICAgIHRoZW1lOiAnbGlnaHQnLFxyXG4gICAgICAgIGxvY2FsZTogJ2VuJyxcclxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIGlzQXV0aGVudGljYXRlZDogdHJ1ZSxcclxuICAgICAgICB1c2VyOiB7IHJvbGU6ICdwYXRpZW50JyB9LFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBsZXQgcmVzdWx0O1xyXG4gICAgcmVuZGVyKFxyXG4gICAgICA8UHJvdmlkZXIgc3RvcmU9e3N0b3JlfT5cclxuICAgICAgICA8VGVzdENvbXBvbmVudCBvblJlc3VsdD17KHZhbHVlKSA9PiAocmVzdWx0ID0gdmFsdWUpfSAvPlxyXG4gICAgICA8L1Byb3ZpZGVyPlxyXG4gICAgKTtcclxuICAgIGV4cGVjdChyZXN1bHQubWFpbkl0ZW1zLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5wYXRpZW50SXRlbXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICBleHBlY3QocmVzdWx0Lm1haW5JdGVtc1swXS5sYWJlbCkudG9CZURlZmluZWQoKTtcclxuICAgIGV4cGVjdChyZXN1bHQucGF0aWVudEl0ZW1zWzBdLmxhYmVsKS50b0JlRGVmaW5lZCgpO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnZmlsdGVycyBpdGVtcyBieSByb2xlIHVzaW5nIGlzSXRlbVZpc2libGUnLCAoKSA9PiB7XHJcbiAgICBjb25zdCBzdG9yZSA9IGNyZWF0ZVN0b3JlKHtcclxuICAgICAgdWk6IHtcclxuICAgICAgICB0aGVtZTogJ2xpZ2h0JyxcclxuICAgICAgICBsb2NhbGU6ICdlbicsXHJcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcclxuICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUsXHJcbiAgICAgICAgdXNlcjogeyByb2xlOiAncGF0aWVudCcgfSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgbGV0IHJlc3VsdDtcclxuICAgIHJlbmRlcihcclxuICAgICAgPFByb3ZpZGVyIHN0b3JlPXtzdG9yZX0+XHJcbiAgICAgICAgPFRlc3RDb21wb25lbnQgb25SZXN1bHQ9eyh2YWx1ZSkgPT4gKHJlc3VsdCA9IHZhbHVlKX0gLz5cclxuICAgICAgPC9Qcm92aWRlcj5cclxuICAgICk7XHJcbiAgICBjb25zdCBwYXRpZW50SXRlbSA9IHsgcm9sZXM6IFsncGF0aWVudCddIH07XHJcbiAgICBjb25zdCBzdGFmZkl0ZW0gPSB7IHJvbGVzOiBbJ2FkbWluJ10gfTtcclxuICAgIGV4cGVjdChyZXN1bHQuaXNJdGVtVmlzaWJsZShwYXRpZW50SXRlbSkpLnRvQmUodHJ1ZSk7XHJcbiAgICBleHBlY3QocmVzdWx0LmlzSXRlbVZpc2libGUoc3RhZmZJdGVtKSkudG9CZShmYWxzZSk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdoaWRlcyByb2xlLXNjb3BlZCBpdGVtcyB3aGVuIHVuYXV0aGVudGljYXRlZCcsICgpID0+IHtcclxuICAgIGNvbnN0IHN0b3JlID0gY3JlYXRlU3RvcmUoKTtcclxuICAgIGxldCByZXN1bHQ7XHJcbiAgICByZW5kZXIoXHJcbiAgICAgIDxQcm92aWRlciBzdG9yZT17c3RvcmV9PlxyXG4gICAgICAgIDxUZXN0Q29tcG9uZW50IG9uUmVzdWx0PXsodmFsdWUpID0+IChyZXN1bHQgPSB2YWx1ZSl9IC8+XHJcbiAgICAgIDwvUHJvdmlkZXI+XHJcbiAgICApO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5pc0l0ZW1WaXNpYmxlKHsgcm9sZXM6IFsncGF0aWVudCddIH0pKS50b0JlKGZhbHNlKTtcclxuICB9KTtcclxufSk7XHJcbiJdLCJtYXBwaW5ncyI6IjtBQUlBLElBQUFBLE1BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFdBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFF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