{"version":3,"names":["_ReactNativeStyleAttributes","_interopRequireDefault","require","_View","_DebuggingOverlay","_useSubscribeToDebuggingOverlayRegistry","_RCTDeviceEventEmitter","_LogBoxNotificationContainer","_StyleSheet","_RootTag","_react","_interopRequireWildcard","React","_jsxRuntime","useEffect","useState","useCallback","reactDevToolsHook","window","__REACT_DEVTOOLS_GLOBAL_HOOK__","resolveRNStyle","default","nativeStyleEditorValidAttributes","Object","keys","ReactNativeStyleAttributes","InspectorDeferred","_ref","inspectedViewRef","onInspectedViewRerenderRequest","reactDevToolsAgent","Inspector","jsx","onRequestRerenderApp","ReactDevToolsOverlayDeferred","_ref2","ReactDevToolsOverlay","AppContainer","_ref3","children","fabric","initialProps","_ref3$internal_exclud","internal_excludeInspector","_ref3$internal_exclud2","internal_excludeLogBox","rootTag","WrapperComponent","rootViewStyle","appContainerRootViewRef","useRef","innerViewRef","debuggingOverlayRef","useSubscribeToDebuggingOverlayRegistry","_useState","_useState2","_slicedToArray2","key","setKey","_useState3","_useState4","shouldRenderInspector","setShouldRenderInspector","_useState5","reactDevtoolsAgent","_useState6","setReactDevToolsAgent","inspectorSubscription","RCTDeviceEventEmitter","addListener","value","reactDevToolsAgentListener","on","_inspectorSubscriptio","remove","off","innerView","collapsable","pointerEvents","style","styles","container","ref","k","RootTagContext","Provider","createRootTag","jsxs","StyleSheet","create","flex","_default","exports"],"sources":["AppContainer-dev.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow strict-local\n * @format\n */\n\nimport type {\n  ReactDevToolsAgent,\n  ReactDevToolsGlobalHook,\n} from '../Types/ReactDevToolsTypes';\nimport type {Props} from './AppContainer';\n\nimport ReactNativeStyleAttributes from '../Components/View/ReactNativeStyleAttributes';\nimport View from '../Components/View/View';\nimport DebuggingOverlay from '../Debugging/DebuggingOverlay';\nimport useSubscribeToDebuggingOverlayRegistry from '../Debugging/useSubscribeToDebuggingOverlayRegistry';\nimport RCTDeviceEventEmitter from '../EventEmitter/RCTDeviceEventEmitter';\nimport LogBoxNotificationContainer from '../LogBox/LogBoxNotificationContainer';\nimport StyleSheet from '../StyleSheet/StyleSheet';\nimport {RootTagContext, createRootTag} from './RootTag';\nimport * as React from 'react';\nimport {useRef} from 'react';\n\nconst {useEffect, useState, useCallback} = React;\n\nconst reactDevToolsHook: ReactDevToolsGlobalHook = (window: $FlowFixMe)\n  .__REACT_DEVTOOLS_GLOBAL_HOOK__;\n\n// Required for React DevTools to view / edit React Native styles in Flipper.\n// Flipper doesn't inject these values when initializing DevTools.\nif (reactDevToolsHook) {\n  reactDevToolsHook.resolveRNStyle =\n    require('../StyleSheet/flattenStyle').default;\n  reactDevToolsHook.nativeStyleEditorValidAttributes = Object.keys(\n    ReactNativeStyleAttributes,\n  );\n}\n\ntype InspectorDeferredProps = {\n  inspectedViewRef: InspectedViewRef,\n  onInspectedViewRerenderRequest: () => void,\n  reactDevToolsAgent?: ReactDevToolsAgent,\n};\n\nconst InspectorDeferred = ({\n  inspectedViewRef,\n  onInspectedViewRerenderRequest,\n  reactDevToolsAgent,\n}: InspectorDeferredProps) => {\n  // D39382967 adds a require cycle: InitializeCore -> AppContainer -> Inspector -> InspectorPanel -> ScrollView -> InitializeCore\n  // We can't remove it yet, fallback to dynamic require for now. This is the only reason why this logic is in a separate function.\n  const Inspector =\n    require('../../src/private/devsupport/devmenu/elementinspector/Inspector').default;\n\n  return (\n    <Inspector\n      inspectedViewRef={inspectedViewRef}\n      onRequestRerenderApp={onInspectedViewRerenderRequest}\n      reactDevToolsAgent={reactDevToolsAgent}\n    />\n  );\n};\n\ntype ReactDevToolsOverlayDeferredProps = {\n  inspectedViewRef: InspectedViewRef,\n  reactDevToolsAgent: ReactDevToolsAgent,\n};\n\nconst ReactDevToolsOverlayDeferred = ({\n  inspectedViewRef,\n  reactDevToolsAgent,\n}: ReactDevToolsOverlayDeferredProps) => {\n  const ReactDevToolsOverlay =\n    require('../../src/private/devsupport/devmenu/elementinspector/ReactDevToolsOverlay').default;\n\n  return (\n    <ReactDevToolsOverlay\n      inspectedViewRef={inspectedViewRef}\n      reactDevToolsAgent={reactDevToolsAgent}\n    />\n  );\n};\n\nconst AppContainer = ({\n  children,\n  fabric,\n  initialProps,\n  internal_excludeInspector = false,\n  internal_excludeLogBox = false,\n  rootTag,\n  WrapperComponent,\n  rootViewStyle,\n}: Props): React.Node => {\n  const appContainerRootViewRef: AppContainerRootViewRef = useRef(null);\n  const innerViewRef: InspectedViewRef = useRef(null);\n  const debuggingOverlayRef: DebuggingOverlayRef = useRef(null);\n\n  useSubscribeToDebuggingOverlayRegistry(\n    appContainerRootViewRef,\n    debuggingOverlayRef,\n  );\n\n  const [key, setKey] = useState(0);\n  const [shouldRenderInspector, setShouldRenderInspector] = useState(false);\n  const [reactDevToolsAgent, setReactDevToolsAgent] =\n    useState<ReactDevToolsAgent | void>(reactDevToolsHook?.reactDevtoolsAgent);\n\n  useEffect(() => {\n    let inspectorSubscription = null;\n    if (!internal_excludeInspector) {\n      inspectorSubscription = RCTDeviceEventEmitter.addListener(\n        'toggleElementInspector',\n        () => setShouldRenderInspector(value => !value),\n      );\n    }\n\n    let reactDevToolsAgentListener = null;\n    // If this is first render, subscribe to the event from React DevTools hook\n    if (reactDevToolsHook != null && reactDevToolsAgent == null) {\n      reactDevToolsAgentListener = setReactDevToolsAgent;\n      reactDevToolsHook.on?.('react-devtools', reactDevToolsAgentListener);\n    }\n\n    return () => {\n      inspectorSubscription?.remove();\n\n      if (\n        reactDevToolsHook?.off != null &&\n        reactDevToolsAgentListener != null\n      ) {\n        reactDevToolsHook.off('react-devtools', reactDevToolsAgentListener);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  let innerView: React.Node = (\n    <View\n      collapsable={reactDevToolsAgent == null && !shouldRenderInspector}\n      pointerEvents=\"box-none\"\n      key={key}\n      style={rootViewStyle || styles.container}\n      ref={innerViewRef}>\n      {children}\n    </View>\n  );\n\n  if (WrapperComponent != null) {\n    innerView = (\n      <WrapperComponent initialProps={initialProps} fabric={fabric === true}>\n        {innerView}\n      </WrapperComponent>\n    );\n  }\n\n  const onInspectedViewRerenderRequest = useCallback(\n    () => setKey(k => k + 1),\n    [],\n  );\n\n  return (\n    <RootTagContext.Provider value={createRootTag(rootTag)}>\n      <View\n        ref={appContainerRootViewRef}\n        style={rootViewStyle || styles.container}\n        pointerEvents=\"box-none\">\n        {innerView}\n\n        <DebuggingOverlay ref={debuggingOverlayRef} />\n\n        {reactDevToolsAgent != null && (\n          <ReactDevToolsOverlayDeferred\n            inspectedViewRef={innerViewRef}\n            reactDevToolsAgent={reactDevToolsAgent}\n          />\n        )}\n\n        {shouldRenderInspector && (\n          <InspectorDeferred\n            inspectedViewRef={innerViewRef}\n            onInspectedViewRerenderRequest={onInspectedViewRerenderRequest}\n            reactDevToolsAgent={reactDevToolsAgent}\n          />\n        )}\n\n        {!internal_excludeLogBox && <LogBoxNotificationContainer />}\n      </View>\n    </RootTagContext.Provider>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {flex: 1},\n});\n\nexport type AppContainerRootViewRef = React.RefObject<React.ElementRef<\n  typeof View,\n> | null>;\nexport type InspectedViewRef = React.RefObject<React.ElementRef<\n  typeof View,\n> | null>;\nexport type DebuggingOverlayRef = React.RefObject<React.ElementRef<\n  typeof DebuggingOverlay,\n> | null>;\n\nexport default AppContainer;\n"],"mappings":";;;;;;;AAgBA,IAAAA,2BAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,KAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,iBAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,uCAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,sBAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,4BAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,WAAA,GAAAP,sBAAA,CAAAC,OAAA;AACA,IAAAO,QAAA,GAAAP,OAAA;AACA,IAAAQ,MAAA,GAAAC,uBAAA,CAAAT,OAAA;AAA+B,IAAAU,KAAA,GAAAF,MAAA;AAAA,IAAAG,WAAA,GAAAX,OAAA;AAG/B,IAAOY,SAAS,GAA2BF,KAAK,CAAzCE,SAAS;EAAEC,QAAQ,GAAiBH,KAAK,CAA9BG,QAAQ;EAAEC,WAAW,GAAIJ,KAAK,CAApBI,WAAW;AAEvC,IAAMC,iBAA0C,GAAIC,MAAM,CACvDC,8BAA8B;AAIjC,IAAIF,iBAAiB,EAAE;EACrBA,iBAAiB,CAACG,cAAc,GAC9BlB,OAAO,6BAA6B,CAAC,CAACmB,OAAO;EAC/CJ,iBAAiB,CAACK,gCAAgC,GAAGC,MAAM,CAACC,IAAI,CAC9DC,mCACF,CAAC;AACH;AAQA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAiBA,CAAAC,IAAA,EAIO;EAAA,IAH5BC,gBAAgB,GAAAD,IAAA,CAAhBC,gBAAgB;IAChBC,8BAA8B,GAAAF,IAAA,CAA9BE,8BAA8B;IAC9BC,kBAAkB,GAAAH,IAAA,CAAlBG,kBAAkB;EAIlB,IAAMC,SAAS,GACb7B,OAAO,kEAAkE,CAAC,CAACmB,OAAO;EAEpF,OACE,IAAAR,WAAA,CAAAmB,GAAA,EAACD,SAAS;IACRH,gBAAgB,EAAEA,gBAAiB;IACnCK,oBAAoB,EAAEJ,8BAA+B;IACrDC,kBAAkB,EAAEA;EAAmB,CACxC,CAAC;AAEN,CAAC;AAOD,IAAMI,4BAA4B,GAAG,SAA/BA,4BAA4BA,CAAAC,KAAA,EAGO;EAAA,IAFvCP,gBAAgB,GAAAO,KAAA,CAAhBP,gBAAgB;IAChBE,kBAAkB,GAAAK,KAAA,CAAlBL,kBAAkB;EAElB,IAAMM,oBAAoB,GACxBlC,OAAO,6EAA6E,CAAC,CAACmB,OAAO;EAE/F,OACE,IAAAR,WAAA,CAAAmB,GAAA,EAACI,oBAAoB;IACnBR,gBAAgB,EAAEA,gBAAiB;IACnCE,kBAAkB,EAAEA;EAAmB,CACxC,CAAC;AAEN,CAAC;AAED,IAAMO,YAAY,GAAG,SAAfA,YAAYA,CAAAC,KAAA,EASO;EAAA,IARvBC,QAAQ,GAAAD,KAAA,CAARC,QAAQ;IACRC,MAAM,GAAAF,KAAA,CAANE,MAAM;IACNC,YAAY,GAAAH,KAAA,CAAZG,YAAY;IAAAC,qBAAA,GAAAJ,KAAA,CACZK,yBAAyB;IAAzBA,yBAAyB,GAAAD,qBAAA,cAAG,KAAK,GAAAA,qBAAA;IAAAE,sBAAA,GAAAN,KAAA,CACjCO,sBAAsB;IAAtBA,sBAAsB,GAAAD,sBAAA,cAAG,KAAK,GAAAA,sBAAA;IAC9BE,OAAO,GAAAR,KAAA,CAAPQ,OAAO;IACPC,gBAAgB,GAAAT,KAAA,CAAhBS,gBAAgB;IAChBC,aAAa,GAAAV,KAAA,CAAbU,aAAa;EAEb,IAAMC,uBAAgD,GAAG,IAAAC,aAAM,EAAC,IAAI,CAAC;EACrE,IAAMC,YAA8B,GAAG,IAAAD,aAAM,EAAC,IAAI,CAAC;EACnD,IAAME,mBAAwC,GAAG,IAAAF,aAAM,EAAC,IAAI,CAAC;EAE7D,IAAAG,+CAAsC,EACpCJ,uBAAuB,EACvBG,mBACF,CAAC;EAED,IAAAE,SAAA,GAAsBvC,QAAQ,CAAC,CAAC,CAAC;IAAAwC,UAAA,OAAAC,eAAA,CAAAnC,OAAA,EAAAiC,SAAA;IAA1BG,GAAG,GAAAF,UAAA;IAAEG,MAAM,GAAAH,UAAA;EAClB,IAAAI,UAAA,GAA0D5C,QAAQ,CAAC,KAAK,CAAC;IAAA6C,UAAA,OAAAJ,eAAA,CAAAnC,OAAA,EAAAsC,UAAA;IAAlEE,qBAAqB,GAAAD,UAAA;IAAEE,wBAAwB,GAAAF,UAAA;EACtD,IAAAG,UAAA,GACEhD,QAAQ,CAA4BE,iBAAiB,oBAAjBA,iBAAiB,CAAE+C,kBAAkB,CAAC;IAAAC,UAAA,OAAAT,eAAA,CAAAnC,OAAA,EAAA0C,UAAA;IADrEjC,kBAAkB,GAAAmC,UAAA;IAAEC,qBAAqB,GAAAD,UAAA;EAGhDnD,SAAS,CAAC,YAAM;IACd,IAAIqD,qBAAqB,GAAG,IAAI;IAChC,IAAI,CAACxB,yBAAyB,EAAE;MAC9BwB,qBAAqB,GAAGC,8BAAqB,CAACC,WAAW,CACvD,wBAAwB,EACxB;QAAA,OAAMP,wBAAwB,CAAC,UAAAQ,KAAK;UAAA,OAAI,CAACA,KAAK;QAAA,EAAC;MAAA,CACjD,CAAC;IACH;IAEA,IAAIC,0BAA0B,GAAG,IAAI;IAErC,IAAItD,iBAAiB,IAAI,IAAI,IAAIa,kBAAkB,IAAI,IAAI,EAAE;MAC3DyC,0BAA0B,GAAGL,qBAAqB;MAClDjD,iBAAiB,CAACuD,EAAE,YAApBvD,iBAAiB,CAACuD,EAAE,CAAG,gBAAgB,EAAED,0BAA0B,CAAC;IACtE;IAEA,OAAO,YAAM;MAAA,IAAAE,qBAAA;MACX,CAAAA,qBAAA,GAAAN,qBAAqB,aAArBM,qBAAA,CAAuBC,MAAM,CAAC,CAAC;MAE/B,IACE,CAAAzD,iBAAiB,oBAAjBA,iBAAiB,CAAE0D,GAAG,KAAI,IAAI,IAC9BJ,0BAA0B,IAAI,IAAI,EAClC;QACAtD,iBAAiB,CAAC0D,GAAG,CAAC,gBAAgB,EAAEJ,0BAA0B,CAAC;MACrE;IACF,CAAC;EAEH,CAAC,EAAE,EAAE,CAAC;EAEN,IAAIK,SAAqB,GACvB,IAAA/D,WAAA,CAAAmB,GAAA,EAAC7B,KAAA,CAAAkB,OAAI;IACHwD,WAAW,EAAE/C,kBAAkB,IAAI,IAAI,IAAI,CAAC+B,qBAAsB;IAClEiB,aAAa,EAAC,UAAU;IAExBC,KAAK,EAAE/B,aAAa,IAAIgC,MAAM,CAACC,SAAU;IACzCC,GAAG,EAAE/B,YAAa;IAAAZ,QAAA,EACjBA;EAAQ,GAHJkB,GAID,CACP;EAED,IAAIV,gBAAgB,IAAI,IAAI,EAAE;IAC5B6B,SAAS,GACP,IAAA/D,WAAA,CAAAmB,GAAA,EAACe,gBAAgB;MAACN,YAAY,EAAEA,YAAa;MAACD,MAAM,EAAEA,MAAM,KAAK,IAAK;MAAAD,QAAA,EACnEqC;IAAS,CACM,CACnB;EACH;EAEA,IAAM/C,8BAA8B,GAAGb,WAAW,CAChD;IAAA,OAAM0C,MAAM,CAAC,UAAAyB,CAAC;MAAA,OAAIA,CAAC,GAAG,CAAC;IAAA,EAAC;EAAA,GACxB,EACF,CAAC;EAED,OACE,IAAAtE,WAAA,CAAAmB,GAAA,EAACvB,QAAA,CAAA2E,cAAc,CAACC,QAAQ;IAACf,KAAK,EAAE,IAAAgB,sBAAa,EAACxC,OAAO,CAAE;IAAAP,QAAA,EACrD,IAAA1B,WAAA,CAAA0E,IAAA,EAACpF,KAAA,CAAAkB,OAAI;MACH6D,GAAG,EAAEjC,uBAAwB;MAC7B8B,KAAK,EAAE/B,aAAa,IAAIgC,MAAM,CAACC,SAAU;MACzCH,aAAa,EAAC,UAAU;MAAAvC,QAAA,GACvBqC,SAAS,EAEV,IAAA/D,WAAA,CAAAmB,GAAA,EAAC5B,iBAAA,CAAAiB,OAAgB;QAAC6D,GAAG,EAAE9B;MAAoB,CAAE,CAAC,EAE7CtB,kBAAkB,IAAI,IAAI,IACzB,IAAAjB,WAAA,CAAAmB,GAAA,EAACE,4BAA4B;QAC3BN,gBAAgB,EAAEuB,YAAa;QAC/BrB,kBAAkB,EAAEA;MAAmB,CACxC,CACF,EAEA+B,qBAAqB,IACpB,IAAAhD,WAAA,CAAAmB,GAAA,EAACN,iBAAiB;QAChBE,gBAAgB,EAAEuB,YAAa;QAC/BtB,8BAA8B,EAAEA,8BAA+B;QAC/DC,kBAAkB,EAAEA;MAAmB,CACxC,CACF,EAEA,CAACe,sBAAsB,IAAI,IAAAhC,WAAA,CAAAmB,GAAA,EAACzB,4BAAA,CAAAc,OAA2B,IAAE,CAAC;IAAA,CACvD;EAAC,CACgB,CAAC;AAE9B,CAAC;AAED,IAAM2D,MAAM,GAAGQ,mBAAU,CAACC,MAAM,CAAC;EAC/BR,SAAS,EAAE;IAACS,IAAI,EAAE;EAAC;AACrB,CAAC,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAvE,OAAA,GAYYgB,YAAY","ignoreList":[]}