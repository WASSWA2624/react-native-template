---
alwaysApply: true
---
# App Router & Navigation Standards

## Purpose
Establish clear, consistent, and maintainable conventions for routing and navigation using Expo App Router.

## File & Folder Structure
- All routes: `src/app/`
- Layouts: `_layout.jsx`
- **Route groups:** Use parentheses, e.g. `(group-name)` for related features—mandatory for organization.
- 404 handler: `+not-found.jsx`

## Rules

1. **Route Grouping**
   - All feature-related routes **must** be inside a route group folder: `(group-name)` in `src/app/`.
   - Only the root route (`index.jsx`) or error handlers (`+not-found.jsx`, `_error.jsx`) may exist directly in `src/app/`.
   - Each route group **must** have its own `_layout.jsx` for group-specific logic (guards, navigation, etc).
   - Route groups organize UIs by feature or access level (e.g., `(auth)`, `(main)`, `(settings)`) — actual groups are project-specific and documented in `dev-plan/`.
   - Parentheses for groups are **never** used outside `src/app/` (`src/platform/` uses plain folders; see `component-structure.mdc`).

2. **Layouts**
   - Root layout (`src/app/_layout.jsx`) handles global providers and startup as per `bootstrap-config.mdc`.
   - Group layouts handle authentication, access control, and navigation for their group.

3. **Pages**
   * Each page must reside in its respective route folder
   * Pages can import platform UI components only
   * Pages should be lightweight and delegate logic to hooks or features
4. **Navigation**
   - All navigation must use Expo App Router—do **not** use React Navigation stack outside it.
   - Guard logic lives in `src/navigation/guards/` and should be applied via layouts.
   - When generating links, **omit group segments** from paths (e.g., `/login` instead of `/(auth)/login`).
   - Follow import conventions in `coding-conventions.mdc`.

5. **Naming Conventions**
   - Use `kebab-case` for route files (e.g., `user-profile.jsx`).
   - All layouts start with `_layout.jsx`.

6. **Exports**
   - All pages and layouts **must** use default export.
   - Barrel files (`index.js`) are optional in route folders. See `coding-conventions.mdc`.

7. **Platform-specific Pages**
   - Platform-specific pages allowed (e.g., `page.android.jsx`, `page.ios.jsx`, `page.web.jsx`).
   - If used, follow same platform file-naming as for UI components (`component-structure.mdc`).
   - Prefer shared logic via hooks, not duplicate page logic.

8. **Error Handling**
   - Use `ErrorBoundary.jsx` in layouts to catch rendering errors.
   - All route-level errors must be propagated to `errors/` for logging.

## Related `.mdc` files
- `component-structure.mdc` (UI/component patterns)
- `security.mdc` (route guards and auth)
- `features-domain.mdc` (business logic delegation)
